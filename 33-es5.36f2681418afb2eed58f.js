!function(){function e(e,n){if(!(e instanceof n))throw new TypeError("Cannot call a class as a function")}function n(e,n){for(var t=0;t<n.length;t++){var i=n[t];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function t(e,t,i){return t&&n(e.prototype,t),i&&n(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[33],{ohN5:function(n,i,l){"use strict";l.r(i),l.d(i,"ForecastingModule",(function(){return De}));var a=l("tyNb"),o=l("J7oY"),c=l("JSOo"),s=l("OBQ6"),r=l("PCNd"),u=l("Mf/S"),d=l("fXoL"),h=l("7CaW"),g=l("7zfz"),f=l("arFO"),p=l("3Pt+"),m=l("ofXK"),b=l("Y+ZO"),v=l("rEr+"),y=l("+07z"),C=l("TjhJ"),D=l("fyqy"),V=l("pqzn");function S(e,n){if(1&e){var t=d.Wb();d.Vb(0,"div"),d.Vb(1,"div",32),d.dc("onDragStart",(function(){d.Dc(t);var e=d.gc().index;return d.gc(2).onDragStart(e)}))("onDrop",(function(){d.Dc(t);var e=d.gc().index;return d.gc(2).onDrop(e)})),d.Vb(2,"div",33),d.Vb(3,"input",34),d.dc("ngModelChange",(function(e){return d.Dc(t),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(t);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(4,"label"),d.Mc(5),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(3),d.oc("checked",i.showField)("ngModel",i.showField),d.Eb(2),d.Nc(i.header)}}var w=function(){return{color:"grey"}};function k(e,n){if(1&e){var t=d.Wb();d.Vb(0,"div"),d.Vb(1,"div",35),d.Vb(2,"div"),d.Vb(3,"input",36),d.dc("ngModelChange",(function(e){return d.Dc(t),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(t);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(4,"label",37),d.Mc(5),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(3),d.oc("checked",i.showField)("ngModel",i.showField)("disabled",!i.drag),d.Eb(1),d.oc("ngStyle",d.rc(5,w)),d.Eb(1),d.Nc(i.header)}}function R(e,n){if(1&e&&(d.Kc(0,S,6,3,"div",31),d.Kc(1,k,6,6,"div",31)),2&e){var t=n.$implicit;d.oc("ngIf",t.drag),d.Eb(1),d.oc("ngIf",!t.drag)}}var A=function(){return{width:"100%",height:"100%"}};function T(e,n){if(1&e){var t=d.Wb();d.Vb(0,"div",20),d.Vb(1,"div",21),d.Vb(2,"div",22),d.Vb(3,"input",23),d.dc("click",(function(){return d.Dc(t),d.gc().onSelectAll()})),d.Ub(),d.Vb(4,"label",24),d.Mc(5,"Select All"),d.Ub(),d.Vb(6,"a",25),d.dc("click",(function(e){return d.Dc(t),d.gc().closeConfigureColumns(e)})),d.Mc(7,"\xd7"),d.Ub(),d.Vb(8,"p-listbox",26),d.Kc(9,R,2,2,"ng-template",27),d.Ub(),d.Ub(),d.Vb(10,"div",28),d.Vb(11,"a",29),d.dc("click",(function(){return d.Dc(t),d.gc().saveColumns()})),d.Mc(12,"Save"),d.Ub(),d.Vb(13,"a",30),d.dc("click",(function(e){return d.Dc(t),d.gc().closeConfigureColumns(e)})),d.Mc(14,"Cancel"),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc();d.Eb(3),d.oc("checked",i.isSelectAllChecked),d.Eb(5),d.Ic(d.rc(4,A)),d.oc("options",i.globalCols)}}function F(e,n){1&e&&d.Qb(0,"col")}function E(e,n){if(1&e&&(d.Vb(0,"colgroup"),d.Kc(1,F,1,0,"col",38),d.Ub()),2&e){var t=n.$implicit;d.Eb(1),d.oc("ngForOf",t)}}function M(e,n){if(1&e&&(d.Vb(0,"th",40),d.Vb(1,"a"),d.Mc(2),d.Ub(),d.Ub()),2&e){var t=n.$implicit;d.Eb(2),d.Oc(" ",t.header," ")}}function U(e,n){if(1&e&&(d.Vb(0,"tr"),d.Kc(1,M,3,1,"th",39),d.Ub()),2&e){var t=d.gc();d.Eb(1),d.oc("ngForOf",t.columns)}}function I(e,n){if(1&e&&(d.Tb(0),d.Mc(1),d.hc(2,"roundCurrency"),d.Sb()),2&e){var t=d.gc().$implicit,i=d.gc().$implicit;d.Eb(1),d.Oc(" ",d.jc(2,1,i[t.field],i.Currency)," ")}}function x(e,n){if(1&e&&(d.Mc(0),d.hc(1,"round")),2&e){var t=d.gc().$implicit,i=d.gc().$implicit,l=d.gc();d.Oc(" ","number"===l.fieldType(i[t.field])?d.ic(1,1,i[t.field]):i[t.field]," ")}}function P(e,n){if(1&e&&(d.Vb(0,"td"),d.Vb(1,"span",42),d.Kc(2,I,3,4,"ng-container",43),d.Kc(3,x,2,3,"ng-template",null,44,d.Lc),d.Ub(),d.Ub()),2&e){var t=n.$implicit,i=d.Bc(4),l=d.gc().$implicit,a=d.gc();d.Eb(1),d.pc("title",l[t.field]),d.Eb(1),d.oc("ngIf",a.isCurrencyField(t.field)&&null!=l[t.field])("ngIfElse",i)}}function O(e,n){if(1&e&&(d.Vb(0,"tr",41),d.Kc(1,P,5,3,"td",38),d.Ub()),2&e){var t=n.$implicit,i=d.gc();d.oc("pSelectableRow",t),d.Eb(1),d.oc("ngForOf",i.columns)}}function L(e,n){if(1&e&&(d.Vb(0,"div",45),d.Vb(1,"p"),d.Mc(2),d.Ub(),d.Ub()),2&e){var t=d.gc();d.Eb(2),d.Nc(t.noData)}}var Q,N,K=function(){return{"margin-bottom":"20px"}},B=function(){return{"margin-left":"-110px",position:"absolute",height:"31px",padding:"0px",width:"100px","margin-top":"-3px"}},J=function(){return{"margin-left":"10px",position:"relative",top:"-2px"}},_=l("+yMW"),z=((Q=function(){function n(t,i,l,o,c){var s=this;e(this,n),this.rmanDealRfcstVService=t,this.router=i,this.commonSharedService=l,this.notificationService=o,this.rmanLookupsVService=c,this.rmanDealRfcstV=new W,this.rmanDealRfcstVSearch=new W,this.isSerached=0,this.noData=_.noData,this.paginationOptions={},this.showAddColumns=!0,this.isSelectAllChecked=!0,this.showPaginator=!0,this.collapsed=!0,this.columns=[],this.isTCSelected=!0,this.sourceTypesList=[],this.srcType="Q",this.isPeriodTypeSelected=!0,this.hideColumnMenu=!0,this.showFilter=!1,this.paginationOptions={pageNumber:0,pageSize:10},this.router.events.subscribe((function(e){e instanceof a.c&&(s.arrIdK=e.url.split("/")[3])})),this.rmanLookupsVService.getAllRmanLookupsV(this.paginationOptions,{lookupTypeName:"FORECAST_DOCUMENT_TYPE"}).then((function(e){s.sourceTypesList=e.content.map((function(e){return{label:e.lookupCode,value:e.lookupDescription}}))}))}return t(n,[{key:"ngOnInit",value:function(){this.getDealForecastingView()}},{key:"onToggleTCFC",value:function(){this.getDealForecastingView()}},{key:"onTogglePeriodType",value:function(){this.getDealForecastingView()}},{key:"checkIfStringStartsWith",value:function(e,n){return n.some((function(n){return e.startsWith(n)||e.endsWith(n)}))}},{key:"getTableColumns",value:function(e,n){var t=this;this.isSelectAllChecked=!0;var i=["Q1-","Q2-","Q3-","Q4-","-Q1","-Q2","-Q3","-Q4","Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"];this.commonSharedService.getConfiguredColDetails(e,n).then((function(e){if(e&&null!=e&&e.userId){t.columns=[];var n=e.tableColumns.split(",");n.length>0&&n.forEach((function(e,n){e&&(t.startIndex=t.globalCols.findIndex((function(n){return n.field==e})),t.onDrop(n))})),t.globalCols.forEach((function(n){-1!==e.tableColumns.indexOf(n.field)||1==t.checkIfStringStartsWith(n.field,i)?t.columns.push(n):n.showField=!1})),t.columns.length!=t.globalCols.length&&(t.isSelectAllChecked=!1),t.showPaginator=0!==t.columns.length,t.userId=e.userId}else t.columns=t.globalCols})).catch((function(){t.notificationService.showError("Error occured while getting table columns data"),t.loading=!1}))}},{key:"saveColumns",value:function(){var e=this,n="";this.showAddColumns=!this.showAddColumns;var t=this.globalCols.length-1;this.globalCols.forEach((function(i,l){i.showField&&0==e.checkIfStringStartsWith(i.field,["Q1-","Q2-","Q3-","Q4-","-Q1","-Q2","-Q3","-Q4","Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"])&&(n+=i.field,l<t&&(n+=","))})),this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("rmanDealForecasting","Forecasting Details",n,this.userId).then((function(n){e.columns=e.globalCols.filter((function(e){return e.showField})),e.userId=n.userId,e.showPaginator=0!==e.columns.length,e.loading=!1})).catch((function(){e.notificationService.showError("Error occured while saving"),e.loading=!1}))}},{key:"onDragStart",value:function(e){this.startIndex=e}},{key:"onDrop",value:function(e){var n=this.globalCols[this.startIndex];this.globalCols.splice(this.startIndex,1),this.globalCols.splice(e,0,n)}},{key:"selectColumns",value:function(e){var n=this.globalCols.filter((function(e){return!e.showField}));this.isSelectAllChecked=!(n.length>0)}},{key:"onSelectAll",value:function(){var e=this;this.isSelectAllChecked=!this.isSelectAllChecked,this.globalCols.forEach((function(n){e.isSelectAllChecked?n.showField=!0:n.drag&&(n.showField=!1)}))}},{key:"onConfiguringColumns",value:function(e){this.clonedCols=JSON.parse(JSON.stringify(this.globalCols)),this.showAddColumns=!1}},{key:"closeConfigureColumns",value:function(e){this.showAddColumns=!0,this.globalCols=this.clonedCols;var n=this.globalCols.filter((function(e){return!e.showField}));this.isSelectAllChecked=!(n.length>0)}},{key:"isDealPage",value:function(){return this.router.url.includes("deal-manager")}},{key:"reset",value:function(e){e.reset(),this.paginationOptions={},this.rmanDealRfcstV=new W,this.getDealForecastingView()}},{key:"exportExcel",value:function(){var e=this.rmanDealRfcstVService.getServiceUrl(this.paginationOptions,{arrangementId:this.arrIdK},1);window.location.href=e}},{key:"getAllRmanDealRfcstV",value:function(){var e=this;this.loading=!0,this.rmanDealRfcstVService.getAllRmanDealRfcstV(this.paginationOptions,{arrangementId:this.arrIdK}).then((function(n){e.datasource=n.content,e.rmanDealRfcstVList=n.content,e.loading=!1,e.totalElements=n.totalElements,e.pageSize=n.size,e.displaySearchDialog=!1})).catch((function(n){e.notificationService.showError("Error occured while getting data"),e.loading=!1}))}},{key:"onSourceTypeChange",value:function(){this.getDealForecastingView()}},{key:"getDealForecastingView",value:function(){var e=this;this.loading=!0,this.rmanDealRfcstVService.getRmanForecastView2(this.arrIdK,this.isTCSelected,this.srcType,this.isPeriodTypeSelected).then((function(n){e.rDealFCSTViewList=n.Content,e.globalCols=[],e.loading=!1;var t=e.rDealFCSTViewList[0];for(var i in t)["Element Type"].includes(i)||["Arrangement Number","SKU"].includes(i)||["Expected Booking Amount"].includes(i)?e.globalCols.push({field:i,header:i,hide:!1,showField:!0,drag:!0,display:"table-cell"}):["Expected Start Date"].includes(i)?e.globalCols.push({field:i,header:"Forecast Date",hide:!1,showField:!0,drag:!0,display:"table-cell"}):["Ayara Line Id"].includes(i)||["Quote Line Id"].includes(i)||(["Line No"].includes(i)?e.globalCols.push({field:i,header:"Line Number",hide:!1,showField:!0,drag:!0,display:"table-cell"}):["Parent Line No"].includes(i)?e.globalCols.push({field:i,header:"Parent Line Number",hide:!1,showField:!0,drag:!0,display:"table-cell"}):e.globalCols.push({field:i,header:i,hide:!1,showField:!0,drag:!0,display:"table-cell"}));e.columns=[],e.getTableColumns("rmanDealForecasting","Forecasting Details"),e.rDealFCSTViewList=n.Content,e.totalRecords=e.rDealFCSTViewList.length,$.unblockUI()})).catch((function(n){e.loading=!1,e.notificationService.showError("Error occured while getting data"),$.unblockUI()}))}},{key:"fieldType",value:function(e){return typeof e}},{key:"showDialogToAdd",value:function(){this.newRmanDealRfcstV=!0,this.rmanDealRfcstV=new W,this.displayDialog=!0}},{key:"save",value:function(){var e=this;this.newRmanDealRfcstV?(this.loading=!0,this.rmanDealRfcstVService.saveRmanDealRfcstV(this.rmanDealRfcstV).then((function(n){e.getAllRmanDealRfcstV()})).catch((function(n){e.notificationService.showError("Error occured while saving the data"),e.loading=!1}))):(this.loading=!0,this.rmanDealRfcstVService.updateRmanDealRfcstV(this.rmanDealRfcstV).then((function(n){e.getAllRmanDealRfcstV()})).catch((function(n){e.notificationService.showError("Error occured while updating the data"),e.loading=!1}))),this.rmanDealRfcstV=new W,this.displayDialog=!1}},{key:"delete",value:function(e){var n=this;this.rmanDealRfcstV=e,this.displayDialog=!1,window.confirm("Are you sure you want to delete this record?")&&(this.rmanDealRfcstVList.splice(this.findSelectedRmanDealRfcstVIndex(),1),this.rmanDealRfcstVService.deleteRmanDealRfcstV(this.rmanDealRfcstV).then((function(e){n.rmanDealRfcstV=new W,n.getAllRmanDealRfcstV()})))}},{key:"editRow",value:function(e){this.newRmanDealRfcstV=!1,this.rmanDealRfcstV=this.cloneRmanDealRfcstV(e),this.displayDialog=!0}},{key:"findSelectedRmanDealRfcstVIndex",value:function(){return this.rmanDealRfcstVList.indexOf(this.selectedRmanDealRfcstV)}},{key:"onRowSelect",value:function(e){}},{key:"cloneRmanDealRfcstV",value:function(e){var n=new W;for(var t in e)n[t]=e[t];return n}},{key:"toggleColumnMenu",value:function(){this.hideColumnMenu=!this.hideColumnMenu}},{key:"toggleFilterBox",value:function(){this.showFilter=!this.showFilter}},{key:"showDialogToSearch",value:function(){this.rmanDealRfcstVSearch=new W,0==this.isSerached&&(this.rmanDealRfcstVSearch=new W),this.displaySearchDialog=!0}},{key:"search",value:function(){this.isSerached=1,this.rmanDealRfcstV=this.rmanDealRfcstVSearch,this.getAllRmanDealRfcstV()}},{key:"onBeforeToggle",value:function(e){this.collapsed=e.collapsed}},{key:"isCurrencyField",value:function(e){return["Unit Net Price","Net Price","Allocation Amount","Extended List Price"].includes(e)||/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-\d{2}$/.test(e)||/^\d{4}-Q[1-4]$/.test(e)}}]),n}()).\u0275fac=function(e){return new(e||Q)(d.Pb(s.a),d.Pb(a.g),d.Pb(c.a),d.Pb(o.a),d.Pb(u.a))},Q.\u0275cmp=d.Jb({type:Q,selectors:[["rmanDealRfcstV-data"]],features:[d.Db([s.a,r.a])],decls:22,vars:22,consts:[[1,"content-section","implementation"],[3,"header","onBeforeToggle"],[1,"pull-right","icons-list"],["placeholder","Select Source Type","appendTo","body",3,"options","ngModel","filter","ngStyle","ngModelChange","onChange"],["onLabel","Monthly","offLabel","Quarterly","onIcon","fa fa-toggle-on fa-sm","offIcon","fa fa-toggle-off fa-sm",1,"ui-inputswitch",3,"ngStyle","ngModel","ngModelChange"],["onLabel","TC","offLabel","FC","onIcon","fa fa-toggle-on fa-sm","offIcon","fa fa-toggle-off fa-sm",1,"ui-inputswitch",3,"ngStyle","ngModel","ngModelChange"],[1,"add-column",3,"click"],[1,"fa","fa-cog"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],["title","Export",3,"click"],[1,"fa","fa-external-link"],["id","add-column-popup","class","contracts_add_column",4,"ngIf"],[1,"x-scroll"],["exportFilename","RmanDealRfcstV","columnResizeMode","expand","scrollable","true",1,"ui-datatable","arrangementMgrTbl",3,"columns","loading","value","paginator","rows","resizableColumns"],["dt",""],["pTemplate","colgroup"],["pTemplate","header","class","arrangementMgrTblHead"],["pTemplate","body"],["pTemplate","emptymessage"],["id","add-column-popup",1,"contracts_add_column"],[1,"user-popup"],[1,"content","overflow"],["type","checkbox","id","selectall","name","selectall",3,"checked","click"],["for","selectall"],["title","Close",1,"close",3,"click"],[3,"options"],["pTemplate","item"],[1,"pull-right"],[1,"configColBtn",3,"click"],[1,"configColBtn","conf-cancel",3,"click"],[4,"ngIf"],["pDraggable","gens","pDroppable","gens",1,"ui-helper-clearfix",3,"onDragStart","onDrop"],[1,"drag"],["type","checkbox",3,"checked","ngModel","ngModelChange","change"],[1,"ui-helper-clearfix"],["type","checkbox",3,"checked","ngModel","disabled","ngModelChange","change"],[3,"ngStyle"],[4,"ngFor","ngForOf"],["pResizableColumn","",4,"ngFor","ngForOf"],["pResizableColumn",""],[3,"pSelectableRow"],[3,"title"],[4,"ngIf","ngIfElse"],["normalText",""],[1,"no-results-data"]],template:function(e,n){if(1&e){var t=d.Wb();d.Qb(0,"div",0),d.Vb(1,"p-panel",1),d.dc("onBeforeToggle",(function(e){return n.onBeforeToggle(e)})),d.Vb(2,"p-header"),d.Vb(3,"div",2),d.Vb(4,"p-dropdown",3),d.dc("ngModelChange",(function(e){return n.srcType=e}))("onChange",(function(){return n.onSourceTypeChange()})),d.Ub(),d.Vb(5,"p-toggleButton",4),d.dc("ngModelChange",(function(e){return n.isPeriodTypeSelected=e}))("ngModelChange",(function(){return n.onTogglePeriodType()})),d.Ub(),d.Vb(6,"p-toggleButton",5),d.dc("ngModelChange",(function(e){return n.isTCSelected=e}))("ngModelChange",(function(){return n.onToggleTCFC()})),d.Ub(),d.Vb(7,"a",6),d.dc("click",(function(e){return n.onConfiguringColumns(e)})),d.Qb(8,"em",7),d.Mc(9,"Columns"),d.Ub(),d.Vb(10,"a",8),d.dc("click",(function(){d.Dc(t);var e=d.Bc(17);return n.reset(e)})),d.Qb(11,"em",9),d.Ub(),d.Vb(12,"a",10),d.dc("click",(function(){return d.Dc(t),d.Bc(17).exportCSV()})),d.Qb(13,"em",11),d.Ub(),d.Kc(14,T,15,5,"div",12),d.Ub(),d.Ub(),d.Vb(15,"div",13),d.Vb(16,"p-table",14,15),d.Kc(18,E,2,1,"ng-template",16),d.Kc(19,U,2,1,"ng-template",17),d.Kc(20,O,2,2,"ng-template",18),d.Kc(21,L,3,1,"ng-template",19),d.Ub(),d.Ub(),d.Ub()}2&e&&(d.Eb(1),d.Ic(d.rc(18,K)),d.oc("header",n.isDealPage()?"":"Deal Forecasting View"),d.Eb(3),d.oc("options",n.sourceTypesList)("ngModel",n.srcType)("filter",!0)("ngStyle",d.rc(19,B)),d.Eb(1),d.oc("ngStyle",d.rc(20,J))("ngModel",n.isPeriodTypeSelected),d.Eb(1),d.oc("ngStyle",d.rc(21,J))("ngModel",n.isTCSelected),d.Eb(8),d.oc("ngIf",!n.showAddColumns),d.Eb(2),d.oc("columns",n.columns)("loading",n.loading)("value",n.rDealFCSTViewList)("paginator",!0)("rows",10)("resizableColumns",!0))},directives:[h.a,g.c,f.a,p.k,p.n,m.p,b.a,m.o,v.j,g.f,y.a,C.b,C.c,p.a,m.n,v.g,v.i],pipes:[D.a,V.a],encapsulation:2}),Q),W=function n(t,i,l,a,o,c,s,r,u,d){e(this,n),this.glPeriod=t,this.expectedBookingAmount=i,this.amount=l,this.qty=a,this.netPrice=o,this.elementType=c,this.startDate=s,this.arrangementName=r,this.sku=u,this.arrangementId=d},j=l("tk/3"),q=l("MCLT"),Y=l("+yMW"),H={headers:new j.f({"Content-Type":"application/json"})},X=((N=function(){function n(t){e(this,n),this.http=t}return t(n,[{key:"getServiceUrl",value:function(e,n,t){var i=Y.apiUrl+"/rmanDealRfcstVExport?";0==t&&(i=Y.apiUrl+"/rmanDealRfcstVSearch?");var l="";return null!=n.arrangementId&&""!=n.arrangementId&&(l=l+"arrangementId:"+n.arrangementId),null!=n.arrangementName&&""!=n.arrangementName&&(l=l+"arrangementName:"+n.arrangementName+","),null!=n.sku&&""!=n.sku&&(l=l+"sku:"+n.sku+","),null!=n.qty&&""!=n.qty&&(l=l+"qty:"+n.qty+","),null!=n.elementType&&""!=n.elementType&&(l=l+"elementType:"+n.elementType+","),null!=n.netPrice&&""!=n.netPrice&&(l=l+"netPrice:"+n.netPrice+","),null!=n.expectedBookingAmount&&""!=n.expectedBookingAmount&&(l=l+"expectedBookingAmount:"+n.expectedBookingAmount+","),null!=n.amount&&""!=n.amount&&(l=l+"amount:"+n.amount+","),null!=n.glPeriod&&""!=n.glPeriod&&(l=l+"glPeriod:"+n.glPeriod+","),null!=n.startDate&&""!=n.startDate&&(l=l+"startDate:"+n.startDate),""==l?i+="search=%25":i=i+"search="+l,Object(q.isNumber)(e.pageNumber)&&(console.log(!0),i=i+"&page="+e.pageNumber+"&size="+e.pageSize),i}},{key:"getAllRmanDealRfcstAnalysisV",value:function(e,n){var t=this.getServiceUrl(e,n,0);return this.http.get(t).toPromise().then((function(e){return e}))}},{key:"saveRmanDealRfcstAnalysisV",value:function(e){var n=JSON.stringify(e);return this.http.post(Y.apiUrl+"/RMAN_DEAL_RFCST_V",n,H).toPromise().then((function(e){return e}))}},{key:"updateRmanDealRfcstAnalysisV",value:function(e){delete e._links,delete e.interests;var n=JSON.stringify(e);return this.http.put(Y.apiUrl+"/RMAN_DEAL_RFCST_V/"+e.arrangementId,n,H).toPromise().then((function(e){return e}))}},{key:"deleteRmanDealRfcstV",value:function(e){return this.http.delete(Y.apiUrl+"/RMAN_DEAL_RFCST_V/"+e.arrangementId,H).toPromise().then((function(e){return e}))}},{key:"getRmanForecastAnalysisView",value:function(e){return null==e&&(e=0),this.http.get(Y.apiUrl+"/revmantra/rfcstView?arrgId="+e).toPromise().then((function(e){return e}))}},{key:"getRmanForecastAnalysisView2",value:function(e,n,t,i){return null==e&&(e=0),this.http.get(Y.apiUrl+"/revmantra/rfcstActualView?arrgId="+e+"&currType="+(n=n?"TC":"FC")+"&periodType="+(t=t?"M":"Q")).toPromise().then((function(e){return e}))}}]),n}()).\u0275fac=function(e){return new(e||N)(d.Zb(j.b))},N.\u0275prov=d.Lb({token:N,factory:N.\u0275fac}),N);function Z(e,n){if(1&e){var t=d.Wb();d.Vb(0,"div"),d.Vb(1,"div",31),d.dc("onDragStart",(function(){d.Dc(t);var e=d.gc().index;return d.gc(2).onDragStart(e)}))("onDrop",(function(){d.Dc(t);var e=d.gc().index;return d.gc(2).onDrop(e)})),d.Vb(2,"div",32),d.Vb(3,"input",33),d.dc("ngModelChange",(function(e){return d.Dc(t),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(t);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(4,"label"),d.Mc(5),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(3),d.oc("checked",i.showField)("ngModel",i.showField),d.Eb(2),d.Nc(i.header)}}var G=function(){return{color:"grey"}};function ee(e,n){if(1&e){var t=d.Wb();d.Vb(0,"div"),d.Vb(1,"div",34),d.Vb(2,"div"),d.Vb(3,"input",35),d.dc("ngModelChange",(function(e){return d.Dc(t),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(t);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(4,"label",36),d.Mc(5),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(3),d.oc("checked",i.showField)("ngModel",i.showField)("disabled",!i.drag),d.Eb(1),d.oc("ngStyle",d.rc(5,G)),d.Eb(1),d.Nc(i.header)}}function ne(e,n){if(1&e&&(d.Kc(0,Z,6,3,"div",30),d.Kc(1,ee,6,6,"div",30)),2&e){var t=n.$implicit;d.oc("ngIf",t.drag),d.Eb(1),d.oc("ngIf",!t.drag)}}var te=function(){return{width:"100%",height:"100%"}};function ie(e,n){if(1&e){var t=d.Wb();d.Vb(0,"div",19),d.Vb(1,"div",20),d.Vb(2,"div",21),d.Vb(3,"input",22),d.dc("click",(function(){return d.Dc(t),d.gc().onSelectAll()})),d.Ub(),d.Vb(4,"label",23),d.Mc(5,"Select All"),d.Ub(),d.Vb(6,"a",24),d.dc("click",(function(e){return d.Dc(t),d.gc().closeConfigureColumns(e)})),d.Mc(7,"\xd7"),d.Ub(),d.Vb(8,"p-listbox",25),d.Kc(9,ne,2,2,"ng-template",26),d.Ub(),d.Ub(),d.Vb(10,"div",27),d.Vb(11,"a",28),d.dc("click",(function(){return d.Dc(t),d.gc().saveColumns()})),d.Mc(12,"Save"),d.Ub(),d.Vb(13,"a",29),d.dc("click",(function(e){return d.Dc(t),d.gc().closeConfigureColumns(e)})),d.Mc(14,"Cancel"),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc();d.Eb(3),d.oc("checked",i.isSelectAllChecked),d.Eb(5),d.Ic(d.rc(4,te)),d.oc("options",i.globalCols)}}function le(e,n){1&e&&d.Qb(0,"col")}function ae(e,n){if(1&e&&(d.Vb(0,"colgroup"),d.Kc(1,le,1,0,"col",37),d.Ub()),2&e){var t=n.$implicit;d.Eb(1),d.oc("ngForOf",t)}}function oe(e,n){if(1&e&&(d.Vb(0,"th",39),d.Vb(1,"a"),d.Mc(2),d.Ub(),d.Ub()),2&e){var t=n.$implicit;d.Eb(2),d.Oc(" ",t.header," ")}}function ce(e,n){if(1&e&&(d.Vb(0,"tr"),d.Kc(1,oe,3,1,"th",38),d.Ub()),2&e){var t=d.gc();d.Eb(1),d.oc("ngForOf",t.columns)}}function se(e,n){if(1&e&&(d.Tb(0),d.Mc(1),d.hc(2,"roundCurrency"),d.Sb()),2&e){var t=d.gc().$implicit,i=d.gc().$implicit;d.Eb(1),d.Oc(" ",d.jc(2,1,i[t.field],i.Currency)," ")}}function re(e,n){if(1&e&&(d.Mc(0),d.hc(1,"round")),2&e){var t=d.gc().$implicit,i=d.gc().$implicit,l=d.gc();d.Oc(" ","number"===l.fieldType(i[t.field])?d.ic(1,1,i[t.field]):i[t.field]," ")}}function ue(e,n){if(1&e&&(d.Vb(0,"td"),d.Vb(1,"span",41),d.Kc(2,se,3,4,"ng-container",42),d.Kc(3,re,2,3,"ng-template",null,43,d.Lc),d.Ub(),d.Ub()),2&e){var t=n.$implicit,i=d.Bc(4),l=d.gc().$implicit,a=d.gc();d.Eb(1),d.pc("title",l[t.field]),d.Eb(1),d.oc("ngIf",a.isCurrencyField(t.field)&&null!=l[t.field])("ngIfElse",i)}}function de(e,n){if(1&e&&(d.Vb(0,"tr",40),d.Kc(1,ue,5,3,"td",37),d.Ub()),2&e){var t=n.$implicit,i=d.gc();d.oc("pSelectableRow",t),d.Eb(1),d.oc("ngForOf",i.columns)}}function he(e,n){if(1&e&&(d.Vb(0,"div",44),d.Vb(1,"p"),d.Mc(2),d.Ub(),d.Ub()),2&e){var t=d.gc();d.Eb(2),d.Nc(t.noData)}}var ge,fe,pe=function(){return{"margin-bottom":"20px"}},me=function(){return{"margin-right":"-10px"}},be=l("+yMW"),ve=((ge=function(){function n(t,i,l,o,c){var s=this;e(this,n),this.rmanDealRfcstAnalysisVService=t,this.router=i,this.commonSharedService=l,this.notificationService=o,this.rmanLookupsVService=c,this.rmanDealRfcstAnalysisV=new ye,this.rmanDealRfcstAnalysisVSearch=new ye,this.isSerached=0,this.noData=be.noData,this.paginationOptions={},this.showAddColumns=!0,this.isSelectAllChecked=!0,this.showPaginator=!0,this.collapsed=!0,this.columns=[],this.isTCSelected=!0,this.isPeriodTypeSelected=!0,this.sourceTypesList=[],this.srcType="Q",this.hideColumnMenu=!0,this.showFilter=!1,this.paginationOptions={pageNumber:0,pageSize:10},this.router.events.subscribe((function(e){e instanceof a.c&&(s.arrIdK=e.url.split("/")[3])})),this.rmanLookupsVService.getAllRmanLookupsV(this.paginationOptions,{lookupTypeName:"FORECAST_DOCUMENT_TYPE"}).then((function(e){s.sourceTypesList=e.content.map((function(e){return{label:e.lookupCode,value:e.lookupDescription}}))}))}return t(n,[{key:"ngOnInit",value:function(){this.getDealForecastingView()}},{key:"onToggleTCFC",value:function(){this.getDealForecastingView()}},{key:"onTogglePeriodType",value:function(){this.getDealForecastingView()}},{key:"checkIfStringStartsWith",value:function(e,n){return n.some((function(n){return e.startsWith(n)||e.endsWith(n)}))}},{key:"getTableColumns",value:function(e,n){var t=this;this.isSelectAllChecked=!0;var i=["Q1-","Q2-","Q3-","Q4-","-Q1","-Q2","-Q3","-Q4","Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"];this.commonSharedService.getConfiguredColDetails(e,n).then((function(e){if(e&&null!=e&&e.userId){t.columns=[];var n=e.tableColumns.split(",");n.length>0&&n.forEach((function(e,n){e&&(t.startIndex=t.globalCols.findIndex((function(n){return n.field==e})),t.onDrop(n))})),t.globalCols.forEach((function(n){-1!==e.tableColumns.indexOf(n.field)||1==t.checkIfStringStartsWith(n.field,i)?t.columns.push(n):n.showField=!1})),t.columns.length!=t.globalCols.length&&(t.isSelectAllChecked=!1),t.showPaginator=0!==t.columns.length,t.userId=e.userId}else t.columns=t.globalCols})).catch((function(){t.notificationService.showError("Error occured while getting table columns data"),t.loading=!1}))}},{key:"saveColumns",value:function(){var e=this,n="";this.showAddColumns=!this.showAddColumns;var t=this.globalCols.length-1;this.globalCols.forEach((function(i,l){i.showField&&0==e.checkIfStringStartsWith(i.field,["Q1-","Q2-","Q3-","Q4-","-Q1","-Q2","-Q3","-Q4","Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"])&&(n+=i.field,l<t&&(n+=","))})),this.loading=!0;var i=this.getCurrentViewKey().concat(this.getPeriodTypeViewKey());this.commonSharedService.saveOrUpdateTableColumns("rmanDealForecastActualData_"+i,"Forecasting Analysis Details",n,this.userId).then((function(n){e.columns=e.globalCols.filter((function(e){return e.showField})),e.userId=n.userId,e.showPaginator=0!==e.columns.length,e.loading=!1})).catch((function(){e.notificationService.showError("Error occured while saving"),e.loading=!1}))}},{key:"onDragStart",value:function(e){this.startIndex=e}},{key:"onDrop",value:function(e){var n=this.globalCols[this.startIndex];this.globalCols.splice(this.startIndex,1),this.globalCols.splice(e,0,n)}},{key:"selectColumns",value:function(e){var n=this.globalCols.filter((function(e){return!e.showField}));this.isSelectAllChecked=!(n.length>0)}},{key:"onSelectAll",value:function(){var e=this;this.isSelectAllChecked=!this.isSelectAllChecked,this.globalCols.forEach((function(n){e.isSelectAllChecked?n.showField=!0:n.drag&&(n.showField=!1)}))}},{key:"onConfiguringColumns",value:function(e){this.clonedCols=JSON.parse(JSON.stringify(this.globalCols)),this.showAddColumns=!1}},{key:"closeConfigureColumns",value:function(e){this.showAddColumns=!0,this.globalCols=this.clonedCols;var n=this.globalCols.filter((function(e){return!e.showField}));this.isSelectAllChecked=!(n.length>0)}},{key:"isDealPage",value:function(){return this.router.url.includes("deal-manager")}},{key:"reset",value:function(e){e.reset(),this.paginationOptions={},this.rmanDealRfcstAnalysisV=new ye,this.getDealForecastingView()}},{key:"exportExcel",value:function(){var e=this.rmanDealRfcstAnalysisVService.getServiceUrl(this.paginationOptions,{arrangementId:this.arrIdK},1);window.location.href=e}},{key:"getAllRmanDealRfcstAnalysisV",value:function(){var e=this;this.loading=!0,this.rmanDealRfcstAnalysisVService.getAllRmanDealRfcstAnalysisV(this.paginationOptions,{arrangementId:this.arrIdK}).then((function(n){e.datasource=n.content,e.rmanDealRfcstAnalysisVList=n.content,e.loading=!1,e.totalElements=n.totalElements,e.pageSize=n.size,e.displaySearchDialog=!1})).catch((function(n){e.notificationService.showError("Error occured while getting data"),e.loading=!1}))}},{key:"onSourceTypeChange",value:function(){this.getDealForecastingView()}},{key:"getDealForecastingView",value:function(){var e=this;this.loading=!0,this.rmanDealRfcstAnalysisVService.getRmanForecastAnalysisView2(this.arrIdK,this.isTCSelected,this.isPeriodTypeSelected,this.srcType).then((function(n){e.rDealFCSTAnalysisViewList=n.Content,e.globalCols=[],e.loading=!1;var t=e.rDealFCSTAnalysisViewList[0];for(var i in t)["Element Type"].includes(i)||["Arrangement Number","SKU"].includes(i)||["Expected Booking Amount"].includes(i)?e.globalCols.push({field:i,header:i,hide:!1,showField:!0,drag:!0,display:"table-cell"}):["Expected Start Date"].includes(i)?e.globalCols.push({field:i,header:"Forecast Date",hide:!1,showField:!0,drag:!0,display:"table-cell"}):["Ayara Line Id"].includes(i)||["Quote Line Id"].includes(i)||(["Line No"].includes(i)?e.globalCols.push({field:i,header:"Line Number",hide:!1,showField:!0,drag:!0,display:"table-cell"}):["Parent Line No"].includes(i)?e.globalCols.push({field:i,header:"Parent Line Number",hide:!1,showField:!0,drag:!0,display:"table-cell"}):e.globalCols.push({field:i,header:i,hide:!1,showField:!0,drag:!0,display:"table-cell"}));e.columns=[];var l=e.getCurrentViewKey().concat(e.getPeriodTypeViewKey());e.getTableColumns("rmanDealForecastActualData_"+l,"Forecasting Analysis Details"),e.rDealFCSTAnalysisViewList=n.Content,e.totalRecords=e.rDealFCSTAnalysisViewList.length,$.unblockUI()})).catch((function(n){e.loading=!1,e.notificationService.showError("Error occured while getting data"),$.unblockUI()}))}},{key:"fieldType",value:function(e){return typeof e}},{key:"showDialogToAdd",value:function(){this.newRmanDealRfcstAnalysisV=!0,this.rmanDealRfcstAnalysisV=new ye,this.displayDialog=!0}},{key:"save",value:function(){var e=this;this.newRmanDealRfcstAnalysisV?(this.loading=!0,this.rmanDealRfcstAnalysisVService.saveRmanDealRfcstAnalysisV(this.rmanDealRfcstAnalysisV).then((function(n){e.getAllRmanDealRfcstAnalysisV()})).catch((function(n){e.notificationService.showError("Error occured while saving the data"),e.loading=!1}))):(this.loading=!0,this.rmanDealRfcstAnalysisVService.updateRmanDealRfcstAnalysisV(this.rmanDealRfcstAnalysisV).then((function(n){e.getAllRmanDealRfcstAnalysisV()})).catch((function(n){e.notificationService.showError("Error occured while updating the data"),e.loading=!1}))),this.rmanDealRfcstAnalysisV=new ye,this.displayDialog=!1}},{key:"delete",value:function(e){var n=this;this.rmanDealRfcstAnalysisV=e,this.displayDialog=!1,window.confirm("Are you sure you want to delete this record?")&&(this.rmanDealRfcstAnalysisVList.splice(this.findSelectedRmanDealRfcstVIndex(),1),this.rmanDealRfcstAnalysisVService.deleteRmanDealRfcstV(this.rmanDealRfcstAnalysisV).then((function(e){n.rmanDealRfcstAnalysisV=new ye,n.getAllRmanDealRfcstAnalysisV()})))}},{key:"editRow",value:function(e){this.newRmanDealRfcstAnalysisV=!1,this.rmanDealRfcstAnalysisV=this.cloneRmanDealRfcstV(e),this.displayDialog=!0}},{key:"findSelectedRmanDealRfcstVIndex",value:function(){return this.rmanDealRfcstAnalysisVList.indexOf(this.selectedRmanDealRfcstAnalysisV)}},{key:"onRowSelect",value:function(e){}},{key:"cloneRmanDealRfcstV",value:function(e){var n=new ye;for(var t in e)n[t]=e[t];return n}},{key:"toggleColumnMenu",value:function(){this.hideColumnMenu=!this.hideColumnMenu}},{key:"toggleFilterBox",value:function(){this.showFilter=!this.showFilter}},{key:"showDialogToSearch",value:function(){this.rmanDealRfcstAnalysisVSearch=new ye,0==this.isSerached&&(this.rmanDealRfcstAnalysisVSearch=new ye),this.displaySearchDialog=!0}},{key:"search",value:function(){this.isSerached=1,this.rmanDealRfcstAnalysisV=this.rmanDealRfcstAnalysisVSearch,this.getAllRmanDealRfcstAnalysisV()}},{key:"onBeforeToggle",value:function(e){this.collapsed=e.collapsed}},{key:"isCurrencyField",value:function(e){return/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-\d{2}$/.test(e)||/^\d{4}-Q[1-4]$/.test(e)}},{key:"getCurrentViewKey",value:function(){return this.isTCSelected?"TC":"FC"}},{key:"getPeriodTypeViewKey",value:function(){return this.isPeriodTypeSelected?"M":"Q"}}]),n}()).\u0275fac=function(e){return new(e||ge)(d.Pb(X),d.Pb(a.g),d.Pb(c.a),d.Pb(o.a),d.Pb(u.a))},ge.\u0275cmp=d.Jb({type:ge,selectors:[["rmanDealRfcstAnalysisV-data"]],features:[d.Db([X,r.a])],decls:21,vars:17,consts:[[1,"content-section","implementation"],[3,"header","onBeforeToggle"],[1,"pull-right","icons-list"],["onLabel","Monthly","offLabel","Quarterly","onIcon","fa fa-toggle-on fa-sm","offIcon","fa fa-toggle-off fa-sm",1,"ui-inputswitch",3,"ngStyle","ngModel","ngModelChange"],["onLabel","TC","offLabel","FC","onIcon","fa fa-toggle-on fa-sm","offIcon","fa fa-toggle-off fa-sm",1,"ui-inputswitch",3,"ngStyle","ngModel","ngModelChange"],[1,"add-column",3,"click"],[1,"fa","fa-cog"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],["title","Export",3,"click"],[1,"fa","fa-external-link"],["id","add-column-popup","class","contracts_add_column",4,"ngIf"],[1,"x-scroll"],["exportFilename","Forecast-Actual-comparision","columnResizeMode","expand","scrollable","true",1,"ui-datatable","arrangementMgrTbl",3,"columns","loading","value","paginator","rows","resizableColumns"],["dt",""],["pTemplate","colgroup"],["pTemplate","header","class","arrangementMgrTblHead"],["pTemplate","body"],["pTemplate","emptymessage"],["id","add-column-popup",1,"contracts_add_column"],[1,"user-popup",2,"left","344px"],[1,"content","overflow"],["type","checkbox","id","selectall","name","selectall",3,"checked","click"],["for","selectall"],["title","Close",1,"close",3,"click"],[3,"options"],["pTemplate","item"],[1,"pull-right"],[1,"configColBtn",3,"click"],[1,"configColBtn","conf-cancel",3,"click"],[4,"ngIf"],["pDraggable","gens","pDroppable","gens",1,"ui-helper-clearfix",3,"onDragStart","onDrop"],[1,"drag"],["type","checkbox",3,"checked","ngModel","ngModelChange","change"],[1,"ui-helper-clearfix"],["type","checkbox",3,"checked","ngModel","disabled","ngModelChange","change"],[3,"ngStyle"],[4,"ngFor","ngForOf"],["pResizableColumn","",4,"ngFor","ngForOf"],["pResizableColumn",""],[3,"pSelectableRow"],[3,"title"],[4,"ngIf","ngIfElse"],["normalText",""],[1,"no-results-data"]],template:function(e,n){if(1&e){var t=d.Wb();d.Qb(0,"div",0),d.Vb(1,"p-panel",1),d.dc("onBeforeToggle",(function(e){return n.onBeforeToggle(e)})),d.Vb(2,"p-header"),d.Vb(3,"div",2),d.Vb(4,"p-toggleButton",3),d.dc("ngModelChange",(function(e){return n.isPeriodTypeSelected=e}))("ngModelChange",(function(){return n.onTogglePeriodType()})),d.Ub(),d.Vb(5,"p-toggleButton",4),d.dc("ngModelChange",(function(e){return n.isTCSelected=e}))("ngModelChange",(function(){return n.onToggleTCFC()})),d.Ub(),d.Vb(6,"a",5),d.dc("click",(function(e){return n.onConfiguringColumns(e)})),d.Qb(7,"em",6),d.Mc(8,"Columns"),d.Ub(),d.Vb(9,"a",7),d.dc("click",(function(){d.Dc(t);var e=d.Bc(16);return n.reset(e)})),d.Qb(10,"em",8),d.Ub(),d.Vb(11,"a",9),d.dc("click",(function(){return d.Dc(t),d.Bc(16).exportCSV()})),d.Qb(12,"em",10),d.Ub(),d.Kc(13,ie,15,5,"div",11),d.Ub(),d.Ub(),d.Vb(14,"div",12),d.Vb(15,"p-table",13,14),d.Kc(17,ae,2,1,"ng-template",15),d.Kc(18,ce,2,1,"ng-template",16),d.Kc(19,de,2,2,"ng-template",17),d.Kc(20,he,3,1,"ng-template",18),d.Ub(),d.Ub(),d.Ub()}2&e&&(d.Eb(1),d.Ic(d.rc(14,pe)),d.oc("header",n.isDealPage()?"":"Forecast-Actual comparision"),d.Eb(3),d.oc("ngStyle",d.rc(15,me))("ngModel",n.isPeriodTypeSelected),d.Eb(1),d.oc("ngStyle",d.rc(16,me))("ngModel",n.isTCSelected),d.Eb(8),d.oc("ngIf",!n.showAddColumns),d.Eb(2),d.oc("columns",n.columns)("loading",n.loading)("value",n.rDealFCSTAnalysisViewList)("paginator",!0)("rows",10)("resizableColumns",!0))},directives:[h.a,g.c,b.a,m.p,p.k,p.n,m.o,v.j,g.f,y.a,C.b,C.c,p.a,m.n,v.g,v.i],pipes:[D.a,V.a],encapsulation:2}),ge),ye=function n(t,i,l,a,o,c,s,r,u,d){e(this,n),this.glPeriod=t,this.expectedBookingAmount=i,this.amount=l,this.qty=a,this.netPrice=o,this.elementType=c,this.startDate=s,this.arrangementName=r,this.sku=u,this.arrangementId=d},Ce=[{path:"viewForecasting",component:z},{path:"actualAnalysis",component:ve}],De=((fe=function n(){e(this,n)}).\u0275mod=d.Nb({type:fe}),fe.\u0275inj=d.Mb({factory:function(e){return new(e||fe)},providers:[],imports:[[r.a,a.k.forChild(Ce)],a.k]}),fe)}}])}();