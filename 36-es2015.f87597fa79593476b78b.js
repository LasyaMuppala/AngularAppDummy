(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{vG1C:function(t,e,c){"use strict";c.r(e),c.d(e,"RevenueAnalyticsModule",(function(){return ft}));var i=c("tyNb"),l=c("JSOo"),n=c("J7oY"),o=c("fXoL"),r=c("tk/3");const a=c("+yMW");let s=(()=>{class t{constructor(t){this.http=t}setArrangementId(t){this.arrgId=t}getArrangementId(){return this.arrgId}getAllRevenueAnalytics(t){return this.arrgId?this.http.get(a.apiUrl+"/fetchContractTotals?arrgId="+this.arrgId,{headers:{"Content-Type":"application/json",Accept:"application/json"},responseType:"json"}).toPromise().then(e=>{if(!e)return{content:[],totalElements:0,size:t.pageSize||10,contractTotals:{}};try{const c=e.contractLines||[],i=e.contractTotals||{};console.log("Contract Lines:",c),console.log("Contract Totals:",i);const l=c.map(t=>({lineNumber:t.dealLineNumber||t.lineNumber,productName:t.productName,chargeType:t.chargeType,quantity:t.quantity,unitListPrice:t.unitListPrice,unitNetPrice:t.unitSellingPrice||t.unitNetPrice,netPrice:t.netPrice,tcv:t.tcv,tcvRecurring:t.tcvRecurring,tcvNonRecurring:t.tcvNonRecurring,acv:t.acv,arrYear1:t.arrYear1,arrYear2:t.arrYear2,arrYear3:t.arrYear3,arrYear4:t.arrYear4,arrYear5:t.arrYear5,atr:t.atr,totalContractLength:t.tcl||t.totalContractLength,mrr:t.mrr,rpo:t.rpo,allocatedAcv:t.allocatedAcv,allocatedMrr:t.allocatedMrr,allocationAmount:t.allocationAmount||0,revenueAmount:t.revenueAmount||0})),n=t.pageSize||10;return{content:l,totalElements:e.totalElements||l.length,size:e.size||n,contractTotals:i}}catch(c){return{content:[],totalElements:0,size:t.pageSize||10,contractTotals:{}}}}).catch(t=>({content:[],totalElements:0,size:10,contractTotals:{}})):Promise.resolve({content:[],totalElements:0,size:10})}}return t.\u0275fac=function(e){return new(e||t)(o.Zb(r.b))},t.\u0275prov=o.Lb({token:t,factory:t.\u0275fac}),t})();var d=c("7CaW"),h=c("7zfz"),g=c("ofXK"),u=c("rEr+"),b=c("+07z"),p=c("TjhJ"),f=c("3Pt+"),m=c("pqzn");const y=["dt"];function v(t,e){if(1&t){const t=o.Wb();o.Vb(0,"a",17),o.dc("click",(function(){return o.Dc(t),o.gc().exportExcel()})),o.Qb(1,"em",18),o.Ub()}}function A(t,e){if(1&t){const t=o.Wb();o.Vb(0,"div"),o.Vb(1,"div",31),o.dc("onDragStart",(function(){o.Dc(t);const e=o.gc().index;return o.gc(2).onDragStart(e)}))("onDrop",(function(){o.Dc(t);const e=o.gc().index;return o.gc(2).onDrop(e)})),o.Vb(2,"div",32),o.Vb(3,"input",33),o.dc("ngModelChange",(function(e){return o.Dc(t),o.gc().$implicit.showField=e}))("change",(function(){o.Dc(t);const e=o.gc().$implicit;return o.gc(2).selectColumns(e)})),o.Ub(),o.Vb(4,"label"),o.Mc(5),o.Ub(),o.Ub(),o.Ub(),o.Ub()}if(2&t){const t=o.gc().$implicit;o.Eb(3),o.oc("checked",t.showField)("ngModel",t.showField),o.Eb(2),o.Nc(t.header)}}const E=function(){return{color:"grey"}};function S(t,e){if(1&t){const t=o.Wb();o.Vb(0,"div"),o.Vb(1,"div",34),o.Vb(2,"div"),o.Vb(3,"input",35),o.dc("ngModelChange",(function(e){return o.Dc(t),o.gc().$implicit.showField=e}))("change",(function(){o.Dc(t);const e=o.gc().$implicit;return o.gc(2).selectColumns(e)})),o.Ub(),o.Vb(4,"label",36),o.Mc(5),o.Ub(),o.Ub(),o.Ub(),o.Ub()}if(2&t){const t=o.gc().$implicit;o.Eb(3),o.oc("checked",t.showField)("ngModel",t.showField)("disabled",!t.drag),o.Eb(1),o.oc("ngStyle",o.rc(5,E)),o.Eb(1),o.Nc(t.header)}}function C(t,e){if(1&t&&(o.Kc(0,A,6,3,"div",30),o.Kc(1,S,6,6,"div",30)),2&t){const t=e.$implicit;o.oc("ngIf",t.drag),o.Eb(1),o.oc("ngIf",!t.drag)}}const w=function(){return{width:"100%",height:"100%"}};function R(t,e){if(1&t){const t=o.Wb();o.Vb(0,"div",19),o.Vb(1,"div",20),o.Vb(2,"div",21),o.Vb(3,"input",22),o.dc("click",(function(){return o.Dc(t),o.gc().onSelectAll()})),o.Ub(),o.Vb(4,"label",23),o.Mc(5,"Select All"),o.Ub(),o.Vb(6,"a",24),o.dc("click",(function(e){return o.Dc(t),o.gc().closeConfigureColumns(e)})),o.Mc(7,"\xd7"),o.Ub(),o.Vb(8,"p-listbox",25),o.Kc(9,C,2,2,"ng-template",26),o.Ub(),o.Ub(),o.Vb(10,"div",27),o.Vb(11,"a",28),o.dc("click",(function(){return o.Dc(t),o.gc().saveColumns()})),o.Mc(12,"Save"),o.Ub(),o.Vb(13,"a",29),o.dc("click",(function(e){return o.Dc(t),o.gc().closeConfigureColumns(e)})),o.Mc(14,"Cancel"),o.Ub(),o.Ub(),o.Ub(),o.Ub()}if(2&t){const t=o.gc();o.Eb(3),o.oc("checked",t.isSelectAllChecked),o.Eb(5),o.Ic(o.rc(4,w)),o.oc("options",t.globalCols)}}function T(t,e){1&t&&o.Qb(0,"col")}function I(t,e){if(1&t&&(o.Vb(0,"colgroup"),o.Kc(1,T,1,0,"col",37),o.Ub()),2&t){const t=e.$implicit;o.Eb(1),o.oc("ngForOf",t)}}const M=function(t){return{display:t}};function V(t,e){if(1&t&&(o.Vb(0,"th",40),o.Mc(1),o.Ub()),2&t){const t=o.gc().$implicit;o.pc("title",t.header),o.oc("ngStyle",o.sc(3,M,t.display)),o.Eb(1),o.Nc(t.header)}}function U(t,e){if(1&t&&(o.Vb(0,"th",41),o.Mc(1),o.Ub()),2&t){const t=o.gc().$implicit;o.pc("title",t.header),o.oc("ngStyle",o.sc(3,M,t.display)),o.Eb(1),o.Nc(t.header)}}function Y(t,e){if(1&t&&(o.Tb(0),o.Kc(1,V,2,5,"th",38),o.Kc(2,U,2,5,"th",39),o.Sb()),2&t){const t=e.$implicit;o.Eb(1),o.oc("ngIf","text"==t.type||"date"==t.type),o.Eb(1),o.oc("ngIf","number"==t.type||"round"==t.type)}}function K(t,e){if(1&t&&(o.Vb(0,"tr"),o.Kc(1,Y,3,2,"ng-container",37),o.Ub()),2&t){const t=o.gc();o.Eb(1),o.oc("ngForOf",t.columns)}}function N(t,e){if(1&t&&(o.Vb(0,"td",45),o.Mc(1),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc().$implicit;o.pc("title",e[t.field]),o.oc("ngStyle",o.sc(3,M,t.display)),o.Eb(1),o.Oc(" ",e[t.field]," ")}}function $(t,e){if(1&t&&(o.Vb(0,"td",46),o.Mc(1),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc().$implicit;o.pc("title",e[t.field]),o.oc("ngStyle",o.sc(3,M,t.display)),o.Eb(1),o.Oc(" ",e[t.field]," ")}}function k(t,e){if(1&t&&(o.Vb(0,"td",45),o.hc(1,"date"),o.Mc(2),o.hc(3,"date"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc().$implicit;o.pc("title",o.jc(1,3,e[t.field],"MM/dd/yyyy")),o.oc("ngStyle",o.sc(9,M,t.display)),o.Eb(2),o.Oc(" ",o.jc(3,6,e[t.field],"MM/dd/yyyy")," ")}}function F(t,e){if(1&t&&(o.Vb(0,"td",46),o.hc(1,"round"),o.Mc(2),o.hc(3,"round"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc().$implicit;o.pc("title",o.ic(1,3,e[t.field])),o.oc("ngStyle",o.sc(7,M,t.display)),o.Eb(2),o.Oc(" ",o.ic(3,5,e[t.field])," ")}}function O(t,e){if(1&t&&(o.Tb(0),o.Kc(1,N,2,5,"td",43),o.Kc(2,$,2,5,"td",44),o.Kc(3,k,4,11,"td",43),o.Kc(4,F,4,9,"td",44),o.Sb()),2&t){const t=e.$implicit;o.Eb(1),o.oc("ngIf","text"==t.type),o.Eb(1),o.oc("ngIf","number"==t.type),o.Eb(1),o.oc("ngIf","date"==t.type),o.Eb(1),o.oc("ngIf","round"==t.type)}}function x(t,e){if(1&t&&(o.Vb(0,"tr",42),o.Kc(1,O,5,4,"ng-container",37),o.Ub()),2&t){const t=e.columns;o.oc("pSelectableRow",e.$implicit),o.Eb(1),o.oc("ngForOf",t)}}function P(t,e){if(1&t&&o.Qb(0,"td",36),2&t){const t=o.gc().$implicit;o.oc("ngStyle",o.sc(1,M,t.display))}}function z(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1,"Totals:"),o.Ub()),2&t){const t=o.gc().$implicit;o.oc("ngStyle",o.sc(1,M,t.display))}}function D(t,e){if(1&t&&o.Qb(0,"td",36),2&t){const t=o.gc().$implicit;o.oc("ngStyle",o.sc(1,M,t.display))}}function j(t,e){if(1&t&&o.Qb(0,"td",49),2&t){const t=o.gc().$implicit;o.oc("ngStyle",o.sc(1,M,t.display))}}function L(t,e){if(1&t&&o.Qb(0,"td",49),2&t){const t=o.gc().$implicit;o.oc("ngStyle",o.sc(1,M,t.display))}}function Q(t,e){if(1&t&&o.Qb(0,"td",36),2&t){const t=o.gc().$implicit;o.oc("ngStyle",o.sc(1,M,t.display))}}function J(t,e){if(1&t&&o.Qb(0,"td",36),2&t){const t=o.gc().$implicit;o.oc("ngStyle",o.sc(1,M,t.display))}}function W(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalNetPrice,"1.2-2")," ")}}function q(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalTcv,"1.2-2")," ")}}function _(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalTcvRecurring,"1.2-2")," ")}}function B(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalTcvNonRecurring,"1.2-2")," ")}}function X(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalAcv,"1.2-2")," ")}}function G(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalAtr,"1.2-2")," ")}}function H(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalArrYear1,"1.2-2")," ")}}function Z(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalArrYear2,"1.2-2")," ")}}function tt(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalArrYear3,"1.2-2")," ")}}function et(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalArrYear4,"1.2-2")," ")}}function ct(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalArrYear5,"1.2-2")," ")}}function it(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalMrr,"1.2-2")," ")}}function lt(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalRpo,"1.2-2")," ")}}function nt(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalAllocatedAcv,"1.2-2")," ")}}function ot(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalAllocatedMrr,"1.2-2")," ")}}function rt(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalAllocationAmount,"1.2-2")," ")}}function at(t,e){if(1&t&&(o.Vb(0,"td",49),o.Mc(1),o.hc(2,"number"),o.Ub()),2&t){const t=o.gc().$implicit,e=o.gc(2);o.oc("ngStyle",o.sc(5,M,t.display)),o.Eb(1),o.Oc(" ",o.jc(2,2,e.totalRevenueAmount,"1.2-2")," ")}}function st(t,e){if(1&t&&(o.Tb(0),o.Kc(1,P,1,3,"td",47),o.Kc(2,z,2,3,"td",48),o.Kc(3,D,1,3,"td",47),o.Kc(4,j,1,3,"td",48),o.Kc(5,L,1,3,"td",48),o.Kc(6,Q,1,3,"td",47),o.Kc(7,J,1,3,"td",47),o.Kc(8,W,3,7,"td",48),o.Kc(9,q,3,7,"td",48),o.Kc(10,_,3,7,"td",48),o.Kc(11,B,3,7,"td",48),o.Kc(12,X,3,7,"td",48),o.Kc(13,G,3,7,"td",48),o.Kc(14,H,3,7,"td",48),o.Kc(15,Z,3,7,"td",48),o.Kc(16,tt,3,7,"td",48),o.Kc(17,et,3,7,"td",48),o.Kc(18,ct,3,7,"td",48),o.Kc(19,it,3,7,"td",48),o.Kc(20,lt,3,7,"td",48),o.Kc(21,nt,3,7,"td",48),o.Kc(22,ot,3,7,"td",48),o.Kc(23,rt,3,7,"td",48),o.Kc(24,at,3,7,"td",48),o.Sb()),2&t){const t=e.$implicit;o.Eb(1),o.oc("ngIf","text"==t.type&&"lineNumber"!=t.field),o.Eb(1),o.oc("ngIf","text"==t.type&&"lineNumber"==t.field),o.Eb(1),o.oc("ngIf","date"==t.type),o.Eb(1),o.oc("ngIf","number"==t.type&&"quantity"==t.field),o.Eb(1),o.oc("ngIf","number"==t.type&&"totalContractLength"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"unitListPrice"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"unitNetPrice"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"netPrice"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"tcv"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"tcvRecurring"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"tcvNonRecurring"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"acv"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"atr"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"arrYear1"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"arrYear2"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"arrYear3"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"arrYear4"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"arrYear5"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"mrr"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"rpo"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"allocatedAcv"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"allocatedMrr"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"allocationAmount"==t.field),o.Eb(1),o.oc("ngIf","round"==t.type&&"revenueAmount"==t.field)}}function dt(t,e){if(1&t&&(o.Vb(0,"tr"),o.Kc(1,st,25,24,"ng-container",37),o.Ub()),2&t){const t=o.gc();o.Eb(1),o.oc("ngForOf",t.columns)}}function ht(t,e){if(1&t&&(o.Vb(0,"div",50),o.Vb(1,"p"),o.Mc(2),o.Ub(),o.Ub()),2&t){const t=o.gc();o.Eb(2),o.Nc(t.noData)}}const gt=c("+yMW");let ut=(()=>{class t{constructor(t,e,c,l){this.rmanRevenueAnalyticsService=t,this.commonSharedService=e,this.notificationService=c,this.router=l,this.noData=gt.noData,this.loading=!0,this.revenueAnalyticsList=[],this.showAddColumns=!0,this.isSelectAllChecked=!0,this.showPaginator=!0,this.exportCols=[],this.disableExport=!0,this.totalNetPrice=0,this.totalTcv=0,this.totalTcvRecurring=0,this.totalTcvNonRecurring=0,this.totalAcv=0,this.totalArrYear1=0,this.totalArrYear2=0,this.totalArrYear3=0,this.totalArrYear4=0,this.totalArrYear5=0,this.totalAtr=0,this.totalMrr=0,this.totalRpo=0,this.totalAllocatedAcv=0,this.totalAllocatedMrr=0,this.totalAllocationAmount=0,this.totalRevenueAmount=0,this.paginationOptions={pageNumber:0,pageSize:"100"};const n=l.url.split("/")[3];n&&this.rmanRevenueAnalyticsService.setArrangementId(n),this.router.events.subscribe(t=>{if(t instanceof i.c){const e=t.url.split("/")[3];e&&this.rmanRevenueAnalyticsService.setArrangementId(e)}})}ngOnInit(){this.rmanRevenueAnalyticsService.getArrangementId()||this.notificationService.showError("No arrangement ID found. Please select a valid arrangement."),this.globalCols=[{field:"lineNumber",header:"Line Number",showField:!0,drag:!0,display:"table-cell",type:"text"},{field:"productName",header:"Product Name",showField:!0,drag:!0,display:"table-cell",type:"text"},{field:"chargeType",header:"Charge Type",showField:!0,drag:!0,display:"table-cell",type:"text"},{field:"quantity",header:"Qty",showField:!0,drag:!0,display:"table-cell",type:"number"},{field:"unitListPrice",header:"Unit List Price",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"netPrice",header:"Net Price",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"tcv",header:"TCV",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"tcvRecurring",header:"TCV Recurring",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"tcvNonRecurring",header:"TCV Non Recurring",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"acv",header:" Annualised ACV",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"atr",header:"ATR",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"arrYear1",header:"ARR Year 1",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"arrYear2",header:"ARR Year 2",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"arrYear3",header:"ARR Year 3",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"arrYear4",header:"ARR Year 4",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"arrYear5",header:"ARR Year 5",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"totalContractLength",header:"Total Contract Length",showField:!0,drag:!0,display:"table-cell",type:"number"},{field:"mrr",header:"MRR",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"rpo",header:"RPO",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"allocatedAcv",header:"Allocated ACV",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"allocatedMrr",header:"Allocated MRR",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"allocationAmount",header:"Allocation Amt ",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"revenueAmount",header:"Revenue Amt",showField:!0,drag:!0,display:"table-cell",type:"round"}],this.columns=[],this.getTableColumns("rmanRevenueAnalytics","Revenue Analytics")}getTableColumns(t,e){this.isSelectAllChecked=!0,this.commonSharedService.getConfiguredColDetails(t,e).then(t=>{if(t&&null!=t&&t.userId){this.columns=[];let e=t.tableColumns.split(",");e.length>0&&e.forEach((t,e)=>{t&&(this.startIndex=this.globalCols.findIndex(e=>e.field==t),this.onDrop(e))}),this.globalCols.forEach(t=>{-1!==e.indexOf(t.field)?this.columns.push(t):t.showField=!1}),this.columns.length!=this.globalCols.length&&(this.isSelectAllChecked=!1),this.showPaginator=0!==this.columns.length,this.userId=t.userId}else this.columns=this.globalCols;0===this.columns.length&&(this.columns=this.globalCols),this.getAllRevenueAnalytics()}).catch(t=>{this.notificationService.showError("Error occurred while getting table columns data"),this.loading=!1,this.columns=this.globalCols,this.getAllRevenueAnalytics()})}getAllRevenueAnalytics(){if(!this.rmanRevenueAnalyticsService.getArrangementId())return this.loading=!1,void this.notificationService.showError("Network failed / service is down.");this.loading=!0,this.rmanRevenueAnalyticsService.getAllRevenueAnalytics(this.paginationOptions).then(t=>{if(!t)return this.loading=!1,void this.notificationService.showError("Error occurred while getting data");this.revenueAnalyticsList=t.content||[],this.totalElements=t.totalElements||0,this.pageSize=t.size||10,this.contractTotals=t.contractTotals||{},this.calculateTotals(),this.loading=!1,this.disableExport=!1}).catch(t=>{this.notificationService.showError("Error occurred while getting data"),this.loading=!1})}getRevenueAnalytics(t){if(!this.rmanRevenueAnalyticsService.getArrangementId())return this.loading=!1,void this.notificationService.showError("Network failed / service is down.");this.paginationOptions={pageNumber:t.first/t.rows,pageSize:this.pageSize,sortField:t.sortField,sortOrder:t.sortOrder},this.loading=!0,this.rmanRevenueAnalyticsService.getAllRevenueAnalytics(this.paginationOptions).then(t=>{if(!t)return this.loading=!1,void this.notificationService.showError("Error occurred while getting data: Invalid response");this.revenueAnalyticsList=t.content||[],this.totalElements=t.totalElements||0,this.pageSize=t.size||10,this.contractTotals=t.contractTotals||{},this.calculateTotals(),this.loading=!1}).catch(t=>{this.notificationService.showError("Error occurred while getting data"),this.loading=!1})}calculateTotals(){this.totalNetPrice=0,this.totalTcv=0,this.totalTcvRecurring=0,this.totalTcvNonRecurring=0,this.totalAcv=0,this.totalArrYear1=0,this.totalArrYear2=0,this.totalArrYear3=0,this.totalArrYear4=0,this.totalArrYear5=0,this.totalAtr=0,this.totalMrr=0,this.totalRpo=0,this.totalAllocatedAcv=0,this.totalAllocatedMrr=0,this.totalAllocationAmount=0,this.totalRevenueAmount=0,this.contractTotals&&Object.keys(this.contractTotals).length>0&&(this.totalNetPrice=this.contractTotals.totalNetPrice||0,this.totalTcv=this.contractTotals.totalTcv||0,this.totalTcvRecurring=this.contractTotals.totalTcvRecurring||0,this.totalTcvNonRecurring=this.contractTotals.totalTcvNonRecurring||0,this.totalAcv=this.contractTotals.totalAcv||0,this.totalArrYear1=this.contractTotals.totalArrYear1||0,this.totalArrYear2=this.contractTotals.totalArrYear2||0,this.totalArrYear3=this.contractTotals.totalArrYear3||0,this.totalArrYear4=this.contractTotals.totalArrYear4||0,this.totalArrYear5=this.contractTotals.totalArrYear5||0,this.totalAtr=this.contractTotals.totalAtr||0,this.totalMrr=this.contractTotals.totalMrr||0,this.totalRpo=this.contractTotals.totalRpo||0,this.totalAllocatedAcv=this.contractTotals.totalAllocatedAcv||0,this.totalAllocatedMrr=this.contractTotals.totalAllocatedMrr||0,this.totalAllocationAmount=this.contractTotals.totalAllocationAmount||0,this.totalRevenueAmount=this.contractTotals.totalRevenueAmount||0)}saveColumns(){let t="";this.showAddColumns=!this.showAddColumns;const e=this.globalCols.length-1;this.globalCols.forEach((c,i)=>{c.showField&&(t+=c.field,i<e&&(t+=","))}),this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("rmanRevenueAnalytics","Revenue Analytics",t,this.userId).then(t=>{this.columns=this.globalCols.filter(t=>t.showField),this.userId=t.userId,this.showPaginator=0!==this.columns.length,this.loading=!1}).catch(()=>{this.notificationService.showError("Error occurred while saving columns"),this.loading=!1})}onDragStart(t){this.startIndex=t}onDrop(t){const e=this.globalCols[this.startIndex];this.globalCols.splice(this.startIndex,1),this.globalCols.splice(t,0,e)}selectColumns(t){let e=this.globalCols.filter(t=>!t.showField);this.isSelectAllChecked=!(e.length>0)}onSelectAll(){this.isSelectAllChecked=!this.isSelectAllChecked,this.globalCols.forEach(t=>{this.isSelectAllChecked?t.showField=!0:t.drag&&(t.showField=!1)})}onConfiguringColumns(t){this.clonedCols=JSON.parse(JSON.stringify(this.globalCols)),this.showAddColumns=!1}closeConfigureColumns(t){this.showAddColumns=!0,this.globalCols=this.clonedCols;let e=this.globalCols.filter(t=>!t.showField);this.isSelectAllChecked=!(e.length>0)}exportExcel(){this.dt?this.dt.exportCSV():this.notificationService.showError("Error while Exporting")}reset(t){this.rmanRevenueAnalyticsService.getArrangementId()?(this.paginationOptions={},t.reset(),this.getAllRevenueAnalytics()):this.notificationService.showError("Network failed / service is down.")}}return t.\u0275fac=function(e){return new(e||t)(o.Pb(s),o.Pb(l.a),o.Pb(n.a),o.Pb(i.g))},t.\u0275cmp=o.Jb({type:t,selectors:[["rmanRevenueAnalytics-data"]],viewQuery:function(t,e){var c;1&t&&o.Qc(y,!0),2&t&&o.Ac(c=o.ec())&&(e.dt=c.first)},features:[o.Db([s])],decls:19,vars:11,consts:[[1,"content-section","implementation"],["header","Revenue Analytics",1,"mb-1em"],[1,"pull-right","icons-list"],[1,"add-column",3,"click"],[1,"fa","fa-cog"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],["title","Export",3,"click",4,"ngIf"],["id","add-column-popup","class","contracts_add_column",4,"ngIf"],[1,"x-scroll"],["id","revenue-analytics-dt","selectionMode","single","scrollable","true","columnResizeMode","expand","exportFilename","Revenue Analytics ",1,"ui-datatable","arrangementMgrTbl","custom-datatable",3,"loading","columns","value","metaKeySelection","lazy","paginator","rows","totalRecords","resizableColumns","onLazyLoad"],["dt",""],["pTemplate","colgroup"],["pTemplate","header","class","arrangementMgrTblHead"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],["title","Export",3,"click"],[1,"fa","fa-external-link"],["id","add-column-popup",1,"contracts_add_column"],[1,"user-popup"],[1,"content","overflow"],["type","checkbox","id","selectall","name","selectall",3,"checked","click"],["for","selectall"],["title","Close",1,"close",3,"click"],[3,"options"],["pTemplate","item"],[1,"pull-right"],[1,"configColBtn",3,"click"],[1,"configColBtn","conf-cancel",3,"click"],[4,"ngIf"],["pDraggable","gens","pDroppable","gens",1,"ui-helper-clearfix",3,"onDragStart","onDrop"],[1,"drag"],["type","checkbox",3,"checked","ngModel","ngModelChange","change"],[1,"ui-helper-clearfix"],["type","checkbox",3,"checked","ngModel","disabled","ngModelChange","change"],[3,"ngStyle"],[4,"ngFor","ngForOf"],["pResizableColumn","",3,"ngStyle","title",4,"ngIf"],["class","number","pResizableColumn","",3,"ngStyle","title",4,"ngIf"],["pResizableColumn","",3,"ngStyle","title"],["pResizableColumn","",1,"number",3,"ngStyle","title"],[3,"pSelectableRow"],[3,"title","ngStyle",4,"ngIf"],["class","number",3,"title","ngStyle",4,"ngIf"],[3,"title","ngStyle"],[1,"number",3,"title","ngStyle"],[3,"ngStyle",4,"ngIf"],["class","number",3,"ngStyle",4,"ngIf"],[1,"number",3,"ngStyle"],[1,"no-results-data"]],template:function(t,e){if(1&t){const t=o.Wb();o.Qb(0,"div",0),o.Vb(1,"p-panel",1),o.Vb(2,"p-header"),o.Vb(3,"div",2),o.Vb(4,"a",3),o.dc("click",(function(t){return e.onConfiguringColumns(t)})),o.Qb(5,"em",4),o.Mc(6,"Columns"),o.Ub(),o.Vb(7,"a",5),o.dc("click",(function(){o.Dc(t);const c=o.Bc(13);return e.reset(c)})),o.Qb(8,"em",6),o.Ub(),o.Kc(9,v,2,0,"a",7),o.Kc(10,R,15,5,"div",8),o.Ub(),o.Ub(),o.Vb(11,"div",9),o.Vb(12,"p-table",10,11),o.dc("onLazyLoad",(function(t){return e.getRevenueAnalytics(t)})),o.Kc(14,I,2,1,"ng-template",12),o.Kc(15,K,2,1,"ng-template",13),o.Kc(16,x,2,2,"ng-template",14),o.Kc(17,dt,2,1,"ng-template",15),o.Kc(18,ht,3,1,"ng-template",16),o.Ub(),o.Ub(),o.Ub()}2&t&&(o.Eb(9),o.oc("ngIf",!e.disableExport),o.Eb(1),o.oc("ngIf",!e.showAddColumns),o.Eb(2),o.oc("loading",e.loading)("columns",e.columns)("value",e.revenueAnalyticsList)("metaKeySelection",!1)("lazy",!0)("paginator",e.showPaginator)("rows",e.pageSize)("totalRecords",e.totalElements)("resizableColumns",!0))},directives:[d.a,h.c,g.o,u.j,h.f,b.a,p.b,p.c,f.a,f.k,f.n,g.p,g.n,u.g,u.i],pipes:[g.f,m.a,g.g],encapsulation:2}),t})();var bt=c("PCNd");const pt=[{path:"",component:ut}];let ft=(()=>{class t{}return t.\u0275mod=o.Nb({type:t}),t.\u0275inj=o.Mb({factory:function(e){return new(e||t)},providers:[],imports:[[bt.a,i.k.forChild(pt)],i.k]}),t})()}}]);