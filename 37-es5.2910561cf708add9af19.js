!function(){function e(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function t(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function n(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{UAwC:function(t,i,c){"use strict";c.r(i),c.d(i,"RevenueSchedulesModule",(function(){return ye}));var o,r,l=c("tyNb"),s=c("PCNd"),a=c("JSOo"),u=c("J7oY"),d=c("fXoL"),h=c("tk/3"),f=c("+yMW"),g=((o=function(){function t(n){e(this,t),this.http=n}return n(t,[{key:"setArrangementId",value:function(e){this.arrgId=e}},{key:"getArrangementId",value:function(){return this.arrgId}},{key:"getAllRevenueSchedules",value:function(e){return this.arrgId?this.http.get(f.apiUrl+"/actualRevenueScheduleReport?arrgId="+this.arrgId+"&currType="+(e?"TC":"FC"),{headers:{"Content-Type":"application/json",Accept:"application/json"},responseType:"json"}).toPromise().then((function(e){if(!e)return{content:[]};try{return{content:e.Content||[]}}catch(t){return{content:[]}}})).catch((function(e){return{content:[]}})):Promise.resolve({content:[]})}}]),t}()).\u0275fac=function(e){return new(e||o)(d.Zb(h.b))},o.\u0275prov=d.Lb({token:o,factory:o.\u0275fac}),o),v=c("+yMW"),m=((r=function(){function t(n){e(this,t),this.http=n}return n(t,[{key:"getServiceUrl",value:function(e,t){return v.apiUrl+"/"+e+"?arrgId="+t}},{key:"getAllRevenueSchedulesHistory",value:function(e){if(!e)return Promise.resolve({content:[]});var t=this.getServiceUrl("actualRevenueSchedulesHistory",e);return this.http.get(t,{headers:{"Content-Type":"application/json",Accept:"application/json"},responseType:"json"}).toPromise().then((function(e){if(!e)return{content:[]};try{return{content:e.Content||[]}}catch(t){return{content:e}}})).catch((function(e){return{content:[]}}))}}]),t}()).\u0275fac=function(e){return new(e||r)(d.Zb(h.b))},r.\u0275prov=d.Lb({token:r,factory:r.\u0275fac}),r),b=c("7CaW"),p=c("7zfz"),C=c("ofXK"),y=c("rEr+"),S=c("+07z"),k=c("TjhJ"),w=c("3Pt+"),E=c("fyqy"),x=["dt"];function U(e,t){if(1&e){var n=d.Wb();d.Vb(0,"a",16),d.dc("click",(function(){d.Dc(n);var e=d.gc(),t=d.Bc(13);return e.exportExcel(t)})),d.Qb(1,"em",17),d.Ub()}}function A(e,t){if(1&e){var n=d.Wb();d.Vb(0,"div",30),d.Vb(1,"div",31),d.dc("onDragStart",(function(){d.Dc(n);var e=d.gc().index;return d.gc(2).onDragStart(e)}))("onDrop",(function(){d.Dc(n);var e=d.gc().index;return d.gc(2).onDrop(e)})),d.Vb(2,"div",32),d.Vb(3,"input",33),d.dc("ngModelChange",(function(e){return d.Dc(n),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(n);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(4,"label"),d.Mc(5),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(3),d.oc("checked",i.showField)("ngModel",i.showField),d.Eb(2),d.Nc(i.header)}}var I=function(){return{color:"grey"}};function D(e,t){if(1&e){var n=d.Wb();d.Vb(0,"div",30),d.Vb(1,"div",34),d.Vb(2,"div",30),d.Vb(3,"div",32),d.Vb(4,"input",35),d.dc("ngModelChange",(function(e){return d.Dc(n),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(n);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(5,"label",36),d.Mc(6),d.Ub(),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(4),d.oc("checked",i.showField)("ngModel",i.showField)("disabled",!i.drag),d.Eb(1),d.oc("ngStyle",d.rc(5,I)),d.Eb(1),d.Nc(i.header)}}function V(e,t){if(1&e&&(d.Kc(0,A,6,3,"div",29),d.Kc(1,D,7,6,"div",29)),2&e){var n=t.$implicit;d.oc("ngIf",n.drag),d.Eb(1),d.oc("ngIf",!n.drag)}}var H=function(){return{width:"100%",height:"100%"}};function M(e,t){if(1&e){var n=d.Wb();d.Vb(0,"div",18),d.Vb(1,"div",19),d.Vb(2,"div",20),d.Vb(3,"input",21),d.dc("click",(function(){return d.Dc(n),d.gc().onSelectAll()})),d.Ub(),d.Vb(4,"label",22),d.Mc(5,"Select All"),d.Ub(),d.Vb(6,"a",23),d.dc("click",(function(e){return d.Dc(n),d.gc().closeConfigureColumns(e)})),d.Mc(7,"\xd7"),d.Ub(),d.Vb(8,"p-listbox",24),d.Kc(9,V,2,2,"ng-template",25),d.Ub(),d.Ub(),d.Vb(10,"div",26),d.Vb(11,"a",27),d.dc("click",(function(){return d.Dc(n),d.gc().saveColumns()})),d.Mc(12,"Save"),d.Ub(),d.Vb(13,"a",28),d.dc("click",(function(e){return d.Dc(n),d.gc().closeConfigureColumns(e)})),d.Mc(14,"Cancel"),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc();d.Eb(3),d.oc("checked",i.isSelectAllChecked),d.Eb(5),d.Ic(d.rc(4,H)),d.oc("options",i.revHistColumns)}}function F(e,t){1&e&&d.Qb(0,"col")}function R(e,t){if(1&e&&(d.Vb(0,"colgroup"),d.Kc(1,F,1,0,"col",37),d.Ub()),2&e){var n=t.$implicit;d.Eb(1),d.oc("ngForOf",n)}}var O=function(e,t){return{display:e,"text-align":t}};function T(e,t){if(1&e&&(d.Vb(0,"th",39),d.Mc(1),d.Ub()),2&e){var n=t.$implicit;d.oc("ngStyle",d.tc(2,O,n.display,n.text)),d.Eb(1),d.Oc(" ",n.header," ")}}function N(e,t){if(1&e&&(d.Vb(0,"tr"),d.Kc(1,T,2,5,"th",38),d.Ub()),2&e){var n=d.gc();d.Eb(1),d.oc("ngForOf",n.columns)}}function K(e,t){if(1&e&&(d.Vb(0,"span"),d.Mc(1),d.hc(2,"roundCurrency"),d.Ub()),2&e){var n=d.gc().$implicit,i=d.gc().$implicit;d.Eb(1),d.Oc(" ",d.jc(2,1,i[n.field],i.Currency)," ")}}function $(e,t){if(1&e&&(d.Mc(0),d.hc(1,"number")),2&e){var n=d.gc().$implicit,i=d.gc().$implicit,c=d.gc();d.Oc(" ","number"===c.fieldType(i[n.field])?d.jc(1,1,i[n.field],"1.2-2"):i[n.field]," ")}}function P(e,t){if(1&e&&(d.Vb(0,"td",39),d.Kc(1,K,3,4,"span",41),d.Kc(2,$,2,4,"ng-template",null,42,d.Lc),d.Ub()),2&e){var n=t.$implicit,i=d.Bc(3),c=d.gc().$implicit,o=d.gc();d.oc("ngStyle",d.tc(3,O,n.display,n.text)),d.Eb(1),d.oc("ngIf",o.isCurrencyField(n.field)&&null!=c[n.field])("ngIfElse",i)}}function J(e,t){if(1&e&&(d.Vb(0,"tr",40),d.Kc(1,P,4,6,"td",38),d.Ub()),2&e){var n=t.$implicit,i=d.gc();d.oc("pSelectableRow",n),d.Eb(1),d.oc("ngForOf",i.columns)}}function W(e,t){if(1&e&&(d.Vb(0,"div",43),d.Vb(1,"p"),d.Mc(2),d.Ub(),d.Ub()),2&e){var n=d.gc();d.Eb(2),d.Nc(n.noData)}}var L,Q=c("+yMW"),j=((L=function(){function t(n,i,c,o){e(this,t),this.rmanRevenueSchedulesHistoryService=n,this.commonSharedService=i,this.notificationService=c,this.router=o,this.noData=Q.noData,this.loading=!0,this.revenueSchedulesHistoryList=[],this.columns=[],this.pageSize=10,this.totalElements=0,this.pageNumber=0,this.isTCSelected=!0,this.showAddColumns=!0,this.isSelectAllChecked=!0,this.showPaginator=!0,this.disableExport=!0}return n(t,[{key:"ngOnInit",value:function(){this.columns=[]}},{key:"ngOnDestroy",value:function(){this.columns=[]}},{key:"getTableColumns",value:function(e,t){var n=this;this.isSelectAllChecked=!0,this.commonSharedService.getConfiguredColDetails(e,t).then((function(e){if(e&&null!=e&&e.userId){n.columns=[];var t=e.tableColumns.split(",");t.length>0&&t.forEach((function(e,t){e&&(n.startIndex=n.revHistColumns.findIndex((function(t){return t.field==e})),n.onDrop(t))})),n.revHistColumns.forEach((function(e){-1!==t.indexOf(e.field)||1==n.checkIfStringStartsWith(e.field)?n.columns.push(e):e.showField=!1})),n.columns.length!=n.revHistColumns.length&&(n.isSelectAllChecked=!1),n.showPaginator=0!==n.columns.length,n.userId=e.userId}else n.columns=n.revHistColumns;void 0===n.columns&&(n.columns=n.revHistColumns)})).catch((function(e){n.notificationService.showError("Error occurred while getting table columns data"),n.loading=!1,n.columns=n.revHistColumns}))}},{key:"checkIfStringStartsWith",value:function(e){return["Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"].some((function(t){return e.startsWith(t)}))}},{key:"getAllRevenueSchedulesHistory",value:function(){var e=this;if(!this.arrgId)return this.loading=!1,void this.notificationService.showError("Network failed / service is down.");this.loading=!0,this.rmanRevenueSchedulesHistoryService.getAllRevenueSchedulesHistory(this.arrgId).then((function(t){var n;if(!t)return e.loading=!1,void e.notificationService.showError("Error occurred while getting data");var i=t.content||[],c=i[0],o=Object.values(c).every((function(e){return null==e}));if(e.totalElements=o?0:i.length||0,i.length>0){for(var r in e.revHistColumns=[],c)e.revHistColumns.push({field:r,header:r,display:"table-cell",text:"right",drag:!e.checkIfStringStartsWith(r),showField:!0});for(var l=["Product Name"],s=0;s<e.revHistColumns.length;s++)e.revHistColumns[s].text=-1==l.indexOf(e.revHistColumns[s].header)?"right":"left";e.revenueSchedulesHistoryList=o?[]:i,e.getTableColumns("rmanRevenueSchedulesHistory","Revenue Schedules History"),e.clonedCols=e.columns,e.currencyCode=null!==(n=c["Currency Code"])&&void 0!==n?n:"USD",e.disableExport=!!o}e.loading=!1})).catch((function(t){e.notificationService.showError("Error occurred while getting data"),e.loading=!1}))}},{key:"toTitleCase",value:function(e){return e.replace(/([A-Z])/g," $1").replace(/^./,(function(e){return e.toUpperCase()}))}},{key:"clearAllRevenueSchedulesHistory",value:function(){this.revenueSchedulesHistoryList=[],this.totalElements=0}},{key:"onPageChange",value:function(e){this.arrgId&&(this.pageNumber=e.first/e.rows,this.getAllRevenueSchedulesHistory())}},{key:"saveColumns",value:function(){var e=this,t="";this.showAddColumns=!this.showAddColumns;var n=this.revHistColumns.length-1;this.revHistColumns.forEach((function(i,c){i.showField&&0==e.checkIfStringStartsWith(i.field)&&(t+=i.field,c<n&&(t+=","))})),this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("rmanRevenueSchedulesHistory","Revenue Schedules History",t,this.userId).then((function(t){e.columns=e.revHistColumns.filter((function(e){return e.showField})),e.userId=t.userId,e.showPaginator=0!==e.columns.length,e.loading=!1})).catch((function(){e.notificationService.showError("Error occurred while saving columns"),e.loading=!1})),this.clonedCols=this.columns}},{key:"onDragStart",value:function(e){this.startIndex=e}},{key:"onDrop",value:function(e){var t=this.revHistColumns[this.startIndex];this.startIndex>=0&&(this.revHistColumns.splice(this.startIndex,1),this.revHistColumns.splice(e,0,t));var n=this.columns.map((function(e){return e.field}));this.columns=this.revHistColumns.filter((function(e){return n.includes(e.field)}))}},{key:"selectColumns",value:function(e){var t=this.revHistColumns.filter((function(e){return!e.showField}));this.isSelectAllChecked=!(t.length>0)}},{key:"onSelectAll",value:function(){var e=this;this.isSelectAllChecked=!this.isSelectAllChecked,this.revHistColumns.forEach((function(t){e.isSelectAllChecked?t.showField=!0:t.drag&&(t.showField=!1)}))}},{key:"onConfiguringColumns",value:function(e){this.clonedCols=JSON.parse(JSON.stringify(this.revHistColumns)),this.showAddColumns=!1}},{key:"closeConfigureColumns",value:function(e){this.showAddColumns=!0,this.revHistColumns=this.clonedCols;var t=this.revHistColumns.filter((function(e){return e.showField}));this.isSelectAllChecked=t.length==this.revHistColumns.length,this.columns=t}},{key:"exportExcel",value:function(){this.dt?this.dt.exportCSV():this.notificationService.showError("Error while Exporting")}},{key:"reset",value:function(e){this.arrgId?(this.getAllRevenueSchedulesHistory(),e.clear()):this.notificationService.showError("Network failed / service is down.")}},{key:"fieldType",value:function(e){["Revenue Contract Number","POB ID","Quantity"].indexOf(e)}},{key:"isCurrencyField",value:function(e){return["Unit Net Price","Net Price","Allocation Amount"].includes(e)||/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-\d{2}$/.test(e)}},{key:"isNumber",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}}]),t}()).\u0275fac=function(e){return new(e||L)(d.Pb(m),d.Pb(a.a),d.Pb(u.a),d.Pb(l.g))},L.\u0275cmp=d.Jb({type:L,selectors:[["rmanRevenueSchedulesHistory-data"]],viewQuery:function(e,t){var n;1&e&&d.Qc(x,!0),2&e&&d.Ac(n=d.ec())&&(t.dt=n.first)},features:[d.Db([m])],decls:18,vars:10,consts:[[1,"content-section","implementation"],["header","",1,"mb-1em"],[1,"pull-right","icons-list"],[1,"add-column",3,"click"],[1,"fa","fa-cog"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],["title","Export",3,"click",4,"ngIf"],["id","add-column-popup","class","contracts_add_column",4,"ngIf"],[1,"x-scroll"],["id","revenueSchedulesHistory-dt","scrollable","true","selectionMode","single","exportFilename","Actual Revenue Schedules History",1,"ui-datatable","arrangementMgrTbl",3,"value","loading","rows","totalRecords","columns","lazy","paginator","metaKeySelection"],["dt",""],["pTemplate","colgroup"],["pTemplate","header","class","arrangementMgrTblHead"],["pTemplate","body"],["pTemplate","emptymessage"],["title","Export",3,"click"],[1,"fa","fa-external-link"],["id","add-column-popup",1,"contracts_add_column"],[1,"user-popup"],[1,"content","overflow"],["type","checkbox","id","selectall","name","selectall",2,"width","13px !important",3,"checked","click"],["for","selectall"],["title","Close",1,"close",3,"click"],[3,"options"],["pTemplate","item"],[1,"pull-right"],[1,"configColBtn",3,"click"],[1,"configColBtn","conf-cancel",3,"click"],["style","display:flex; width: 100% !important",4,"ngIf"],[2,"display","flex","width","100% !important"],["pDraggable","gens","pDroppable","gens",1,"ui-helper-clearfix",2,"width","100%",3,"onDragStart","onDrop"],[1,"drag",2,"width","100% !important"],["type","checkbox",2,"width","13px !important",3,"checked","ngModel","ngModelChange","change"],[1,"ui-helper-clearfix",2,"width","100%"],["type","checkbox",2,"width","13px !important",3,"checked","ngModel","disabled","ngModelChange","change"],[3,"ngStyle"],[4,"ngFor","ngForOf"],["style","width: 150px;",3,"ngStyle",4,"ngFor","ngForOf"],[2,"width","150px",3,"ngStyle"],[3,"pSelectableRow"],[4,"ngIf","ngIfElse"],["normalText",""],[1,"no-results-data"]],template:function(e,t){if(1&e){var n=d.Wb();d.Qb(0,"div",0),d.Vb(1,"p-panel",1),d.Vb(2,"p-header"),d.Vb(3,"div",2),d.Vb(4,"a",3),d.dc("click",(function(e){return t.onConfiguringColumns(e)})),d.Qb(5,"em",4),d.Mc(6,"Columns"),d.Ub(),d.Vb(7,"a",5),d.dc("click",(function(){d.Dc(n);var e=d.Bc(13);return t.reset(e)})),d.Qb(8,"em",6),d.Ub(),d.Kc(9,U,2,0,"a",7),d.Kc(10,M,15,5,"div",8),d.Ub(),d.Ub(),d.Vb(11,"div",9),d.Vb(12,"p-table",10,11),d.Kc(14,R,2,1,"ng-template",12),d.Kc(15,N,2,1,"ng-template",13),d.Kc(16,J,2,2,"ng-template",14),d.Kc(17,W,3,1,"ng-template",15),d.Ub(),d.Ub(),d.Ub()}2&e&&(d.Eb(9),d.oc("ngIf",!t.disableExport),d.Eb(1),d.oc("ngIf",!t.showAddColumns),d.Eb(2),d.oc("value",t.revenueSchedulesHistoryList)("loading",t.loading)("rows",t.pageSize)("totalRecords",t.totalElements)("columns",t.columns)("lazy",!1)("paginator",!0)("metaKeySelection",!1))},directives:[b.a,p.c,C.o,y.j,p.f,S.a,k.b,k.c,w.a,w.k,w.n,C.p,C.n,y.i],pipes:[E.a,C.g],encapsulation:2}),L),z=c("Y+ZO"),B=c("/RsI"),_=["dt"],Z=["revHistory"];function X(e,t){if(1&e){var n=d.Wb();d.Vb(0,"a",22),d.dc("click",(function(){d.Dc(n);var e=d.gc(),t=d.Bc(17);return e.exportExcel(t)})),d.Qb(1,"em",23),d.Ub()}}function Y(e,t){if(1&e){var n=d.Wb();d.Vb(0,"div",36),d.Vb(1,"div",37),d.dc("onDragStart",(function(){d.Dc(n);var e=d.gc().index;return d.gc(2).onDragStart(e)}))("onDrop",(function(){d.Dc(n);var e=d.gc().index;return d.gc(2).onDrop(e)})),d.Vb(2,"div",38),d.Vb(3,"input",39),d.dc("ngModelChange",(function(e){return d.Dc(n),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(n);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(4,"label"),d.Mc(5),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(3),d.oc("checked",i.showField)("ngModel",i.showField),d.Eb(2),d.Nc(i.header)}}var q=function(){return{color:"grey"}};function G(e,t){if(1&e){var n=d.Wb();d.Vb(0,"div",36),d.Vb(1,"div",40),d.Vb(2,"div",36),d.Vb(3,"div",38),d.Vb(4,"input",41),d.dc("ngModelChange",(function(e){return d.Dc(n),d.gc().$implicit.showField=e}))("change",(function(){d.Dc(n);var e=d.gc().$implicit;return d.gc(2).selectColumns(e)})),d.Ub(),d.Vb(5,"label",42),d.Mc(6),d.Ub(),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc().$implicit;d.Eb(4),d.oc("checked",i.showField)("ngModel",i.showField)("disabled",!i.drag),d.Eb(1),d.oc("ngStyle",d.rc(5,q)),d.Eb(1),d.Nc(i.header)}}function ee(e,t){if(1&e&&(d.Kc(0,Y,6,3,"div",35),d.Kc(1,G,7,6,"div",35)),2&e){var n=t.$implicit;d.oc("ngIf",n.drag),d.Eb(1),d.oc("ngIf",!n.drag)}}var te=function(){return{width:"100%",height:"100%"}};function ne(e,t){if(1&e){var n=d.Wb();d.Vb(0,"div",24),d.Vb(1,"div",25),d.Vb(2,"div",26),d.Vb(3,"input",27),d.dc("click",(function(){return d.Dc(n),d.gc().onSelectAll()})),d.Ub(),d.Vb(4,"label",28),d.Mc(5,"Select All"),d.Ub(),d.Vb(6,"a",29),d.dc("click",(function(e){return d.Dc(n),d.gc().closeConfigureColumns(e)})),d.Mc(7,"\xd7"),d.Ub(),d.Vb(8,"p-listbox",30),d.Kc(9,ee,2,2,"ng-template",31),d.Ub(),d.Ub(),d.Vb(10,"div",32),d.Vb(11,"a",33),d.dc("click",(function(){return d.Dc(n),d.gc().saveColumns()})),d.Mc(12,"Save"),d.Ub(),d.Vb(13,"a",34),d.dc("click",(function(e){return d.Dc(n),d.gc().closeConfigureColumns(e)})),d.Mc(14,"Cancel"),d.Ub(),d.Ub(),d.Ub(),d.Ub()}if(2&e){var i=d.gc();d.Eb(3),d.oc("checked",i.isSelectAllChecked),d.Eb(5),d.Ic(d.rc(4,te)),d.oc("options",i.revColumns)}}function ie(e,t){1&e&&d.Qb(0,"col")}function ce(e,t){if(1&e&&(d.Vb(0,"colgroup"),d.Kc(1,ie,1,0,"col",43),d.Ub()),2&e){var n=t.$implicit;d.Eb(1),d.oc("ngForOf",n)}}var oe=function(e,t){return{display:e,"text-align":t}};function re(e,t){if(1&e&&(d.Vb(0,"th",45),d.Mc(1),d.Ub()),2&e){var n=t.$implicit;d.oc("ngStyle",d.tc(2,oe,n.display,n.text)),d.Eb(1),d.Oc(" ",n.header," ")}}function le(e,t){if(1&e&&(d.Vb(0,"tr"),d.Kc(1,re,2,5,"th",44),d.Ub()),2&e){var n=d.gc();d.Eb(1),d.oc("ngForOf",n.columns)}}function se(e,t){if(1&e&&(d.Vb(0,"span"),d.Mc(1),d.hc(2,"roundCurrency"),d.Ub()),2&e){var n=d.gc().$implicit,i=d.gc().$implicit;d.Eb(1),d.Oc(" ",d.jc(2,1,i[n.field],i["Currency Code"])," ")}}function ae(e,t){if(1&e&&(d.Mc(0),d.hc(1,"number")),2&e){var n=d.gc().$implicit,i=d.gc().$implicit,c=d.gc();d.Oc(" ","number"===c.fieldType(i[n.field])?d.jc(1,1,i[n.field],"1.2-2"):i[n.field]," ")}}function ue(e,t){if(1&e&&(d.Vb(0,"td",45),d.Kc(1,se,3,4,"span",47),d.Kc(2,ae,2,4,"ng-template",null,48,d.Lc),d.Ub()),2&e){var n=t.$implicit,i=d.Bc(3),c=d.gc().$implicit,o=d.gc();d.oc("ngStyle",d.tc(3,oe,n.display,n.text)),d.Eb(1),d.oc("ngIf",o.isCurrencyField(n.field)&&null!=c[n.field])("ngIfElse",i)}}function de(e,t){if(1&e&&(d.Vb(0,"tr",46),d.Kc(1,ue,4,6,"td",44),d.Ub()),2&e){var n=t.$implicit,i=d.gc();d.oc("pSelectableRow",n),d.Eb(1),d.oc("ngForOf",i.columns)}}function he(e,t){if(1&e&&(d.Vb(0,"td",51),d.Mc(1),d.hc(2,"roundCurrency"),d.Ub()),2&e){var n=t.$implicit,i=d.gc(3);d.oc("ngStyle",d.tc(5,oe,n.display,n.text)),d.Eb(1),d.Oc(" ",i.totals&&null!=i.totals[n.field]?d.jc(2,2,i.totals[n.field],i.currencyCode):""," ")}}function fe(e,t){if(1&e&&(d.Vb(0,"tr"),d.Kc(1,he,3,8,"td",50),d.Ub()),2&e){var n=d.gc(2);d.Eb(1),d.oc("ngForOf",n.columns)}}function ge(e,t){if(1&e&&d.Kc(0,fe,2,1,"tr",49),2&e){var n=d.gc();d.oc("ngIf",n.revenueSchedulesList&&n.revenueSchedulesList.length>0)}}function ve(e,t){if(1&e&&(d.Vb(0,"div",52),d.Vb(1,"p"),d.Mc(2),d.Ub(),d.Ub()),2&e){var n=d.gc();d.Eb(2),d.Nc(n.noData)}}var me,be,pe=c("+yMW"),Ce=[{path:"",component:(me=function(){function t(n,i,c,o){var r=this;e(this,t),this.rmanRevenueSchedulesService=n,this.commonSharedService=i,this.notificationService=c,this.router=o,this.noData=pe.noData,this.loading=!0,this.historyDialog=!1,this.revenueSchedulesList=[],this.pageSize=10,this.totalElements=0,this.isTCSelected=!0,this.totals={},this.showAddColumns=!0,this.isSelectAllChecked=!0,this.showPaginator=!0,this.exportCols=[],this.disableExport=!0;var s=o.url.split("/")[3];s&&this.rmanRevenueSchedulesService.setArrangementId(s),this.router.events.subscribe((function(e){if(e instanceof l.c){var t=e.url.split("/")[3];t&&r.rmanRevenueSchedulesService.setArrangementId(t)}}))}return n(t,[{key:"ngOnInit",value:function(){this.arrgId=this.rmanRevenueSchedulesService.getArrangementId(),this.arrgId||this.notificationService.showError("No arrangement ID found. Please select a valid arrangement."),this.columns=[],this.getAllRevenueSchedules()}},{key:"getTableColumns",value:function(e,t){var n=this;this.isSelectAllChecked=!0;var i=["Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"];this.commonSharedService.getConfiguredColDetails(e,t).then((function(e){if(e&&null!=e&&e.userId){n.columns=[];var t=e.tableColumns.split(",");t.length>0&&t.forEach((function(e,t){e&&(n.startIndex=n.revColumns.findIndex((function(t){return t.field==e})),n.onDrop(t))})),n.revColumns.forEach((function(e){-1!==t.indexOf(e.field)||1==n.checkIfStringStartsWith(e.field,i)?n.columns.push(e):e.showField=!1})),n.columns.length!=n.revColumns.length&&(n.isSelectAllChecked=!1),n.showPaginator=0!==n.columns.length,n.userId=e.userId}else n.columns=n.revColumns;0===n.columns.length&&(n.columns=n.revColumns)})).catch((function(e){n.notificationService.showError("Error occurred while getting table columns data"),n.loading=!1,n.columns=n.revColumns}))}},{key:"checkIfStringStartsWith",value:function(e,t){return["Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"].some((function(t){return e.startsWith(t)}))}},{key:"getAllRevenueSchedules",value:function(){var e=this;if(!this.rmanRevenueSchedulesService.getArrangementId())return this.loading=!1,void this.notificationService.showError("Network failed / service is down.");this.loading=!0,this.rmanRevenueSchedulesService.getAllRevenueSchedules(this.isTCSelected).then((function(t){var n;if(!t)return e.loading=!1,void e.notificationService.showError("Error occurred while getting data");var i=t.content||[],c=i[0],o=Object.values(c).every((function(e){return null==e}));if(e.totalElements=o?0:i.length||0,i.length>0){for(var r in e.revColumns=[],c)e.revColumns.push({field:r,header:r,display:"table-cell",text:"right",drag:!e.checkIfStringStartsWith(r,null),showField:!0});for(var l=["Product Name"],s=0;s<e.revColumns.length;s++)e.revColumns[s].text=-1==l.indexOf(e.revColumns[s].header)?"right":"left";e.revenueSchedulesList=o?[]:i,e.getTableColumns("rmanRevenueSchedules","Revenue Schedules"),e.clonedCols=e.columns,e.calculateTotals(),e.currencyCode=null!==(n=c["Currency Code"])&&void 0!==n?n:"USD",e.disableExport=!!o}e.loading=!1})).catch((function(t){e.notificationService.showError("Error occurred while getting data"),e.loading=!1}))}},{key:"onPageChange",value:function(e){this.pageSize=e.rows}},{key:"calculateTotals",value:function(){var e=this,t=["Deal Line Number","Product Reference Id","Quote Line Number","Quote Number","Quote Reference Id","Revenue Contract Number","Revenue Term in Days","Revenue Term in Months","Assset ID","Order Number","Order Line Number","Parent Line Number"];this.revColumns.forEach((function(n){t.includes(n.header)||(e.totals[n.field]=null)})),this.revenueSchedulesList.forEach((function(n){e.revColumns.forEach((function(i){if(!t.includes(i.header)){var c=n[i.field];e.isNumber(c)&&(e.totals[i.field]+=parseFloat(c))}}))}))}},{key:"saveColumns",value:function(){var e=this,t="";this.showAddColumns=!this.showAddColumns;var n=this.revColumns.length-1;this.revColumns.forEach((function(i,c){i.showField&&0==e.checkIfStringStartsWith(i.field,["Jan-","Feb-","Mar-","Apr-","May-","Jun-","Jul-","Aug-","Sep-","Oct-","Nov-","Dec-","Future"])&&(t+=i.field,c<n&&(t+=","))})),this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("rmanRevenueSchedules","Revenue Schedules",t,this.userId).then((function(t){e.columns=e.revColumns.filter((function(e){return e.showField})),e.userId=t.userId,e.showPaginator=0!==e.columns.length,e.loading=!1})).catch((function(){e.notificationService.showError("Error occurred while saving columns"),e.loading=!1})),this.clonedCols=this.columns}},{key:"onDragStart",value:function(e){this.startIndex=e}},{key:"onDrop",value:function(e){var t=this.revColumns[this.startIndex];this.startIndex>=0&&(this.revColumns.splice(this.startIndex,1),this.revColumns.splice(e,0,t));var n=this.columns.map((function(e){return e.field}));this.columns=this.revColumns.filter((function(e){return n.includes(e.field)}))}},{key:"selectColumns",value:function(e){var t=this.revColumns.filter((function(e){return!e.showField}));this.isSelectAllChecked=!(t.length>0)}},{key:"onSelectAll",value:function(){var e=this;this.isSelectAllChecked=!this.isSelectAllChecked,this.revColumns.forEach((function(t){e.isSelectAllChecked?t.showField=!0:t.drag&&(t.showField=!1)}))}},{key:"onConfiguringColumns",value:function(e){this.clonedCols=JSON.parse(JSON.stringify(this.revColumns)),this.showAddColumns=!1}},{key:"closeConfigureColumns",value:function(e){this.showAddColumns=!0,this.revColumns=this.clonedCols;var t=this.revColumns.filter((function(e){return e.showField}));this.isSelectAllChecked=t.length==this.revColumns.length,this.columns=t}},{key:"exportExcel",value:function(){this.dt?this.dt.exportCSV():this.notificationService.showError("Error while Exporting")}},{key:"reset",value:function(e){this.rmanRevenueSchedulesService.getArrangementId()?(this.getAllRevenueSchedules(),e.clear()):this.notificationService.showError("Network failed / service is down.")}},{key:"fieldType",value:function(e){return typeof e}},{key:"isCurrencyField",value:function(e){return["Unit Net Price","Net Price","Allocation Amount","Line Amount","Delivered Line Amount","Delivered Alloc Amount","To be delivered - Line amount","To be delivered - Allocation amount"].includes(e)||/^(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)-\d{2}$/.test(e)}},{key:"isNumber",value:function(e){return!isNaN(parseFloat(e))&&isFinite(e)}},{key:"getHistory",value:function(){this.historyDialog=!0}},{key:"onHistoryDialogOpen",value:function(){this.revHistoryComp&&(this.revHistoryComp.arrgId=this.arrgId,this.revHistoryComp.getTableColumns("rmanRevenueSchedulesHistory","Revenue Schedules History"),this.revHistoryComp.getAllRevenueSchedulesHistory())}},{key:"onHistoryDialogClose",value:function(){this.historyDialog=!1,this.revHistoryComp.clearAllRevenueSchedulesHistory()}}]),t}(),me.\u0275fac=function(e){return new(e||me)(d.Pb(g),d.Pb(a.a),d.Pb(u.a),d.Pb(l.g))},me.\u0275cmp=d.Jb({type:me,selectors:[["rmanRevenueSchedules-data"]],viewQuery:function(e,t){var n;1&e&&(d.Qc(_,!0),d.Qc(Z,!0)),2&e&&(d.Ac(n=d.ec())&&(t.dt=n.first),d.Ac(n=d.ec())&&(t.revHistoryComp=n.first))},features:[d.Db([g])],decls:26,vars:14,consts:[[1,"content-section","implementation"],["header","Actual Revenue Schedules",1,"mb-1em"],[1,"pull-right","icons-list"],["onLabel","TC","offLabel","FC","onIcon","fa fa-toggle-on fa-sm","offIcon","fa fa-toggle-off fa-sm",1,"ui-inputswitch",3,"ngModel","ngModelChange"],[1,"add-column",3,"click"],[1,"fa","fa-cog"],["title","History",1,"add-column",3,"click"],[1,"fa","fa-history"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],["title","Export",3,"click",4,"ngIf"],["id","add-column-popup","class","contracts_add_column",4,"ngIf"],[1,"x-scroll"],["id","actualRevSchedules-dt","scrollable","true","selectionMode","single","exportFilename","Actual Revenue Schedules",1,"ui-datatable","arrangementMgrTbl",3,"value","loading","rows","totalRecords","columns","lazy","paginator","metaKeySelection"],["dt",""],["pTemplate","colgroup"],["pTemplate","header","class","arrangementMgrTblHead"],["pTemplate","body"],["pTemplate","footer"],["pTemplate","emptymessage"],["header","Revenue Schedules History","id","journals","width","1300","showEffect","fade",1,"accounting-dialog",3,"visible","draggable","modal","visibleChange","onShow","onHide"],["revHistory",""],["title","Export",3,"click"],[1,"fa","fa-external-link"],["id","add-column-popup",1,"contracts_add_column"],[1,"user-popup"],[1,"content","overflow"],["type","checkbox","id","selectall","name","selectall",2,"width","13px !important",3,"checked","click"],["for","selectall"],["title","Close",1,"close",3,"click"],[3,"options"],["pTemplate","item"],[1,"pull-right"],[1,"configColBtn",3,"click"],[1,"configColBtn","conf-cancel",3,"click"],["style","display:flex; width: 100% !important",4,"ngIf"],[2,"display","flex","width","100% !important"],["pDraggable","gens","pDroppable","gens",1,"ui-helper-clearfix",2,"width","100%",3,"onDragStart","onDrop"],[1,"drag",2,"width","100% !important"],["type","checkbox",2,"width","13px !important",3,"checked","ngModel","ngModelChange","change"],[1,"ui-helper-clearfix",2,"width","100%"],["type","checkbox",2,"width","13px !important",3,"checked","ngModel","disabled","ngModelChange","change"],[3,"ngStyle"],[4,"ngFor","ngForOf"],["style","width: 150px;",3,"ngStyle",4,"ngFor","ngForOf"],[2,"width","150px",3,"ngStyle"],[3,"pSelectableRow"],[4,"ngIf","ngIfElse"],["normalText",""],[4,"ngIf"],["style","padding-right: 4px !important",3,"ngStyle",4,"ngFor","ngForOf"],[2,"padding-right","4px !important",3,"ngStyle"],[1,"no-results-data"]],template:function(e,t){if(1&e){var n=d.Wb();d.Qb(0,"div",0),d.Vb(1,"p-panel",1),d.Vb(2,"p-header"),d.Vb(3,"div",2),d.Vb(4,"p-toggleButton",3),d.dc("ngModelChange",(function(e){return t.isTCSelected=e}))("ngModelChange",(function(){return t.getAllRevenueSchedules()})),d.Ub(),d.Vb(5,"a",4),d.dc("click",(function(e){return t.onConfiguringColumns(e)})),d.Qb(6,"em",5),d.Mc(7,"Columns"),d.Ub(),d.Vb(8,"a",6),d.dc("click",(function(){return t.getHistory()})),d.Qb(9,"em",7),d.Mc(10,"History"),d.Ub(),d.Vb(11,"a",8),d.dc("click",(function(){d.Dc(n);var e=d.Bc(17);return t.reset(e)})),d.Qb(12,"em",9),d.Ub(),d.Kc(13,X,2,0,"a",10),d.Kc(14,ne,15,5,"div",11),d.Ub(),d.Ub(),d.Vb(15,"div",12),d.Vb(16,"p-table",13,14),d.Kc(18,ce,2,1,"ng-template",15),d.Kc(19,le,2,1,"ng-template",16),d.Kc(20,de,2,2,"ng-template",17),d.Kc(21,ge,1,1,"ng-template",18),d.Kc(22,ve,3,1,"ng-template",19),d.Ub(),d.Ub(),d.Ub(),d.Vb(23,"p-dialog",20),d.dc("visibleChange",(function(e){return t.historyDialog=e}))("onShow",(function(){return t.onHistoryDialogOpen()}))("onHide",(function(){return t.onHistoryDialogClose()})),d.Qb(24,"rmanRevenueSchedulesHistory-data",null,21),d.Ub()}2&e&&(d.Eb(4),d.oc("ngModel",t.isTCSelected),d.Eb(9),d.oc("ngIf",!t.disableExport),d.Eb(1),d.oc("ngIf",!t.showAddColumns),d.Eb(2),d.oc("value",t.revenueSchedulesList)("loading",t.loading)("rows",t.pageSize)("totalRecords",t.totalElements)("columns",t.columns)("lazy",!1)("paginator",!0)("metaKeySelection",!1),d.Eb(7),d.oc("visible",t.historyDialog)("draggable",!0)("modal",!0))},directives:[b.a,p.c,z.a,w.k,w.n,C.o,y.j,p.f,B.a,j,S.a,k.b,k.c,w.a,C.p,C.n,y.i],pipes:[E.a,C.g],encapsulation:2}),me)}],ye=((be=function t(){e(this,t)}).\u0275mod=d.Nb({type:be}),be.\u0275inj=d.Mb({factory:function(e){return new(e||be)},providers:[],imports:[[s.a,l.k.forChild(Ce)],l.k]}),be)}}])}();