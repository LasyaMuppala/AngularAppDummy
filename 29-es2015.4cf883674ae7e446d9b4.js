(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{D5V3:function(t,e,a){"use strict";a.r(e),a.d(e,"ApprovalHistoryModule",(function(){return S}));var r=a("tyNb"),i=a("J7oY");class o{constructor(){this.fieldLabels={},this.fieldLabels.approvalStatus="Approval Status",this.fieldLabels.actionBy="Action By",this.fieldLabels.actionDate="Action Date",this.fieldLabels.comments="Comments"}}var n=a("tk/3"),s=a("fXoL");const l=a("+yMW");new n.f({"Content-Type":"application/json"});let c=(()=>{class t{constructor(t){this.http=t}getServiceUrl(t,e,a){let r=l.apiUrl+"/rmanApprovalHistoryExport?";0==a&&(r=l.apiUrl+"/ayaraRcApprovalHistoryVSearch?");let i="";return null!=e.arrangementId&&""!=e.arrangementId&&(i=i+"arrangementId:"+e.arrangementId+","),null!=e.approvalStatus&&""!=e.approvalStatus&&(i=i+"approvalStatus:"+e.approvalStatus+","),null!=e.actionBy&&""!=e.actionBy&&(i=i+"actionBy:"+e.actionBy+","),null!=e.actionDate&&""!=e.actionDate&&(i=i+"actionDate:"+e.actionDate+","),null!=e.comments&&""!=e.comments&&(i=i+"comments:"+e.comments+","),""==i?r+="search=%25":r=r+"search="+i,null==t.pageNumber||""==t.pageNumber||isNaN(t.pageNumber)||0==t.pageNumber||(r=r+"&page="+t.pageNumber+"&size="+t.pageSize),r}getAllApprovalHistory(t,e){let a=this.getServiceUrl(t,e,0);return this.http.get(a).toPromise().then(t=>t)}}return t.\u0275fac=function(e){return new(e||t)(s.Zb(n.b))},t.\u0275prov=s.Lb({token:t,factory:t.\u0275fac}),t})();var p=a("7CaW"),b=a("rEr+"),d=a("7zfz"),m=a("ofXK");function h(t,e){1&t&&(s.Vb(0,"tr"),s.Vb(1,"th"),s.Vb(2,"a"),s.Mc(3,"Approval Status"),s.Ub(),s.Ub(),s.Vb(4,"th"),s.Vb(5,"a"),s.Mc(6,"Action By"),s.Ub(),s.Ub(),s.Vb(7,"th"),s.Vb(8,"a"),s.Mc(9,"Action Date"),s.Ub(),s.Ub(),s.Vb(10,"th"),s.Vb(11,"a"),s.Mc(12,"Comments"),s.Ub(),s.Ub(),s.Ub())}function g(t,e){if(1&t&&(s.Vb(0,"tr",8),s.Vb(1,"td",9),s.Mc(2),s.Ub(),s.Vb(3,"td",9),s.Mc(4),s.Ub(),s.Vb(5,"td",9),s.hc(6,"date"),s.Mc(7),s.hc(8,"date"),s.Ub(),s.Vb(9,"td",9),s.Mc(10),s.Ub(),s.Ub()),2&t){const t=e.$implicit;s.oc("pSelectableRow",e.$implicit),s.Eb(1),s.pc("title",t.taskStatus),s.Eb(1),s.Nc(t.taskStatus),s.Eb(1),s.pc("title",t.userId),s.Eb(1),s.Nc(t.userId),s.Eb(1),s.pc("title",s.jc(6,9,t.commentDate,"dd/MM/yyyy")),s.Eb(2),s.Nc(s.jc(8,12,t.commentDate,"dd/MM/yyyy")),s.Eb(2),s.pc("title",t.userComment),s.Eb(1),s.Nc(t.userComment)}}function u(t,e){if(1&t&&(s.Vb(0,"div",10),s.Vb(1,"p"),s.Mc(2),s.Ub(),s.Ub()),2&t){const t=s.gc();s.Eb(2),s.Nc(t.noData)}}const y=a("+yMW");let v=(()=>{class t{constructor(t,e,a,i,o){this.ref=t,this.rmanApprovalHistoryService=e,this.router=a,this.route=i,this.notificationService=o,this.noData=y.noData,this.rmanApprovalHistoryList=[],this.paginationOptions={pageNumber:0,pageSize:"10000"},this.parrangementId=a.url.split("/")[3],console.log(this.parrangementId),this.router.events.subscribe(t=>{t instanceof r.c&&(this.arrIdK=t.url.split("/")[3])}),this.cref=t}ngAfterViewChecked(){this.cref.detectChanges()}ngOnInit(){let t=new o;this.columns=t.fieldLabels}reset(t){t.reset(),this.paginationOptions={},this.getAllRmanApprovalHistory()}getAllRmanApprovalHistory(){this.loading=!0,this.rmanApprovalHistoryService.getAllApprovalHistory(this.paginationOptions,{arrangementId:this.parrangementId}).then(t=>{this.integrateHistoryData(t)}).catch(t=>{this.notificationService.showError("Error occured while getting data"),this.loading=!1})}integrateHistoryData(t){this.loading=!1,this.datasource=t.content,this.rmanApprovalHistoryList=t.content,this.totalElements=t.totalElements,this.pageSize=t.size}getRmanApprovalHistory(t){this.paginationOptions={pageNumber:t.first/t.rows,pageSize:this.pageSize,sortField:t.sortField,sortOrder:t.sortOrder},this.loading=!0,this.rmanApprovalHistoryService.getAllApprovalHistory(this.paginationOptions,{arrangementId:this.parrangementId}).then(t=>{this.integrateHistoryData(t)}).catch(t=>{this.notificationService.showError("Error occured while getting data"),this.loading=!1})}}return t.\u0275fac=function(e){return new(e||t)(s.Pb(s.i),s.Pb(c),s.Pb(r.g),s.Pb(r.a),s.Pb(i.a))},t.\u0275cmp=s.Jb({type:t,selectors:[["rmanApprovalHistory-data"]],features:[s.Db([c])],decls:8,vars:6,consts:[[1,"content-section","implementation"],["header","Approvals History"],[1,"x-scroll"],["id","rmanApprovalHistory-dt","selectionMode","single","scrollable","true",1,"ui-datatable","arrangementMgrTbl",3,"loading","value","lazy","paginator","rows","totalRecords","onLazyLoad"],["dt",""],["pTemplate","header","class","arrangementMgrTblHead"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"pSelectableRow"],[3,"title"],[1,"no-results-data"]],template:function(t,e){1&t&&(s.Qb(0,"div",0),s.Vb(1,"p-panel",1),s.Vb(2,"div",2),s.Vb(3,"p-table",3,4),s.dc("onLazyLoad",(function(t){return e.getRmanApprovalHistory(t)})),s.Kc(5,h,13,0,"ng-template",5),s.Kc(6,g,11,15,"ng-template",6),s.Kc(7,u,3,1,"ng-template",7),s.Ub(),s.Ub(),s.Ub()),2&t&&(s.Eb(3),s.oc("loading",e.loading)("value",e.rmanApprovalHistoryList)("lazy",!0)("paginator",!0)("rows",e.pageSize)("totalRecords",e.totalElements))},directives:[p.a,b.j,d.f,b.i],pipes:[m.f],encapsulation:2}),t})();var f=a("PCNd");const A=[{path:"",component:v}];let S=(()=>{class t{}return t.\u0275mod=s.Nb({type:t}),t.\u0275inj=s.Mb({factory:function(e){return new(e||t)},providers:[],imports:[[f.a,r.k.forChild(A)],r.k]}),t})()}}]);