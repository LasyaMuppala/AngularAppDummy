(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{"Tva+":function(t,e,i){"use strict";i.r(e),i.d(e,"DealManagerModule",(function(){return co}));var o=i("ofXK"),l=i("FpCA"),n=i("J7oY"),c=i("JSOo"),s=i("+yMW"),a=i("fXoL"),r=i("tk/3");let d=(()=>{class t{constructor(t){this.http=t}getDealsSummary(t,e={page:0,size:10}){const{revenueGuidance:i,dealStatus:o,globalSearch:l}=t,{page:n,size:c}=e;return this.http.get(i||o?`${s.apiUrl}/fetchDealSummaryDataGlobalSearch?search=${i?`revenueGuidance:${i},`:""}${o?"dealStatus:"+o:""}&globalSearch=${l}&page=${n}&size=${c}`:`${s.apiUrl}/fetchDealSummaryDataGlobalSearch?search=%25&globalSearch=${l}&page=${n}&size=${c}`)}getDealRollUpSummaryData(t,e="D",i=!1,o=0){return this.http.get(i?`${s.apiUrl}/fetchDealRollupSummaryData?dealArrgId=${t}&dealQuoteFlag=${e}&currencyType=USD&page=${o}&size=10`:`${s.apiUrl}/fetchDealRollupSummaryData?dealArrgId=${t}&dealQuoteFlag=${e}&page=${o}&size=10`)}getSummaryDataTotals(t,e="D",i=!1){return this.http.get(i?`${s.apiUrl}/fetchDealRollupSummaryDataTotals?dealArrgId=${t}&dealQuoteFlag=${e}&currencyType=USD`:`${s.apiUrl}/fetchDealRollupSummaryDataTotals?dealArrgId=${t}&dealQuoteFlag=${e}`)}getSummaryExportUrl(t,e){const{revenueGuidance:i,dealStatus:o,globalSearch:l}=t;return s.apiUrl+`/dealSummaryDataExport?search=${i?`revenueGuidance:${i},`:""}${o?"dealStatus:"+o:""}&globalSearch=${l}&exportCols=${e.join(",")}`}getRollUpExportUrl(t,e,i=!1,o){return i?s.apiUrl+`/dealRollupViewExport?dealArrgId=${t}&dealQuoteFlag=${e}&currencyType=USD&exportCols=${o.join(",")}`:s.apiUrl+`/dealRollupViewExport?dealArrgId=${t}&dealQuoteFlag=${e}&exportCols=${o.join(",")}`}getDealComments(t,e=0){return this.http.get(`${s.apiUrl}/fetchDealUserComments?search=dealArrangementId:${t}&page=${e}&size=5`)}addDealComment(t){return this.http.post(s.apiUrl+"/AYARA_DEAL_USER_COMMENTS",t)}}return t.\u0275fac=function(e){return new(e||t)(a.Zb(r.b))},t.\u0275prov=a.Lb({token:t,factory:t.\u0275fac}),t})();var h=i("vkgz");const g=[{field:"dealQuoteNum",header:"Deal Number",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"text",footer:"totals"},{field:"productCatgeory",header:"Product Category",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"text",footer:"empty"},{field:"extendedListAmount",header:"Ext List Amount",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalExtendedListAmt"},{field:"lineAmount",header:"Bookings Value",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalLineAmt"},{field:"discount",header:"Discount",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"percent",footer:"totalDiscount"},{field:"revenueAmount",header:"Revenue Amount",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalAllocationAmt"},{field:"carveInOut",header:"Carve In/ Out",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalCarveInOut"},{field:"grossMarginPercentage",header:"Gross Margin%",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"percent",footer:"totalGrossMarginPercent"},{field:"allocationMarginPercentage",header:"Allocated Margin%",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"percent",footer:"totalAllocatedMarginPercent"},{field:"revenueAdjustment",header:"Adjusted Revenue",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalRevenueAdjustment"},{field:"lineCost",header:"Standard Cost",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"parentheses",footer:"totalStandardCost"},{field:"adjLineCost",header:"Adjusted Cost",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"parentheses",footer:"totalAdjustedCost"},{field:"grossMargin",header:"Gross Margin",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalGrossMargin"},{field:"allocatedMarginAmount",header:"Allocated Margin",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalAllocatedMarginAmount"}],b=[{field:"dealNumber",header:"Deal Number",showField:!0,drag:!0,display:"table-cell",type:"link"},{field:"customerName",header:"Account",showField:!0,drag:!0,display:"table-cell",type:"text"},{field:"trxCurrency",header:"Currency",showField:!0,drag:!0,display:"table-cell",type:"text"},{field:"amount",header:"Amount",showField:!0,drag:!0,display:"table-cell",type:"round"},{field:"legalEntityName",header:"Legal Entity",showField:!0,drag:!0,display:"table-cell",type:"text"},{field:"dealDate",header:"Deal Date",showField:!0,drag:!0,display:"table-cell",type:"date"},{field:"revenueGuidance",header:"Guidance",showField:!0,drag:!0,display:"table-cell",type:"symbol"},{field:"dealStatus",header:"Status",drag:!0,showField:!0,display:"table-cell",type:"text"}],u=[{field:"pobGrouping",header:"POB ID",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"arrgLineNumber",header:"Revenue Contract Line#",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"customerPoNum",header:"PO",showField:!0,drag:!0,display:"table-cell",type:"number",footer:"empty"},{field:"orderNumber",header:"SO#",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"sourceLineNumber",header:"SO Line#",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"dealNumber",header:"Contract/Deal#",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"dealLineNumber",header:"Line#",showField:!0,drag:!0,alignment:"left",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"productName",header:"Product Name",drag:!0,showField:!0,alignment:"left",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"productDescription",header:"Product Description",drag:!0,showField:!0,alignment:"left",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"uomCode",header:"UOM",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"quantity",header:"Quantity",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"dealCurrencyCode",header:"Currency",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"unitListPrice",header:"Unit List Price",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"unitSellingPrice",header:"Unit Selling Price",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"netPriceDiscount",header:"Net Price Discount%",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"percent",footer:"totals",isFrozen:!1},{field:"extendedListAmount",header:"Extended List Amount",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalListAmount",isFrozen:!1},{field:"lineAmount",header:"Bookings Value",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"lineAmountTotal",isFrozen:!1},{field:"vc",header:"Variable Consideration",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"vcTotal",isFrozen:!1},{field:"allocableAmount",header:"Allocable Net Price",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"allocableNetTotal",isFrozen:!1},{field:"elementType",header:"Element Type",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"bundleFlag",header:"Bundle Flag",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"parentLineId",header:"Parent Product",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"productGroup",header:"Product Family",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"productType",header:"Product Line",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"fmvRuleName",header:"SSP Rule Name",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"fmvCategory",header:"SSP Category",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"fmvType",header:"SSP Type",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"fmvMin",header:"SSP Min",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"fmvMean",header:"SSP Trx",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"fmvMax",header:"SSP Max",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"bundleAttributionList",header:"Bundle Attribution List",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"bround",footer:"empty",isFrozen:!1},{field:"bundleAttributionNet",header:"Bundle Attribution Net",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"bround",footer:"empty",isFrozen:!1},{field:"sspLow",header:"SSP Low",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"sspHigh",header:"SSP High",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"ssp",header:"SSP",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"fmvAmount",header:"Extended SSP",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"fvTotal",isFrozen:!1},{field:"allocationAmount",header:"Allocation Amount",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"allocationTotal",isFrozen:!1},{field:"cvInOutAmount",header:"Carve In/Carve Out ",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"cvInOutAmountTotal",isFrozen:!1},{field:"allocationFlag",header:"Allocation Flag",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"allocationInclusive",header:"Allocation Inclusive",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"text",footer:"empty",isFrozen:!1},{field:"totalCost",header:"Total Cost",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"parentheses",footer:"empty",isFrozen:!1},{field:"fxRate",header:"Fx Rate",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"fxCurrency",header:"Fx Currency",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"number",footer:"empty",isFrozen:!1},{field:"fxDate",header:"Fx Date",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"date",footer:"empty",isFrozen:!1},{field:"allocationAmountFc",header:"Allocation Amount(FC)",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"allocationFcTotal",isFrozen:!1},{field:"allocationMarginPercentage",header:"Line to Revenue%",showField:!0,drag:!0,alignment:"right",display:"table-cell",type:"percent",footer:"empty",isFrozen:!1},{field:"grossMarginPercentage",header:"Allocated Margin%",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"percent",footer:"empty",isFrozen:!1},{field:"allocationGuidance",header:"Revenue Guidance",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"symbol",footer:"allocStatusTotal",isFrozen:!1},{field:"allocationMarginGuidance",header:"Margin Guidance",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"symbol",footer:"allocMarginStatusTotal",isFrozen:!1},{field:"discountGuidance",header:"Discount Guidance",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"symbol",footer:"discountStatusTotal",isFrozen:!1},{field:"revenueGuidance",header:"Deal Guidance",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"symbol",footer:"statusTotal",isFrozen:!1},{field:"comments",header:"Guidance Comments",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"text",footer:"commentsTotal",isFrozen:!1},{field:"adjDealLineCost",header:"Adjusted Cost",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"parentheses",footer:"empty",isFrozen:!1},{field:"adjRevenue",header:"Adjusted Revenue",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"empty",isFrozen:!1},{field:"grossMargin",header:"Gross Margin",drag:!0,showField:!0,alignment:"right",display:"table-cell",type:"round",footer:"totalGrossMargin",isFrozen:!1}];var f=i("tyNb"),p=i("3Pt+"),m=i("7kUa"),C=i("jGlT"),y=i("/RsI"),S=i("LuMj"),v=i("NCSE"),w=i("azuL"),E=i("+07z"),V=i("7zfz"),F=i("TjhJ"),A=i("rEr+"),D=i("pqzn");const U=["dt"];function M(t,e){if(1&t){const t=a.Wb();a.Vb(0,"a",33),a.dc("click",(function(){return a.Dc(t),a.gc().onResetGlobalSearch()})),a.Qb(1,"em",34),a.Ub()}}function I(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"em",35),a.Mc(2,"Enable Filters"),a.Ub())}function z(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"em",36),a.Mc(2,"Clear Filters"),a.Ub())}function T(t,e){if(1&t){const t=a.Wb();a.Vb(0,"a",37),a.dc("click",(function(){return a.Dc(t),a.gc().importFile()})),a.Qb(1,"em",38),a.Ub()}}function x(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div"),a.Vb(1,"div",50),a.dc("onDragStart",(function(){a.Dc(t);const e=a.gc().index;return a.gc(2).onDragStart(e)}))("onDrop",(function(){a.Dc(t);const e=a.gc().index;return a.gc(2).onDrop(e)})),a.Vb(2,"div",51),a.Vb(3,"input",52),a.dc("ngModelChange",(function(e){return a.Dc(t),a.gc().$implicit.showField=e}))("change",(function(){a.Dc(t);const e=a.gc().$implicit;return a.gc(2).selectColumns(e)})),a.Ub(),a.Vb(4,"label"),a.Mc(5),a.Ub(),a.Ub(),a.Ub(),a.Ub()}if(2&t){const t=a.gc().$implicit;a.Eb(3),a.oc("checked",t.showField)("ngModel",t.showField),a.Eb(2),a.Nc(t.header)}}const O=function(){return{color:"grey"}};function P(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div"),a.Vb(1,"div",53),a.Vb(2,"div"),a.Vb(3,"input",54),a.dc("ngModelChange",(function(e){return a.Dc(t),a.gc().$implicit.showField=e}))("change",(function(){a.Dc(t);const e=a.gc().$implicit;return a.gc(2).selectColumns(e)})),a.Ub(),a.Vb(4,"label",55),a.Mc(5),a.Ub(),a.Ub(),a.Ub(),a.Ub()}if(2&t){const t=a.gc().$implicit;a.Eb(3),a.oc("checked",t.showField)("ngModel",t.showField)("disabled",!t.drag),a.Eb(1),a.oc("ngStyle",a.rc(5,O)),a.Eb(1),a.Nc(t.header)}}function k(t,e){if(1&t&&(a.Kc(0,x,6,3,"div",12),a.Kc(1,P,6,6,"div",12)),2&t){const t=e.$implicit;a.oc("ngIf",t.drag),a.Eb(1),a.oc("ngIf",!t.drag)}}const K=function(){return{width:"100%",height:"100%"}};function L(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div",39),a.Vb(1,"div",40),a.Vb(2,"div",41),a.Vb(3,"input",42),a.dc("click",(function(){return a.Dc(t),a.gc().onSelectAll()})),a.Ub(),a.Vb(4,"label",43),a.Mc(5,"Select All"),a.Ub(),a.Vb(6,"a",44),a.dc("click",(function(){return a.Dc(t),a.gc().closeAddColumns()})),a.Mc(7,"\xd7"),a.Ub(),a.Vb(8,"p-listbox",45),a.Kc(9,k,2,2,"ng-template",46),a.Ub(),a.Ub(),a.Vb(10,"div",47),a.Vb(11,"a",48),a.dc("click",(function(){return a.Dc(t),a.gc().saveColumns()})),a.Mc(12,"Save"),a.Ub(),a.Vb(13,"a",49),a.dc("click",(function(){return a.Dc(t),a.gc().closeAddColumns()})),a.Mc(14,"Cancel"),a.Ub(),a.Ub(),a.Ub(),a.Ub()}if(2&t){const t=a.gc();a.Eb(3),a.oc("checked",t.isSelectAllChecked),a.Eb(5),a.Ic(a.rc(4,K)),a.oc("options",t.globalCols)}}function $(t,e){1&t&&a.Qb(0,"col")}function N(t,e){if(1&t&&(a.Vb(0,"colgroup"),a.Kc(1,$,1,0,"col",63),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}const R=function(t){return{display:t}},Q=function(t,e){return{number:t,"text-align-right":e}};function _(t,e){if(1&t&&(a.Vb(0,"th",66),a.Vb(1,"div",67),a.Mc(2),a.Ub(),a.Ub()),2&t){const t=e.$implicit,i=e.index;a.oc("ngStyle",a.sc(5,R,t.display)),a.Eb(1),a.Gb(a.tc(7,Q,"number"===t.type,i>2)),a.pc("title",t.header),a.Eb(1),a.Oc("",t.header," ")}}const G=function(t,e){return{hidden:t,"text-align-right":e}};function j(t,e){if(1&t){const t=a.Wb();a.Tb(0),a.Tb(1),a.Vb(2,"th",69),a.Vb(3,"input",70),a.dc("ngModelChange",(function(i){a.Dc(t);const o=e.$implicit;return a.gc(4).searchData[o.field]=i})),a.Ub(),a.Vb(4,"button",71),a.dc("click",(function(){return a.Dc(t),a.gc(4).onFilter()})),a.Ub(),a.Ub(),a.Sb(),a.Sb()}if(2&t){const t=e.$implicit,i=e.index,o=a.gc(4);a.Eb(2),a.Gb(a.tc(6,G,"dealStatus"!==t.field&&"revenueGuidance"!==t.field,i>2)),a.pc("title",t.header),a.oc("ngStyle",a.sc(9,R,t.display)),a.Eb(1),a.pc("name",t.field),a.oc("ngModel",o.searchData[t.field])}}function W(t,e){if(1&t&&(a.Vb(0,"tr",68),a.Kc(1,j,5,11,"ng-container",63),a.Ub()),2&t){const t=a.gc(3);a.Eb(1),a.oc("ngForOf",t.columns)}}function B(t,e){if(1&t&&(a.Vb(0,"tr"),a.Kc(1,_,3,10,"th",64),a.Ub(),a.Kc(2,W,2,1,"tr",65)),2&t){const t=a.gc(2);a.Eb(1),a.oc("ngForOf",t.columns),a.Eb(1),a.oc("ngIf",t.isFilterEnabled)}}const q=function(t){return{"text-align-right":t}};function H(t,e){if(1&t&&(a.Vb(0,"td",76),a.Mc(1),a.Ub()),2&t){const t=a.gc(),e=t.index,i=t.$implicit,o=a.gc().$implicit;a.Gb(a.sc(5,q,e>2)),a.pc("title",o[i.field]),a.oc("ngStyle",a.sc(7,R,i.display)),a.Eb(1),a.Oc(" ",o[i.field]," ")}}function Y(t,e){if(1&t){const t=a.Wb();a.Vb(0,"td",76),a.Vb(1,"span"),a.Vb(2,"a",77),a.dc("click",(function(){a.Dc(t);const e=a.gc(2).$implicit;return a.gc(2).navigateToDetails(e.dealArrangementId,e.dealNumber)})),a.Mc(3),a.Ub(),a.Ub(),a.Ub()}if(2&t){const t=a.gc(),e=t.index,i=t.$implicit,o=a.gc().$implicit;a.Gb(a.sc(6,q,e>2)),a.pc("title",o[i.field]),a.oc("ngStyle",a.sc(8,R,i.display)),a.Eb(2),a.pc("title",o[i.field]),a.Eb(1),a.Nc(o[i.field])}}function J(t,e){if(1&t&&(a.Vb(0,"td",78),a.Mc(1),a.Ub()),2&t){const t=a.gc(),e=t.index,i=t.$implicit,o=a.gc().$implicit;a.Gb(a.sc(5,q,e>2)),a.pc("title",o[i.field]),a.oc("ngStyle",a.sc(7,R,i.display)),a.Eb(1),a.Oc(" ",o[i.field]," ")}}function X(t,e){if(1&t&&(a.Vb(0,"td",76),a.hc(1,"date"),a.Mc(2),a.hc(3,"date"),a.Ub()),2&t){const t=a.gc(),e=t.index,i=t.$implicit,o=a.gc().$implicit;a.Gb(a.sc(11,q,e>2)),a.pc("title",a.jc(1,5,o[i.field],"yyyy-MM-dd")),a.oc("ngStyle",a.sc(13,R,i.display)),a.Eb(2),a.Oc(" ",a.jc(3,8,o[i.field],"yyyy-MM-dd")," ")}}function Z(t,e){if(1&t&&(a.Vb(0,"td",76),a.hc(1,"round"),a.Mc(2),a.hc(3,"round"),a.Ub()),2&t){const t=a.gc(),e=t.index,i=t.$implicit,o=a.gc().$implicit;a.Gb(a.sc(9,q,e>2)),a.pc("title",a.ic(1,5,o[i.field])),a.oc("ngStyle",a.sc(11,R,i.display)),a.Eb(2),a.Oc(" ",a.ic(3,7,o[i.field])," ")}}const tt=function(){return{"margin-right":"25px"}};function et(t,e){1&t&&(a.Vb(0,"span",55),a.Qb(1,"i",81),a.Ub()),2&t&&a.oc("ngStyle",a.rc(1,tt))}function it(t,e){1&t&&(a.Vb(0,"span",55),a.Qb(1,"i",82),a.Ub()),2&t&&a.oc("ngStyle",a.rc(1,tt))}function ot(t,e){1&t&&(a.Vb(0,"span",55),a.Qb(1,"i",83),a.Ub()),2&t&&a.oc("ngStyle",a.rc(1,tt))}function lt(t,e){if(1&t&&(a.Vb(0,"td",79),a.Kc(1,et,2,2,"span",80),a.Kc(2,it,2,2,"span",80),a.Kc(3,ot,2,2,"span",80),a.Ub()),2&t){const t=a.gc().$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.sc(5,R,t.display)),a.Eb(1),a.oc("ngIf","RED"==e[t.field]),a.Eb(1),a.oc("ngIf","GREEN"==e[t.field]),a.Eb(1),a.oc("ngIf","YELLOW"==e[t.field])}}function nt(t,e){if(1&t&&(a.Tb(0),a.Kc(1,H,2,9,"td",73),a.Kc(2,Y,4,10,"td",73),a.Kc(3,J,2,9,"td",74),a.Kc(4,X,4,15,"td",73),a.Kc(5,Z,4,13,"td",73),a.Kc(6,lt,4,7,"td",75),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf","text"==t.type),a.Eb(1),a.oc("ngIf","link"==t.type),a.Eb(1),a.oc("ngIf","number"==t.type),a.Eb(1),a.oc("ngIf","date"==t.type),a.Eb(1),a.oc("ngIf","round"==t.type),a.Eb(1),a.oc("ngIf","symbol"==t.type)}}function ct(t,e){if(1&t&&(a.Vb(0,"tr",72),a.Kc(1,nt,7,6,"ng-container",63),a.Ub()),2&t){const t=e.$implicit,i=a.gc(2);a.oc("pSelectableRow",t),a.Eb(1),a.oc("ngForOf",i.columns)}}function st(t,e){1&t&&(a.Vb(0,"div",84),a.Vb(1,"p"),a.Mc(2,"No records found"),a.Ub(),a.Ub())}function at(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div",56),a.Vb(1,"p-table",57,58),a.dc("onLazyLoad",(function(e){return a.Dc(t),a.gc().getDealsSummaryData(e)})),a.Kc(3,N,2,1,"ng-template",59),a.Kc(4,B,3,2,"ng-template",60),a.Kc(5,ct,2,2,"ng-template",61),a.Kc(6,st,3,0,"ng-template",62),a.Ub(),a.Ub()}if(2&t){const t=a.gc();a.Eb(1),a.oc("value",t.deals)("loading",t.loading)("paginator",t.showPaginator)("rows",10)("totalRecords",t.totalElements)("columns",t.columns)("resizableColumns",!0)}}function rt(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div",87),a.dc("click",(function(){a.Dc(t);const i=e.$implicit;return a.gc(2).navigateToDetails(i.dealArrangementId,i.dealNumber)})),a.Vb(1,"div",88),a.Mc(2),a.Ub(),a.Vb(3,"div",88),a.Mc(4),a.Ub(),a.Vb(5,"div",88),a.Mc(6),a.hc(7,"currency"),a.Ub(),a.Vb(8,"div",88),a.Mc(9),a.Ub(),a.Ub()}if(2&t){const t=e.$implicit;a.Eb(2),a.Oc("Deal - ",t.dealNumber,""),a.Eb(2),a.Pc("",t.revenueGuidance," | ",t.dealStatus,""),a.Eb(2),a.Pc("",a.jc(7,7,t.amount,"USD")," | ",t.dealDate,""),a.Eb(3),a.Pc("",t.rcNumber," | ",t.customerName,"")}}function dt(t,e){if(1&t&&(a.Vb(0,"div",85),a.Kc(1,rt,10,10,"div",86),a.Ub()),2&t){const t=a.gc();a.Eb(1),a.oc("ngForOf",t.deals)}}function ht(t,e){1&t&&(a.Vb(0,"div",89),a.Qb(1,"div"),a.Qb(2,"div"),a.Qb(3,"div"),a.Qb(4,"div"),a.Qb(5,"div"),a.Qb(6,"div"),a.Qb(7,"div"),a.Qb(8,"div"),a.Ub())}const gt=function(){return["upload","FILEUPLOAD"]};let bt=(()=>{class t{constructor(t,e,i,o,l){this.router=t,this.uploadService=e,this.notificationService=i,this.commonSharedService=o,this.dealsService=l,this.columns=[],this.globalCols=[],this.clonedCols=[],this.paginationOptions={page:0,size:10},this.searchTerm="",this.pageSize=10,this.isSearched=!1,this.showAddColumns=!1,this.loading=!1,this.isGridView=!0,this.showPaginator=!0,this.displayAdvancedSearch=!1,this.isFilterEnabled=!1,this.displaySelectMode=!1,this.uploadLoading=!1,this.isSelectAllChecked=!0,this.guidance=this.commonSharedService.guidance}ngOnInit(){this.resetSearchData(),this.guidance?(this.commonSharedService.guidance=null,this.getDealsSummaryData(null,this.guidance)):this.getDealsSummaryData(),this.globalCols=b,this.columns=[],this.getTableColumns("Deal Manager","Deals Summary"),this.columns.length!==this.globalCols.length&&(this.isSelectAllChecked=!1)}getTableColumns(t,e){this.isSelectAllChecked=!0,this.commonSharedService.getConfiguredColDetails(t,e).then(t=>{if(t&&null!=t&&t.userId){this.columns=[];const e=t.tableColumns.split(",");e.length>0&&e.forEach((t,e)=>{t&&(this.startIndex=this.globalCols.findIndex(e=>e.field==t),this.onDrop(e))}),this.globalCols.forEach(e=>{-1!==t.tableColumns.indexOf(e.field)?this.columns.push(e):e.showField=!1}),this.columns.length!==this.globalCols.length&&(this.isSelectAllChecked=!1),this.showPaginator=0!==this.columns.length,this.userId=t.userId}else this.columns=this.globalCols}).catch(()=>{this.notificationService.showError("Error occured while getting table columns data"),this.loading=!1})}getDealsSummaryData(t,e){e&&(this.searchData={dealStatus:"",globalSearch:"",revenueGuidance:e}),t&&(this.paginationOptions={page:t.first/t.rows,size:10}),this.loading=!0,this.subscription=this.dealsService.getDealsSummary(this.searchData,this.paginationOptions).pipe(Object(h.a)(()=>this.loading=!1)).subscribe(t=>{this.loading=!1,this.totalElements=t.totalElements,this.deals=t.content},()=>{this.notificationService.showError("Error occured while getting table columns data"),this.loading=!1})}onToggleView(){this.isGridView=!this.isGridView}resetSearchData(){this.searchTerm="",this.searchData={revenueGuidance:"",dealStatus:"",globalSearch:""}}onFilter(){this.getDealsSummaryData()}onEnablingFilters(){this.isFilterEnabled&&(this.resetSearchData(),this.getDealsSummaryData()),this.isFilterEnabled=!this.isFilterEnabled}reset(){this.resetSearchData(),this.isSearched=!1,this.isFilterEnabled=!1,this.paginationOptions={page:0,size:10},this.getDealsSummaryData(),this.table.reset()}onAddingColumns(){this.clonedCols=[...this.globalCols],this.showAddColumns=!0}selectColumns(t){const e=this.globalCols.filter(t=>!t.showField);this.isSelectAllChecked=e.length<=0}onSelectAll(){this.isSelectAllChecked=!this.isSelectAllChecked,this.globalCols.forEach(t=>{this.isSelectAllChecked?t.showField=!0:t.drag&&(t.showField=!1)})}closeAddColumns(){this.showAddColumns=!1,this.globalCols=this.clonedCols;const t=this.columns.filter(t=>!t.showField);this.isSelectAllChecked=!(t.length>0)}onDragStart(t){this.startIndex=t}onDrop(t){const e=this.globalCols[this.startIndex];this.globalCols.splice(this.startIndex,1),this.globalCols.splice(t,0,e)}saveColumns(){let t="";this.showAddColumns=!this.showAddColumns;const e=this.globalCols.length-1;this.globalCols.forEach((i,o)=>{i.showField&&(t+=i.field,o<e&&(t+=","))}),this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("Deal Manager","Deals Summary",t,this.userId).then(t=>{this.columns=this.globalCols.filter(t=>t.showField),this.userId=t.userId,this.showPaginator=0!==this.columns.length,this.loading=!1}).catch(()=>{this.notificationService.showError("Error occured while getting data"),this.loading=!1})}importFile(){this.displaySelectMode=!0}onQuotes(t){this.displaySelectMode=!1,this.uploadService.displayQuotesDialog=!0}cancel(){this.displaySelectMode=!0}exportExcel(){const t=[];for(let e=0;e<this.columns.length;e++)this.columns[e].showField&&t.push(this.columns[e].field);window.location.href=this.dealsService.getSummaryExportUrl(this.searchData,t)}fileUploadHandler(t,e,i){let o,l;const n=[];for(const{name:c}of t.files)n.push(c);n.length>0&&(console.log(n[0]),o=n[0].toString().toLowerCase().replace(/[^a-z\s]+/gi,"")),l="quote"===i&&o.startsWith(i),l?this.uploadService.processUpload(t,e):this.notificationService.showError("Upload Failed, File Name should start with "+i.toString().toUpperCase()+" Key")}commonSearch(){this.isSearched=!0,this.searchData.globalSearch=this.searchTerm,this.table.reset(),this.getDealsSummaryData()}onResetGlobalSearch(){this.searchTerm="",this.searchData=Object.assign(Object.assign({},this.searchData),{globalSearch:""}),this.getDealsSummaryData(),this.isSearched=!1}navigateToDetails(t,e){this.router.navigate(["/","deal-manager","details",t,e,"summary"])}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(f.g),a.Pb(l.a),a.Pb(n.a),a.Pb(c.a),a.Pb(d))},t.\u0275cmp=a.Jb({type:t,selectors:[["app-deal-manager"]],viewQuery:function(t,e){var i;1&t&&a.Qc(U,!0),2&t&&a.Ac(i=a.ec())&&(e.table=i.first)},decls:42,vars:17,consts:[[1,"card-wrapper"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card-block"],[1,"search__container"],["pInputText","","name","searchKey","id","searchKey","placeholder","Search here...",1,"",3,"ngModel","ngModelChange"],[1,"globalSearchBtn",3,"click"],["aria-hidden","true",1,"fa","fa-search"],["class","globalSearchBtnx",3,"click",4,"ngIf"],[1,"pull-right","icons-list"],[1,"clear-filters",3,"click"],[4,"ngIf"],[1,"add-column",3,"click"],[1,"fa","fa-cog"],["title","Import",3,"click",4,"isAuthorized"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],["title","Export",3,"click"],[1,"fa","fa-external-link"],["title","toggleView",3,"click"],[1,"fa","fa-bars"],["id","add-column-popup",4,"ngIf"],["class","x-scroll",4,"ngIf","ngIfElse"],["tileView",""],["class","lds-roller","style","top: 0px;",4,"ngIf"],["header","Select Upload File Type","width","450","showEffect","fade",3,"visible","draggable","modal","visibleChange"],[1,"ui-md-12"],[1,"ml-0"],[1,"ui-md-4"],["name","group1","value","QUOTES","label","Quotes","inputId","opt4",3,"onClick"],["header","Upload Quotes","width","500","showEffect","fade",3,"visible","draggable","modal","visibleChange","onAfterHide"],["id","upload-quotes-input","name","file","customUpload","true","accept",".csv","invalidFileTypeMessageSummary","{0}:Invalid file Type",3,"uploadHandler"],[1,"globalSearchBtnx",3,"click"],["aria-hidden","true",1,"fa","fa-times"],[1,"fa","fa-check-square-o"],[1,"fa","fa-times"],["title","Import",3,"click"],[1,"fa","fa-upload"],["id","add-column-popup"],[1,"user-popup"],[1,"content","overflow"],["type","checkbox","id","selectall","name","selectall",3,"checked","click"],["for","selectall"],["title","Close",1,"close",3,"click"],[3,"options"],["pTemplate","item"],[1,"pull-right","pt-2"],[1,"configColBtn",3,"click"],[1,"configColBtn","conf-cancel",3,"click"],["pDraggable","gens","pDroppable","gens",1,"ui-helper-clearfix",3,"onDragStart","onDrop"],[1,"drag"],["type","checkbox",3,"checked","ngModel","ngModelChange","change"],[1,"ui-helper-clearfix"],["type","checkbox",3,"checked","ngModel","disabled","ngModelChange","change"],[3,"ngStyle"],[1,"x-scroll"],["id","revenueResults-dt","lazy","true","columnResizeMode","expand","exportFilename","Deals_Summary.csv",1,"ui-datatable","arrangementMgrTbl","revenueContractTbl","wide-columns",3,"value","loading","paginator","rows","totalRecords","columns","resizableColumns","onLazyLoad"],["dt",""],["pTemplate","colgroup"],["pTemplate","header","class","arrangementMgrTblHead"],["pTemplate","body"],["pTemplate","emptymessage"],[4,"ngFor","ngForOf"],["pResizableColumn","",3,"ngStyle",4,"ngFor","ngForOf"],["class","filter-row",4,"ngIf"],["pResizableColumn","",3,"ngStyle"],[3,"title"],[1,"filter-row"],["pResizableColumn","",3,"ngStyle","title"],["pInputText","","type","text",1,"table-textbox",3,"name","ngModel","ngModelChange"],["type","submit",1,"pi","pi-search",3,"click"],[3,"pSelectableRow"],[3,"title","class","ngStyle",4,"ngIf"],["class","number",3,"title","class","ngStyle",4,"ngIf"],["class","text-align-right",3,"title","ngStyle",4,"ngIf"],[3,"title","ngStyle"],[3,"title","click"],[1,"number",3,"title","ngStyle"],[1,"text-align-right",3,"title","ngStyle"],[3,"ngStyle",4,"ngIf"],["aria-hidden","true",1,"fa","fa-circle","red-color"],["aria-hidden","true",1,"fa","fa-circle","green-color"],["aria-hidden","true",1,"fa","fa-circle","yellow-color"],[1,"no-results-data"],[1,"tile-container"],["class","card-wrapper tile-item",3,"click",4,"ngFor","ngForOf"],[1,"card-wrapper","tile-item",3,"click"],[1,"item-row"],[1,"lds-roller",2,"top","0px"]],template:function(t,e){if(1&t&&(a.Vb(0,"div",0),a.Vb(1,"div",1),a.Vb(2,"div",2),a.Vb(3,"div",3),a.Vb(4,"div",4),a.Vb(5,"h2"),a.Mc(6,"Deal Manager"),a.Ub(),a.Vb(7,"div",5),a.Vb(8,"form"),a.Vb(9,"input",6),a.dc("ngModelChange",(function(t){return e.searchTerm=t})),a.Ub(),a.Vb(10,"a",7),a.dc("click",(function(){return e.commonSearch()})),a.Qb(11,"em",8),a.Ub(),a.Kc(12,M,2,0,"a",9),a.Ub(),a.Ub(),a.Vb(13,"div",10),a.Vb(14,"a",11),a.dc("click",(function(){return e.onEnablingFilters()})),a.Kc(15,I,3,0,"span",12),a.Kc(16,z,3,0,"span",12),a.Ub(),a.Vb(17,"a",13),a.dc("click",(function(){return e.onAddingColumns()})),a.Qb(18,"em",14),a.Mc(19,"Columns"),a.Ub(),a.Kc(20,T,2,0,"a",15),a.Vb(21,"a",16),a.dc("click",(function(){return e.reset()})),a.Qb(22,"em",17),a.Ub(),a.Vb(23,"a",18),a.dc("click",(function(){return e.exportExcel()})),a.Qb(24,"em",19),a.Ub(),a.Vb(25,"a",20),a.dc("click",(function(){return e.onToggleView()})),a.Qb(26,"em",21),a.Vb(27,"span"),a.Mc(28),a.Ub(),a.Ub(),a.Kc(29,L,15,5,"div",22),a.Ub(),a.Kc(30,at,7,7,"div",23),a.Kc(31,dt,2,1,"ng-template",null,24,a.Lc),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Kc(33,ht,9,0,"div",25),a.Vb(34,"p-dialog",26),a.dc("visibleChange",(function(t){return e.displaySelectMode=t})),a.Vb(35,"div",27),a.Vb(36,"div",28),a.Vb(37,"div",29),a.Vb(38,"p-radioButton",30),a.dc("onClick",(function(t){return e.onQuotes(t)})),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Ub(),a.Vb(39,"p-dialog",31),a.dc("visibleChange",(function(t){return e.uploadService.displayQuotesDialog=t}))("onAfterHide",(function(){return e.cancel()})),a.Vb(40,"p-fileUpload",32),a.dc("uploadHandler",(function(t){return e.fileUploadHandler(t,"/upload/documents/QUOTE","quote")})),a.Ub(),a.Qb(41,"progress-bar"),a.Ub()),2&t){const t=a.Bc(32);a.Eb(9),a.oc("ngModel",e.searchTerm),a.Eb(3),a.oc("ngIf",e.isSearched),a.Eb(3),a.oc("ngIf",!e.isFilterEnabled),a.Eb(1),a.oc("ngIf",e.isFilterEnabled),a.Eb(4),a.oc("isAuthorized",a.rc(16,gt)),a.Eb(8),a.Nc(e.isGridView?"Tile View":"Grid View"),a.Eb(1),a.oc("ngIf",e.showAddColumns),a.Eb(1),a.oc("ngIf",e.isGridView)("ngIfElse",t),a.Eb(3),a.oc("ngIf",e.uploadLoading),a.Eb(1),a.oc("visible",e.displaySelectMode)("draggable",!0)("modal",!0),a.Eb(5),a.oc("visible",e.uploadService.displayQuotesDialog)("draggable",!0)("modal",!0)}},directives:[p.v,p.l,p.m,p.b,m.a,p.k,p.n,o.o,C.a,y.a,S.a,v.a,w.a,E.a,V.f,F.b,F.c,p.a,o.p,A.j,o.n,A.g,A.i],pipes:[o.f,D.a,o.d],styles:[".tile-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.tile-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;box-shadow:0 5px 15px rgba(0,0,0,.15);font-size:16px;padding:15px;margin:15px;width:270px;cursor:pointer}.tile-item[_ngcontent-%COMP%]:hover{opacity:.7}.filter-row[_ngcontent-%COMP%]   .hidden[_ngcontent-%COMP%]{visibility:hidden}"]}),t})();var ut=i("PCNd");let ft=(()=>{class t{constructor(t,e,i){this.route=t,this.changeDetector=e,this.notification=i}ngOnInit(){this.dealNumber=this.route.snapshot.paramMap.get("dealNumber")}ngAfterContentChecked(){this.changeDetector.detectChanges()}onCopyNumber(){navigator.clipboard.writeText(this.dealNumber).finally(()=>{this.notification.showInfo("Deal number is copied",2e3)})}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(f.a),a.Pb(a.i),a.Pb(n.a))},t.\u0275cmp=a.Jb({type:t,selectors:[["app-deal-details"]],decls:15,vars:1,consts:[[1,"d-flex","align-items-center"],["routerLink","/deal-manager",1,"title"],[1,"copy-icon","pi","pi-copy",3,"click"],[1,"card-wrapper"],[1,"card-block"],[1,"top-menu"],[1,"tabs-container"],["routerLink","summary","routerLinkActive","active",1,"tab-item"],["routerLink","allocations","routerLinkActive","active",1,"tab-item"],["routerLink","forecasting","routerLinkActive","active",1,"tab-item"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"div",1),a.Mc(2),a.Ub(),a.Vb(3,"i",2),a.dc("click",(function(){return e.onCopyNumber()})),a.Ub(),a.Ub(),a.Vb(4,"div",3),a.Vb(5,"div",4),a.Vb(6,"div",5),a.Vb(7,"div",6),a.Vb(8,"div",7),a.Mc(9,"Deal Details"),a.Ub(),a.Vb(10,"div",8),a.Mc(11,"Deal Allocations"),a.Ub(),a.Vb(12,"div",9),a.Mc(13,"Deal Forecasting"),a.Ub(),a.Ub(),a.Ub(),a.Qb(14,"router-outlet"),a.Ub(),a.Ub()),2&t&&(a.Eb(2),a.Oc("Deal Number: ",e.dealNumber,""))},directives:[f.h,f.i,f.l],styles:["[_nghost-%COMP%]{color:#757575}.card-block[_ngcontent-%COMP%]{margin-top:0}.title[_ngcontent-%COMP%]{cursor:pointer;font-size:20px;color:#262b74;padding:15px;font-weight:700;margin-left:15px}.title[_ngcontent-%COMP%]:hover{text-decoration:underline}.copy-icon[_ngcontent-%COMP%]{cursor:pointer;font-size:20px;color:#262b74}.copy-icon[_ngcontent-%COMP%]:hover{opacity:.7}.top-menu[_ngcontent-%COMP%]{display:flex;justify-content:center}.tabs-container[_ngcontent-%COMP%]{display:flex;align-items:center}.tab-item[_ngcontent-%COMP%]{border:1px solid #1fac90;margin-left:-1px;padding:1em;font-size:13px;line-height:100%;font-weight:600;cursor:pointer}.tab-item.active[_ngcontent-%COMP%], .tab-item[_ngcontent-%COMP%]:hover{color:#fff;background:#1fac90}.tab-item[_ngcontent-%COMP%]:first-child{border-radius:6px 0 0 6px}.tab-item[_ngcontent-%COMP%]:first-child, .tab-item[_ngcontent-%COMP%]:last-child{border-right:1px solid #1fac90;border-left:1px solid #1fac90}.tab-item[_ngcontent-%COMP%]:last-child{border-radius:0 6px 6px 0}.icons-list[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{font-size:14px}.icons-list[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{padding-left:5px;font-size:14px}.info__block[_ngcontent-%COMP%]{display:flex;margin:30px 0}.info__item[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;width:200px;border-radius:6px;height:100px;padding:20px;margin-right:30px;font-size:18px;box-shadow:0 5px 15px rgba(0,0,0,.15)}.info__item-value[_ngcontent-%COMP%]{color:#1fac90}.info__item.comparison[_ngcontent-%COMP%]{width:auto;align-items:start;justify-content:start}.comparison-item[_ngcontent-%COMP%]{display:flex;align-items:center}.comparison-item[_ngcontent-%COMP%]   .info__item-title[_ngcontent-%COMP%]{width:90px}.comparison-item[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{height:2px;margin:0 5px}.comparison-item[_ngcontent-%COMP%]:nth-child(2n)   .info__item-value[_ngcontent-%COMP%]{color:#262b74}.comparison-item[_ngcontent-%COMP%]:nth-child(2n)   .line[_ngcontent-%COMP%]{background-color:#262b74}.comparison-item[_ngcontent-%COMP%]:nth-child(odd)   .line[_ngcontent-%COMP%]{background-color:#1fac90}.icons-list[_ngcontent-%COMP%]{margin-left:20px;margin-bottom:20px}"]}),t})();var pt=i("lJxs"),mt=i("Y+ZO");function Ct(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div"),a.Vb(1,"div",16),a.dc("onDragStart",(function(){a.Dc(t);const e=a.gc(),i=e.$implicit,o=e.index;return a.gc(3).onDragStart(i,o)}))("onDrop",(function(){a.Dc(t);const e=a.gc().index;return a.gc(3).onDrop(e)})),a.Vb(2,"div",17),a.Vb(3,"input",18),a.dc("ngModelChange",(function(e){return a.Dc(t),a.gc().$implicit.showField=e}))("change",(function(){return a.Dc(t),a.gc(4).onSelectColumn()})),a.Ub(),a.Vb(4,"label",19),a.Mc(5),a.Ub(),a.Vb(6,"div",20),a.dc("click",(function(){a.Dc(t);const e=a.gc().$implicit;return a.gc(3).onToggleFreeze(e)})),a.Qb(7,"i"),a.Ub(),a.Ub(),a.Ub(),a.Ub()}if(2&t){const t=a.gc().$implicit,e=a.gc().$implicit;a.Eb(3),a.oc("checked",t.showField)("ngModel",t.showField),a.Eb(2),a.Nc(t.header),a.Eb(2),a.Gb(e.iconClassNames)}}const yt=function(){return{color:"grey"}};function St(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div"),a.Vb(1,"div",21),a.Vb(2,"div",22),a.Vb(3,"input",23),a.dc("ngModelChange",(function(e){return a.Dc(t),a.gc().$implicit.showField=e}))("change",(function(){return a.Dc(t),a.gc(4).onSelectColumn()})),a.Ub(),a.Vb(4,"label",24),a.Mc(5),a.Ub(),a.Vb(6,"div",20),a.dc("click",(function(){a.Dc(t);const e=a.gc().$implicit;return a.gc(3).onToggleFreeze(e)})),a.Qb(7,"i"),a.Ub(),a.Ub(),a.Ub(),a.Ub()}if(2&t){const t=a.gc().$implicit,e=a.gc().$implicit;a.Eb(3),a.oc("checked",t.showField)("ngModel",t.showField)("disabled",!t.drag),a.Eb(1),a.oc("ngStyle",a.rc(7,yt)),a.Eb(1),a.Nc(t.header),a.Eb(2),a.Gb(e.iconClassNames)}}function vt(t,e){if(1&t&&(a.Kc(0,Ct,8,5,"div",15),a.Kc(1,St,8,8,"div",15)),2&t){const t=e.$implicit;a.oc("ngIf",t.drag),a.Eb(1),a.oc("ngIf",!t.drag)}}function wt(t,e){if(1&t&&(a.Tb(0),a.Vb(1,"p-listbox",13),a.Vb(2,"p-header"),a.Mc(3),a.Ub(),a.Kc(4,vt,2,2,"ng-template",14),a.Ub(),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("options",t.columns),a.Eb(2),a.Oc(" ",t.label," ")}}function Et(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div",3),a.Vb(1,"div",4),a.Vb(2,"div",5),a.Vb(3,"input",6),a.dc("click",(function(){return a.Dc(t),a.gc().onSelectAll()})),a.Ub(),a.Vb(4,"label",7),a.Mc(5,"Select All"),a.Ub(),a.Vb(6,"a",8),a.dc("click",(function(){return a.Dc(t),a.gc().onCloseConfigPopup()})),a.Mc(7,"\xd7"),a.Ub(),a.Kc(8,wt,5,2,"ng-container",9),a.Ub(),a.Vb(9,"div",10),a.Vb(10,"a",11),a.dc("click",(function(){return a.Dc(t),a.gc().onSaveConfig()})),a.Mc(11,"Save"),a.Ub(),a.Vb(12,"a",12),a.dc("click",(function(){return a.Dc(t),a.gc().onCloseConfigPopup()})),a.Mc(13,"Cancel"),a.Ub(),a.Ub(),a.Ub(),a.Ub()}if(2&t){const t=a.gc();a.Eb(3),a.oc("checked",t.isSelectAllChecked),a.Eb(5),a.oc("ngForOf",t.columnsList)}}let Vt=(()=>{class t{constructor(){this.showConfigPopup=!1,this.openConfig=new a.p,this.closeConfig=new a.p,this.saveConfig=new a.p,this.toggleFreeze=new a.p,this.selectColumn=new a.p,this.selectAll=new a.p,this.columnsList=[{label:"Frozen Columns",columns:[],iconClassNames:["pi","pi-lock"]},{label:"Other Columns",columns:[],iconClassNames:["pi","pi-lock"]}]}ngOnChanges(t){const e=t.frozenCols,i=t.scrollableCols;e&&e.currentValue&&i&&i.currentValue&&(this.columnsList=[{label:"Frozen Columns",columns:e.currentValue,iconClassNames:["pi","pi-lock"]},{label:"Other Columns",columns:i.currentValue,iconClassNames:["pi","pi-lock-open"]}])}onOpenConfigPopup(){this.openConfig.emit()}onCloseConfigPopup(){this.closeConfig.emit()}onSaveConfig(){this.saveConfig.emit()}onDragStart(t,e){this.startIndex=e,this.draggableCol=t}onDrop(t){this.draggableCol.isFrozen?(this.frozenCols.splice(this.startIndex,1),this.frozenCols.splice(t,0,this.draggableCol)):(this.scrollableCols.splice(this.startIndex,1),this.scrollableCols.splice(t,0,this.draggableCol))}onToggleFreeze(t){this.toggleFreeze.emit(t)}onSelectColumn(){this.selectColumn.emit()}onSelectAll(){this.selectAll.emit()}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=a.Jb({type:t,selectors:[["app-columns-config"]],inputs:{frozenCols:"frozenCols",scrollableCols:"scrollableCols",isSelectAllChecked:"isSelectAllChecked",showConfigPopup:"showConfigPopup"},outputs:{openConfig:"openConfig",closeConfig:"closeConfig",saveConfig:"saveConfig",toggleFreeze:"toggleFreeze",selectColumn:"selectColumn",selectAll:"selectAll"},features:[a.Cb],decls:4,vars:1,consts:[[1,"add-column",3,"click"],[1,"fa","fa-cog"],["id","add-column-popup","class","contracts_add_column",4,"ngIf"],["id","add-column-popup",1,"contracts_add_column"],[1,"user-popup"],[1,"content","overflow"],["type","checkbox","id","selectall","name","selectall",3,"checked","click"],["for","selectall"],["title","Close",1,"close",3,"click"],[4,"ngFor","ngForOf"],[1,"pull-right"],[1,"configColBtn",3,"click"],[1,"configColBtn","conf-cancel",3,"click"],[3,"options"],["pTemplate","item"],[4,"ngIf"],["pDraggable","gens","pDroppable","gens",1,"ui-helper-clearfix",3,"onDragStart","onDrop"],[1,"d-flex","align-items-center","drag"],["type","checkbox",3,"checked","ngModel","ngModelChange","change"],[1,"col-label"],[1,"ml-2","freeze-btn",3,"click"],[1,"ui-helper-clearfix"],[1,"d-flex","align-items-center"],["type","checkbox",3,"checked","ngModel","disabled","ngModelChange","change"],[1,"col-label",3,"ngStyle"]],template:function(t,e){1&t&&(a.Vb(0,"a",0),a.dc("click",(function(){return e.onOpenConfigPopup()})),a.Qb(1,"em",1),a.Mc(2,"Columns"),a.Ub(),a.Kc(3,Et,14,2,"div",2)),2&t&&(a.Eb(3),a.oc("ngIf",e.showConfigPopup))},directives:[o.o,o.n,E.a,V.c,V.f,F.b,F.c,p.a,p.k,p.n,o.p],styles:[".col-label[_ngcontent-%COMP%]{position:static!important}.freeze-btn[_ngcontent-%COMP%]{cursor:pointer}"]}),t})();function Ft(t,e){if(1&t&&(a.Tb(0),a.Vb(1,"span",16),a.Mc(2),a.Ub(),a.Sb()),2&t){const t=e.ngIf;a.Eb(2),a.Nc(t)}}function At(t,e){1&t&&a.Qb(0,"col")}function Dt(t,e){if(1&t&&(a.Tb(0),a.Kc(1,At,1,0,"col",9),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Ut(t,e){if(1&t&&(a.Vb(0,"colgroup"),a.Kc(1,Dt,2,1,"ng-container",14),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}const Mt=function(t){return{number:t}},It=function(t,e){return{display:t,width:"300px","text-align":e}};function zt(t,e){if(1&t&&(a.Vb(0,"th",19),a.Mc(1),a.Ub()),2&t){const t=a.gc().$implicit;a.Gb(a.sc(5,Mt,"number"===t.type)),a.pc("title",t.header),a.oc("ngStyle",a.tc(7,It,t.display,t.alignment)),a.Eb(1),a.Oc("",t.header," ")}}function Tt(t,e){if(1&t&&(a.Tb(0),a.Kc(1,zt,2,10,"th",18),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function xt(t,e){if(1&t&&(a.Vb(0,"tr"),a.Kc(1,Tt,2,1,"ng-container",14),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}function Ot(t,e){if(1&t&&(a.Tb(0),a.Kc(1,xt,2,1,"ng-template",17),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}const Pt=function(t,e){return{display:t,"text-align":e}};function kt(t,e){if(1&t&&(a.Vb(0,"td",22),a.Mc(1),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.tc(3,Pt,t.display,t.alignment)),a.Eb(1),a.Oc(" ",e[t.field]," ")}}function Kt(t,e){if(1&t&&(a.Vb(0,"td",22),a.Vb(1,"span"),a.Vb(2,"a",23),a.Mc(3),a.Ub(),a.Ub(),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.tc(4,Pt,t.display,t.alignment)),a.Eb(2),a.pc("title",e[t.field]),a.Eb(1),a.Nc(e[t.field])}}function Lt(t,e){if(1&t&&(a.Vb(0,"td",22),a.Mc(1),a.hc(2,"number"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.tc(5,Pt,t.display,t.alignment)),a.Eb(1),a.Oc(" ",a.ic(2,3,e[t.field])," ")}}function $t(t,e){if(1&t&&(a.Vb(0,"td",22),a.Mc(1),a.hc(2,"number"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.tc(6,Pt,t.display,t.alignment)),a.Eb(1),a.Oc(" ",null!=e[t.field]?a.jc(2,3,e[t.field],"1.2-2")+"%":"-"," ")}}function Nt(t,e){if(1&t&&(a.Vb(0,"td",22),a.hc(1,"date"),a.Mc(2),a.hc(3,"date"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.jc(1,3,e[t.field],"yyyy-MM-dd")),a.oc("ngStyle",a.tc(9,Pt,t.display,t.alignment)),a.Eb(2),a.Oc(" ",a.jc(3,6,e[t.field],"yyyy-MM-dd")," ")}}function Rt(t,e){if(1&t&&(a.Vb(0,"td",22),a.hc(1,"round"),a.Mc(2),a.hc(3,"round"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.ic(1,3,e[t.field])),a.oc("ngStyle",a.tc(7,Pt,t.display,t.alignment)),a.Eb(2),a.Oc(" ",a.ic(3,5,e[t.field])," ")}}function Qt(t,e){if(1&t&&(a.Vb(0,"td",22),a.hc(1,"round"),a.Mc(2),a.hc(3,"round"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.ic(1,3,e[t.field])),a.oc("ngStyle",a.tc(7,Pt,t.display,t.alignment)),a.Eb(2),a.Oc(" ( ",a.ic(3,5,e[t.field])," ) ")}}function _t(t,e){if(1&t&&(a.Tb(0),a.Kc(1,kt,2,6,"td",21),a.Kc(2,Kt,4,7,"td",21),a.Kc(3,Lt,3,8,"td",21),a.Kc(4,$t,3,9,"td",21),a.Kc(5,Nt,4,12,"td",21),a.Kc(6,Rt,4,10,"td",21),a.Kc(7,Qt,4,10,"td",21),a.Sb()),2&t){const t=a.gc().$implicit;a.Eb(1),a.oc("ngIf","text"==t.type),a.Eb(1),a.oc("ngIf","link"==t.type),a.Eb(1),a.oc("ngIf","number"==t.type),a.Eb(1),a.oc("ngIf","percent"==t.type),a.Eb(1),a.oc("ngIf","date"==t.type),a.Eb(1),a.oc("ngIf","round"==t.type),a.Eb(1),a.oc("ngIf","parentheses"==t.type)}}function Gt(t,e){if(1&t&&(a.Tb(0),a.Kc(1,_t,8,7,"ng-container",9),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function jt(t,e){if(1&t&&(a.Vb(0,"tr",20),a.Kc(1,Gt,2,1,"ng-container",14),a.Ub()),2&t){const t=e.columns;a.oc("pSelectableRow",e.$implicit),a.Eb(1),a.oc("ngForOf",t)}}function Wt(t,e){if(1&t&&(a.Tb(0),a.Kc(1,jt,2,2,"ng-template",17),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}function Bt(t,e){1&t&&a.Qb(0,"td")}function qt(t,e){1&t&&(a.Vb(0,"td"),a.Mc(1,"Totals:"),a.Ub())}function Ht(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Nc(a.ic(2,1,t.totalExtendedListAmt))}}function Yt(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Nc(a.ic(2,1,t.totalLineAmt))}}function Jt(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"number"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Oc(" ",null!=t.totalDiscount?a.jc(2,1,t.totalDiscount,"1.2-2")+"%":"-"," ")}}function Xt(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Nc(a.ic(2,1,t.totalAllocationAmt))}}function Zt(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Nc(a.ic(2,1,t.totalCarveInOut))}}function te(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"number"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Oc(" ",null!=t.totalGrossMarginPercent?a.jc(2,1,t.totalGrossMarginPercent,"1.2-2")+"%":"-"," ")}}function ee(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"number"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Oc(" ",null!=t.totalAllocatedMarginPercent?a.jc(2,1,t.totalAllocatedMarginPercent,"1.2-2")+"%":"-"," ")}}function ie(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"number"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Nc(a.ic(2,1,t.totalRevenueAdjustment))}}function oe(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"number"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Oc(" ",null!=t.totalAdjustedAllocatedMarginPercent?a.jc(2,1,t.totalAdjustedAllocatedMarginPercent,"1.2-2")+"%":"-"," ")}}function le(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Oc("( ",a.ic(2,1,t.totalStandardCost)," ) ")}}function ne(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Oc("( ",a.ic(2,1,t.totalCostAdjusted)," ) ")}}function ce(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Oc("( ",a.ic(2,1,t.totalAdjustedCost)," ) ")}}function se(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Nc(a.ic(2,1,t.totalGrossMargin))}}function ae(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(3).$implicit;a.Eb(1),a.Nc(a.ic(2,1,t.totalAllocatedMarginAmount))}}function re(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Bt,1,0,"td",9),a.Kc(2,qt,2,0,"td",9),a.Kc(3,Ht,3,3,"td",9),a.Kc(4,Yt,3,3,"td",9),a.Kc(5,Jt,3,4,"td",9),a.Kc(6,Xt,3,3,"td",9),a.Kc(7,Zt,3,3,"td",9),a.Kc(8,te,3,4,"td",9),a.Kc(9,ee,3,4,"td",9),a.Kc(10,ie,3,3,"td",9),a.Kc(11,oe,3,4,"td",9),a.Kc(12,le,3,3,"td",9),a.Kc(13,ne,3,3,"td",9),a.Kc(14,ce,3,3,"td",9),a.Kc(15,se,3,3,"td",9),a.Kc(16,ae,3,3,"td",9),a.Sb()),2&t){const t=a.gc().$implicit;a.Eb(1),a.oc("ngIf","empty"==t.footer),a.Eb(1),a.oc("ngIf","totals"==t.footer),a.Eb(1),a.oc("ngIf","totalExtendedListAmt"==t.footer),a.Eb(1),a.oc("ngIf","totalLineAmt"==t.footer),a.Eb(1),a.oc("ngIf","totalDiscount"==t.footer),a.Eb(1),a.oc("ngIf","totalAllocationAmt"==t.footer),a.Eb(1),a.oc("ngIf","totalCarveInOut"==t.footer),a.Eb(1),a.oc("ngIf","totalGrossMarginPercent"==t.footer),a.Eb(1),a.oc("ngIf","totalAllocatedMarginPercent"==t.footer),a.Eb(1),a.oc("ngIf","totalRevenueAdjustment"==t.footer),a.Eb(1),a.oc("ngIf","totalAdjustedAllocatedMarginPercent"==t.footer),a.Eb(1),a.oc("ngIf","totalStandardCost"==t.footer),a.Eb(1),a.oc("ngIf","totalCostAdjusted"==t.footer),a.Eb(1),a.oc("ngIf","totalAdjustedCost"==t.footer),a.Eb(1),a.oc("ngIf","totalGrossMargin"==t.footer),a.Eb(1),a.oc("ngIf","totalAllocatedMarginAmount"==t.footer)}}function de(t,e){if(1&t&&(a.Tb(0),a.Kc(1,re,17,16,"ng-container",9),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function he(t,e){if(1&t&&(a.Vb(0,"tr",25),a.Kc(1,de,2,1,"ng-container",14),a.Ub()),2&t){const t=a.gc().$implicit;a.Eb(1),a.oc("ngForOf",t)}}function ge(t,e){if(1&t&&(a.Kc(0,he,2,1,"tr",24),a.hc(1,"async")),2&t){const t=a.gc(2);a.oc("ngIf",a.ic(1,1,t.dealSummaryTotals$))}}function be(t,e){if(1&t&&(a.Tb(0),a.Kc(1,ge,2,3,"ng-template",17),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}function ue(t,e){1&t&&(a.Vb(0,"div",26),a.Vb(1,"p"),a.Mc(2,"No records found"),a.Ub(),a.Ub())}const fe=function(t){return{unfrozen:t}};let pe=(()=>{class t{constructor(t,e,i,o){this.route=t,this.dealsService=e,this.notificationService=i,this.commonSharedService=o,this.columns=[],this.clonedCols=[],this.globalCols=[],this.frozenCols=[],this.scrollableCols=[],this.tableHeaderTmpl=["frozenheader","header"],this.tableBodyTmpl=["frozenbody","body"],this.tableFooterTmpl=["frozenfooter","footer"],this.isTableFrozen=!1,this.loading=!1,this.showPaginator=!0,this.pageSize=10,this.isQuoteView=!1,this.isConfigOpened=!1,this.isSelectAllChecked=!0,this.isUsdView=!1}ngOnInit(){this.dealId=this.route.parent.snapshot.paramMap.get("dealId"),this.totalComments$=this.dealsService.getDealComments(this.dealId).pipe(Object(pt.a)(t=>t.totalElements)),this.setDetailsTable()}getTableColumns(t,e){this.isSelectAllChecked=!0,this.commonSharedService.getConfiguredColDetails(t,e).then(t=>{if(t&&null!=t&&t.userId){const e=t.tableColumns.split("/"),i=e[0].split(","),o=e[1]?e[1].split(","):[];this.globalCols.forEach(t=>{t.showField=-1!==[...i,...o].indexOf(t.field)});const l=this.globalCols.filter(t=>!t.showField);i.forEach(t=>{const e=this.globalCols.find(e=>e.field===t);e&&this.scrollableCols.push(e)}),o.forEach(t=>{const e=this.globalCols.find(e=>e.field===t);e&&(e.isFrozen=!0,this.frozenCols.push(e))}),l.forEach(t=>{this.scrollableCols.push(t)}),this.globalCols=[...this.frozenCols,...this.scrollableCols],this.getFrozenWidth(),i.length+o.length!==this.globalCols.length&&(this.isSelectAllChecked=!1),this.showPaginator=i.length+o.length!==0,this.userId=t.userId}else this.recollectColumns()}).catch(()=>{this.notificationService.showError("Error occured while getting table columns data"),this.loading=!1})}getSummaryData(t){const e=t?t.first/t.rows:0,i=this.isQuoteView?"Q":"D";this.loading=!0,this.getSummaryTotals(),this.subscription=this.dealsService.getDealRollUpSummaryData(this.dealId,i,this.isUsdView,e).subscribe(t=>{this.loading=!1,this.dealRollUpSummaryData=t.content,this.totalElements=t.totalElements},()=>{this.notificationService.showError("Error occured while getting table columns data"),this.loading=!1})}getSummaryTotals(){this.dealSummaryTotals$=this.dealsService.getSummaryDataTotals(this.dealId,this.isQuoteView?"Q":"D",this.isUsdView)}toggleView(){this.isQuoteView=!this.isQuoteView;const t=this.globalCols.find(t=>"dealQuoteNum"===t.field);this.isQuoteView?(t.header="Quote Number",this.getSummaryData()):(t.header="Deal Number",this.getSummaryData())}setDetailsTable(){this.globalCols=g,this.getTableColumns("Deal Details","Deal Summary")}onConfiguringColumns(){this.clonedCols=[...this.globalCols],this.isConfigOpened=!0}onToggleFreeze(t){const e=this.globalCols.find(e=>e.field===t.field);e.isFrozen=!e.isFrozen,this.recollectColumns()}recollectColumns(){this.frozenCols=this.globalCols.filter(t=>t.isFrozen),this.scrollableCols=this.globalCols.filter(t=>!t.isFrozen),this.getFrozenWidth()}getFrozenWidth(){const t=this.frozenCols.filter(t=>t.showField);this.frozenWidth=(t.length?150*t.length:0)+"px",this.isTableFrozen=!!this.frozenCols&&!!this.frozenCols.length&&!!this.frozenCols.some(t=>!!t.showField)}selectColumns(){this.isSelectAllChecked=this.globalCols.filter(t=>!t.showField).length<=0,this.getFrozenWidth()}onSelectAll(){this.isSelectAllChecked=!this.isSelectAllChecked,this.globalCols.forEach(t=>{this.isSelectAllChecked?t.showField=!0:t.drag&&(t.showField=!1)})}closeConfigureColumns(){this.isConfigOpened=!1}saveColumns(){let t="",e="";this.isConfigOpened=!1,this.frozenCols.forEach((e,i)=>{e.showField&&(t+=e.field,i<this.frozenCols.length-1&&(t+=","))}),this.scrollableCols.forEach((t,i)=>{t.showField&&(e+=t.field,i<this.scrollableCols.length-1&&(e+=","))});const i=e+"/"+t;this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("Deal Details","Deal Summary",i,this.userId).then(t=>{this.userId=t.userId,this.loading=!1}).catch(()=>{this.notificationService.showError("Error occured while getting data"),this.loading=!1})}exportExcel(){const t=[];for(let e=0;e<this.globalCols.length;e++)this.globalCols[e].showField&&t.push(this.globalCols[e].field);window.location.href=this.dealsService.getRollUpExportUrl(this.dealId,this.isQuoteView?"Q":"D",this.isUsdView,t)}ngOnDestroy(){this.subscription.unsubscribe()}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(f.a),a.Pb(d),a.Pb(n.a),a.Pb(c.a))},t.\u0275cmp=a.Jb({type:t,selectors:[["app-deal-summary"]],decls:20,vars:27,consts:[[1,"pull-right","icons-list"],["onLabel","TC View","offLabel","USD View","onIcon","fa fa-toggle-on fa-sm","offIcon","fa fa-toggle-off fa-sm",1,"ui-inputswitch",3,"ngModel","disabled","ngModelChange"],[3,"frozenCols","scrollableCols","isSelectAllChecked","showConfigPopup","openConfig","closeConfig","saveConfig","toggleFreeze","selectColumn","selectAll"],["title","Export",3,"click"],[1,"fa","fa-external-link"],[3,"click"],[1,"fa","fa-list"],["routerLink","comments",1,"comments-icon"],[1,"fa","fa-comments"],[4,"ngIf"],[1,"x-scroll"],["id","deal-summary","lazy","true","columnResizeMode","expand","exportFilename","Deal_Data.csv",1,"ui-datatable","arrangementMgrTbl","wide-columns",3,"value","loading","paginator","rows","totalRecords","columns","frozenColumns","frozenWidth","scrollable","resizableColumns","onLazyLoad"],["dt",""],["pTemplate","colgroup"],[4,"ngFor","ngForOf"],["pTemplate","emptymessage"],[1,"count"],[3,"pTemplate"],["pResizableColumn","",3,"ngStyle","class","title",4,"ngIf"],["pResizableColumn","",3,"ngStyle","title"],[3,"pSelectableRow"],[3,"title","ngStyle",4,"ngIf"],[3,"title","ngStyle"],[3,"title"],["class","table-footer right-align",4,"ngIf"],[1,"table-footer","right-align"],[1,"no-results-data"]],template:function(t,e){1&t&&(a.Vb(0,"div",0),a.Vb(1,"p-toggleButton",1),a.dc("ngModelChange",(function(t){return e.isUsdView=t}))("ngModelChange",(function(){return e.getSummaryData()})),a.Ub(),a.Vb(2,"app-columns-config",2),a.dc("openConfig",(function(){return e.onConfiguringColumns()}))("closeConfig",(function(){return e.closeConfigureColumns()}))("saveConfig",(function(){return e.saveColumns()}))("toggleFreeze",(function(t){return e.onToggleFreeze(t)}))("selectColumn",(function(){return e.selectColumns()}))("selectAll",(function(){return e.onSelectAll()})),a.Ub(),a.Vb(3,"a",3),a.dc("click",(function(){return e.exportExcel()})),a.Qb(4,"em",4),a.Ub(),a.Vb(5,"a",5),a.dc("click",(function(){return e.toggleView()})),a.Qb(6,"em",6),a.Mc(7),a.Ub(),a.Vb(8,"a",7),a.Qb(9,"em",8),a.Kc(10,Ft,3,1,"ng-container",9),a.hc(11,"async"),a.Ub(),a.Ub(),a.Vb(12,"div",10),a.Vb(13,"p-table",11,12),a.dc("onLazyLoad",(function(t){return e.getSummaryData(t)})),a.Kc(15,Ut,2,1,"ng-template",13),a.Kc(16,Ot,2,1,"ng-container",14),a.Kc(17,Wt,2,1,"ng-container",14),a.Kc(18,be,2,1,"ng-container",14),a.Kc(19,ue,3,0,"ng-template",15),a.Ub(),a.Ub()),2&t&&(a.Eb(1),a.oc("ngModel",e.isUsdView)("disabled",e.loading),a.Eb(1),a.oc("frozenCols",e.frozenCols)("scrollableCols",e.scrollableCols)("isSelectAllChecked",e.isSelectAllChecked)("showConfigPopup",e.isConfigOpened),a.Eb(5),a.Oc(" ",e.isQuoteView?"Deal View":"Quote View"," "),a.Eb(3),a.oc("ngIf",a.ic(11,23,e.totalComments$)),a.Eb(3),a.Gb(a.sc(25,fe,!e.isTableFrozen)),a.oc("value",e.dealRollUpSummaryData)("loading",e.loading)("paginator",e.showPaginator)("rows",10)("totalRecords",e.totalElements)("columns",e.scrollableCols)("frozenColumns",e.frozenCols)("frozenWidth",e.frozenWidth)("scrollable",!0)("resizableColumns",!0),a.Eb(3),a.oc("ngForOf",e.tableHeaderTmpl),a.Eb(1),a.oc("ngForOf",e.tableBodyTmpl),a.Eb(1),a.oc("ngForOf",e.tableFooterTmpl))},directives:[mt.a,p.k,p.n,Vt,f.j,o.o,A.j,V.f,o.n,A.g,o.p,A.i],pipes:[o.b,o.g,o.f,D.a],styles:[".icons-list[_ngcontent-%COMP%]{margin-bottom:10px}#add-column-popup[_ngcontent-%COMP%]{top:240px;right:170px}.comments-icon[_ngcontent-%COMP%]{position:relative}.fa-comments[_ngcontent-%COMP%]{transform:scale(1.2)}.count[_ngcontent-%COMP%]{position:absolute;background:#ad1212;width:16px;height:16px;display:flex;justify-content:center;align-items:center;border-radius:50%;top:0;right:-4px;color:#fff}"]}),t})();var me=i("xYYa"),Ce=i("qfV7"),ye=i("Nf9I"),Se=i("7CaW");function ve(t,e){if(1&t){const t=a.Wb();a.Tb(0),a.Vb(1,"a",14),a.dc("click",(function(){return a.Dc(t),a.gc(2).exportExcel()})),a.Qb(2,"em",15),a.Ub(),a.Sb()}}function we(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div",9),a.Vb(1,"app-columns-config",10),a.dc("openConfig",(function(){return a.Dc(t),a.gc().onConfiguringColumns()}))("closeConfig",(function(){return a.Dc(t),a.gc().closeConfigureColumns()}))("saveConfig",(function(){return a.Dc(t),a.gc().saveColumns()}))("toggleFreeze",(function(e){return a.Dc(t),a.gc().onToggleFreeze(e)}))("selectColumn",(function(){return a.Dc(t),a.gc().selectColumns()}))("selectAll",(function(){return a.Dc(t),a.gc().onSelectAll()})),a.Ub(),a.Vb(2,"a",11),a.dc("click",(function(){a.Dc(t);const e=a.gc(),i=a.Bc(7);return e.reset(i)||e.reset(e.table)})),a.Qb(3,"em",12),a.Ub(),a.Kc(4,ve,3,0,"ng-container",13),a.Ub()}if(2&t){const t=a.gc();a.Eb(1),a.oc("frozenCols",t.frozenCols)("scrollableCols",t.scrollableCols)("isSelectAllChecked",t.isSelectAllChecked)("showConfigPopup",t.isConfigOpened),a.Eb(3),a.oc("ngIf",!t.disableExport)}}function Ee(t,e){1&t&&a.Qb(0,"col")}function Ve(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Ee,1,0,"col",13),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Fe(t,e){if(1&t&&(a.Vb(0,"colgroup"),a.Kc(1,Ve,2,1,"ng-container",7),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}const Ae=function(t,e){return{display:t,"text-align":e}};function De(t,e){if(1&t&&(a.Tb(0),a.Vb(1,"th",17),a.Mc(2),a.Ub(),a.Sb()),2&t){const t=a.gc().$implicit;a.Eb(1),a.pc("title",t.header),a.oc("ngStyle",a.tc(3,Ae,t.display,t.alignment)),a.Eb(1),a.Nc(t.header)}}function Ue(t,e){if(1&t&&(a.Tb(0),a.Kc(1,De,3,6,"ng-container",13),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Me(t,e){if(1&t&&(a.Vb(0,"tr"),a.Kc(1,Ue,2,1,"ng-container",7),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}function Ie(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Me,2,1,"ng-template",16),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}function ze(t,e){if(1&t&&(a.Vb(0,"td",19),a.Mc(1),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.tc(3,Ae,t.display,t.alignment)),a.Eb(1),a.Oc(" ",e[t.field]," ")}}function Te(t,e){if(1&t&&(a.Vb(0,"td",19),a.Mc(1),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.tc(3,Ae,t.display,t.alignment)),a.Eb(1),a.Oc(" ",e[t.field]," ")}}function xe(t,e){if(1&t&&(a.Vb(0,"td",19),a.hc(1,"date"),a.Mc(2),a.hc(3,"date"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.jc(1,3,e[t.field],"MM/dd/yyyy")),a.oc("ngStyle",a.tc(9,Ae,t.display,t.alignment)),a.Eb(2),a.Oc(" ",a.jc(3,6,e[t.field],"MM/dd/yyyy")," ")}}function Oe(t,e){if(1&t&&(a.Vb(0,"td",19),a.hc(1,"round"),a.Mc(2),a.hc(3,"round"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.ic(1,3,e[t.field])),a.oc("ngStyle",a.tc(7,Ae,t.display,t.alignment)),a.Eb(2),a.Oc(" ",a.ic(3,5,e[t.field])," ")}}function Pe(t,e){if(1&t&&(a.Vb(0,"td",19),a.hc(1,"round"),a.Mc(2),a.hc(3,"round"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.ic(1,3,e[t.field])),a.oc("ngStyle",a.tc(7,Ae,t.display,t.alignment)),a.Eb(2),a.Oc(" ",null!=e[t.field]?a.ic(3,5,e[t.field]):"-"," ")}}function ke(t,e){if(1&t&&(a.Vb(0,"td",19),a.hc(1,"round"),a.Mc(2),a.hc(3,"number"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.ic(1,3,e[t.field])),a.oc("ngStyle",a.tc(8,Ae,t.display,t.alignment)),a.Eb(2),a.Oc(" ",null!=e[t.field]?a.jc(3,5,e[t.field],"1.2-2")+"%":"-"," ")}}function Ke(t,e){if(1&t&&(a.Vb(0,"td",19),a.hc(1,"round"),a.Mc(2),a.hc(3,"round"),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",a.ic(1,3,e[t.field])),a.oc("ngStyle",a.tc(7,Ae,t.display,t.alignment)),a.Eb(2),a.Oc(" ( ",a.ic(3,5,e[t.field])," ) ")}}function Le(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",20),a.Ub())}function $e(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",21),a.Ub())}function Ne(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",22),a.Ub())}function Re(t,e){if(1&t&&(a.Vb(0,"td",19),a.Kc(1,Le,2,0,"span",13),a.Kc(2,$e,2,0,"span",13),a.Kc(3,Ne,2,0,"span",13),a.Ub()),2&t){const t=a.gc(2).$implicit,e=a.gc().$implicit;a.pc("title",e[t.field]),a.oc("ngStyle",a.tc(5,Ae,t.display,t.alignment)),a.Eb(1),a.oc("ngIf","RED"==e[t.field]),a.Eb(1),a.oc("ngIf","GREEN"==e[t.field]),a.Eb(1),a.oc("ngIf","YELLOW"==e[t.field])}}function Qe(t,e){if(1&t&&(a.Tb(0),a.Kc(1,ze,2,6,"td",18),a.Kc(2,Te,2,6,"td",18),a.Kc(3,xe,4,12,"td",18),a.Kc(4,Oe,4,10,"td",18),a.Kc(5,Pe,4,10,"td",18),a.Kc(6,ke,4,11,"td",18),a.Kc(7,Ke,4,10,"td",18),a.Kc(8,Re,4,8,"td",18),a.Sb()),2&t){const t=a.gc().$implicit;a.Eb(1),a.oc("ngIf","text"==t.type),a.Eb(1),a.oc("ngIf","number"==t.type),a.Eb(1),a.oc("ngIf","date"==t.type),a.Eb(1),a.oc("ngIf","round"==t.type),a.Eb(1),a.oc("ngIf","bround"==t.type),a.Eb(1),a.oc("ngIf","percent"==t.type),a.Eb(1),a.oc("ngIf","parentheses"==t.type),a.Eb(1),a.oc("ngIf","symbol"==t.type)}}function _e(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Qe,9,8,"ng-container",13),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Ge(t,e){if(1&t&&(a.Vb(0,"tr"),a.Kc(1,_e,2,1,"ng-container",7),a.Ub()),2&t){const t=e.columns;a.Eb(1),a.oc("ngForOf",t)}}function je(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Ge,2,1,"ng-template",16),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}function We(t,e){1&t&&a.Qb(0,"td")}function Be(t,e){1&t&&(a.Vb(0,"td"),a.Mc(1,"Totals:"),a.Ub())}function qe(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.totalListAmount))}}function He(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.lineAmountTotal))}}function Ye(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.vcTotal))}}function Je(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.allocableNetTotal))}}function Xe(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.fvTotal))}}function Ze(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.allocationTotal))}}function ti(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.cvInOutAmountTotal))}}function ei(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.allocationFcTotal))}}function ii(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.espTotal))}}function oi(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.espInstTotal))}}function li(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",20),a.Ub())}function ni(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",21),a.Ub())}function ci(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",22),a.Ub())}function si(t,e){if(1&t&&(a.Vb(0,"td",25),a.Kc(1,li,2,0,"span",13),a.Kc(2,ni,2,0,"span",13),a.Kc(3,ci,2,0,"span",13),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.oc("ngIf","RED"==t.allocStatusTotal),a.Eb(1),a.oc("ngIf","GREEN"==t.allocStatusTotal),a.Eb(1),a.oc("ngIf","YELLOW"==t.allocStatusTotal)}}function ai(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",20),a.Ub())}function ri(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",21),a.Ub())}function di(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",22),a.Ub())}function hi(t,e){if(1&t&&(a.Vb(0,"td",25),a.Kc(1,ai,2,0,"span",13),a.Kc(2,ri,2,0,"span",13),a.Kc(3,di,2,0,"span",13),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.oc("ngIf","RED"==t.allocMarginStatusTotal),a.Eb(1),a.oc("ngIf","GREEN"==t.allocMarginStatusTotal),a.Eb(1),a.oc("ngIf","YELLOW"==t.allocMarginStatusTotal)}}function gi(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",20),a.Ub())}function bi(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",21),a.Ub())}function ui(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",22),a.Ub())}function fi(t,e){if(1&t&&(a.Vb(0,"td",25),a.Kc(1,gi,2,0,"span",13),a.Kc(2,bi,2,0,"span",13),a.Kc(3,ui,2,0,"span",13),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.oc("ngIf","RED"==t.discountStatusTotal),a.Eb(1),a.oc("ngIf","GREEN"==t.discountStatusTotal),a.Eb(1),a.oc("ngIf","YELLOW"==t.discountStatusTotal)}}function pi(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",20),a.Ub())}function mi(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",21),a.Ub())}function Ci(t,e){1&t&&(a.Vb(0,"span"),a.Qb(1,"i",22),a.Ub())}function yi(t,e){if(1&t&&(a.Vb(0,"td",25),a.Kc(1,pi,2,0,"span",13),a.Kc(2,mi,2,0,"span",13),a.Kc(3,Ci,2,0,"span",13),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.oc("ngIf","RED"==t.statusTotal),a.Eb(1),a.oc("ngIf","GREEN"==t.statusTotal),a.Eb(1),a.oc("ngIf","YELLOW"==t.statusTotal)}}function Si(t,e){if(1&t&&(a.Vb(0,"span"),a.Mc(1),a.Ub()),2&t){const t=a.gc(6);a.Eb(1),a.Oc("Lines Failing: ",t.commentsTotal,"")}}function vi(t,e){if(1&t&&(a.Vb(0,"td",25),a.Kc(1,Si,2,1,"span",13),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.oc("ngIf",null!=t.commentsTotal)}}function wi(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.totalRebate))}}function Ei(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.totalGrossMargin))}}function Vi(t,e){if(1&t&&(a.Vb(0,"td"),a.Mc(1),a.hc(2,"round"),a.Ub()),2&t){const t=a.gc(5);a.Eb(1),a.Nc(a.ic(2,1,t.totalAllocatedMarginAmount))}}function Fi(t,e){if(1&t&&(a.Tb(0),a.Kc(1,We,1,0,"td",13),a.Kc(2,Be,2,0,"td",13),a.Kc(3,qe,3,3,"td",13),a.Kc(4,He,3,3,"td",13),a.Kc(5,Ye,3,3,"td",13),a.Kc(6,Je,3,3,"td",13),a.Kc(7,Xe,3,3,"td",13),a.Kc(8,Ze,3,3,"td",13),a.Kc(9,ti,3,3,"td",13),a.Kc(10,ei,3,3,"td",13),a.Kc(11,ii,3,3,"td",13),a.Kc(12,oi,3,3,"td",13),a.Kc(13,si,4,3,"td",24),a.Kc(14,hi,4,3,"td",24),a.Kc(15,fi,4,3,"td",24),a.Kc(16,yi,4,3,"td",24),a.Kc(17,vi,2,1,"td",24),a.Kc(18,wi,3,3,"td",13),a.Kc(19,Ei,3,3,"td",13),a.Kc(20,Vi,3,3,"td",13),a.Sb()),2&t){const t=a.gc().$implicit;a.Eb(1),a.oc("ngIf","empty"==t.footer),a.Eb(1),a.oc("ngIf","totals"==t.footer),a.Eb(1),a.oc("ngIf","totalListAmount"==t.footer),a.Eb(1),a.oc("ngIf","lineAmountTotal"==t.footer),a.Eb(1),a.oc("ngIf","vcTotal"==t.footer),a.Eb(1),a.oc("ngIf","allocableNetTotal"==t.footer),a.Eb(1),a.oc("ngIf","fvTotal"==t.footer),a.Eb(1),a.oc("ngIf","allocationTotal"==t.footer),a.Eb(1),a.oc("ngIf","cvInOutAmountTotal"==t.footer),a.Eb(1),a.oc("ngIf","allocationFcTotal"==t.footer),a.Eb(1),a.oc("ngIf","espTotal"==t.footer),a.Eb(1),a.oc("ngIf","espInstTotal"==t.footer),a.Eb(1),a.oc("ngIf","allocStatusTotal"==t.footer),a.Eb(1),a.oc("ngIf","allocMarginStatusTotal"==t.footer),a.Eb(1),a.oc("ngIf","discountStatusTotal"==t.footer),a.Eb(1),a.oc("ngIf","statusTotal"==t.footer),a.Eb(1),a.oc("ngIf","commentsTotal"==t.footer),a.Eb(1),a.oc("ngIf","totalRebate"==t.footer),a.Eb(1),a.oc("ngIf","totalGrossMargin"==t.footer),a.Eb(1),a.oc("ngIf","totalAllocatedMarginAmount"==t.footer)}}function Ai(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Fi,21,20,"ng-container",13),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Di(t,e){if(1&t&&(a.Vb(0,"tr",23),a.Kc(1,Ai,2,1,"ng-container",7),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}function Ui(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Di,2,1,"ng-template",16),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}function Mi(t,e){if(1&t&&(a.Vb(0,"div",26),a.Vb(1,"p"),a.Mc(2),a.Ub(),a.Ub()),2&t){const t=a.gc();a.Eb(2),a.Nc(t.noData)}}const Ii=function(t){return{unfrozen:t}};let zi=(()=>{class t{constructor(t,e,i,o,l,n,c,a,r,d){this.ref=t,this.arrgContractAllocationsVService=e,this.router=i,this.confirmationService=o,this.formBuilder=l,this.commonSharedService=n,this.notificationService=c,this.datePipe=a,this.dealArrgService=r,this.location=d,this.tempDisplayDialog=!1,this.displayPageSize=20,this.displayProspectiveDialog=!1,this.noData=s.noData,this.selectedDeals=[],this.displayProspDeals=!1,this.arrgContractAllocationsV=new Ti,this.arrgContractAllocationsVSearch=new Ti,this.prospectiveDeals=new xi,this.prospectiveDealsList=[],this.prospectiveDealListConst=[],this.isSerached=0,this.arrgContractAllocationsVList=[],this.newProspectiveDealsList=[],this.rowCount=10,this.collapsed=!0,this.table={},this.isConfigOpened=!1,this.isSelectAllChecked=!0,this.frozenCols=[],this.scrollableCols=[],this.tableHeaderTmpl=["frozenheader","header"],this.tableBodyTmpl=["frozenbody","body"],this.tableFooterTmpl=["frozenfooter","footer"],this.isTableFrozen=!1,this.showPaginator=!0,this.exportCols=[],this.disableExport=!0,this.quoteOrderSwitch=!1,this.formErrors={arrangementNumber:"",arrangementName:""},this.validationMessages={arrangementNumber:{required:"Arrangement Number is required"},arrangementName:{required:"Arrangement Name is required"}},this.swicthClickRecognizer=!1,this.hideColumnMenu=!0,this.showFilter=!1,this.paginationOptions={pageNumber:0,pageSize:"10000"},this.data=this.location.getState(),this.arrIdK=this.data.arrgId,this.router.events.subscribe(t=>{t instanceof f.c&&(this.arrIdK=t.url.split("/")[3])})}ngOnInit(){this.selectedDeals=[],this.globalCols=u,this.columns=[],this.getTableColumns("Deal Details","Deal Allocations"),this.buildForm()}getTableColumns(t,e){this.isSelectAllChecked=!0,this.commonSharedService.getConfiguredColDetails(t,e).then(t=>{if(t&&null!=t&&t.userId){const e=t.tableColumns.split("/"),i=e[0].split(","),o=e[1]?e[1].split(","):[];this.globalCols.forEach(t=>{t.showField=-1!==[...i,...o].indexOf(t.field)});const l=this.globalCols.filter(t=>!t.showField);i.forEach(t=>{const e=this.globalCols.find(e=>e.field===t);e&&this.scrollableCols.push(e)}),o.forEach(t=>{const e=this.globalCols.find(e=>e.field===t);e&&(e.isFrozen=!0,this.frozenCols.push(e))}),l.forEach(t=>{this.scrollableCols.push(t)}),this.globalCols=[...this.frozenCols,...this.scrollableCols],this.getFrozenWidth(),i.length+o.length!==this.globalCols.length&&(this.isSelectAllChecked=!1),this.showPaginator=i.length+o.length!==0,this.userId=t.userId}else this.recollectColumns()}).catch(()=>{this.notificationService.showError("Error occured while getting table columns data"),this.loading=!1})}saveColumns(){let t="",e="";this.isConfigOpened=!1,this.frozenCols.forEach((e,i)=>{e.showField&&(t+=e.field,i<this.frozenCols.length-1&&(t+=","))}),this.scrollableCols.forEach((t,i)=>{t.showField&&(e+=t.field,i<this.scrollableCols.length-1&&(e+=","))});const i=e+"/"+t;console.log(i),this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("Deal Details","Deal Allocations",i,this.userId).then(t=>{this.userId=t.userId,this.showPaginator=0!==this.columns.length,this.loading=!1}).catch(()=>{this.notificationService.showError("Error occured while getting data"),this.loading=!1})}onToggleFreeze(t){const e=this.globalCols.find(e=>e.field===t.field);e.isFrozen=!e.isFrozen,this.recollectColumns()}recollectColumns(){this.frozenCols=this.globalCols.filter(t=>t.isFrozen),this.scrollableCols=this.globalCols.filter(t=>!t.isFrozen),this.getFrozenWidth()}getFrozenWidth(){const t=this.frozenCols.filter(t=>t.showField);this.frozenWidth=(t.length?150*t.length:0)+"px",this.isTableFrozen=!!this.frozenCols&&!!this.frozenCols.length&&!!this.frozenCols.some(t=>!!t.showField)}selectColumns(){this.isSelectAllChecked=this.globalCols.filter(t=>!t.showField).length<=0,this.getFrozenWidth()}onSelectAll(){this.isSelectAllChecked=!this.isSelectAllChecked,this.globalCols.forEach(t=>{this.isSelectAllChecked?t.showField=!0:t.drag&&(t.showField=!1)})}onConfiguringColumns(){this.isConfigOpened=!0}closeConfigureColumns(){this.isConfigOpened=!1}exportExcel(){this.exportCols=[];for(let e=0;e<this.globalCols.length;e++)this.globalCols[e].showField&&this.exportCols.push(this.globalCols[e].field);let t=this.arrgContractAllocationsVService.getServiceUrl(this.paginationOptions,{dealArrangementId:this.arrIdK},1,this.exportCols,this.quoteOrderSwitch);window.location.href=t}OnReceiveChange(t){}reset(t){this.paginationOptions={},this.selectedDeals=[],this.arrgContractAllocationsV=new Ti,t.reset()}buildForm(){this.allocationsForm=this.formBuilder.group({arrangementNumber:["",[p.t.required]],arrangementName:["",[p.t.required]],unitSellingPrice:[""],undeliveredQty:[""]}),this.allocationsForm.valueChanges.subscribe(t=>this.onValueChanged(t)),this.onValueChanged()}onValueChanged(t){if(!this.allocationsForm)return;const e=this.allocationsForm;for(const i in this.formErrors){this.formErrors[i]="";const t=e.get(i);if(t&&t.dirty&&!t.valid){const e=this.validationMessages[i];for(const o in t.errors)this.formErrors[i]+=e[o]+" "}}}onQuoteOrderSwitch(){this.swicthClickRecognizer=!0,this.arrgContractAllocationsV=new Ti,this.getAllArrgContractAllocationsV()}getAllArrgContractAllocationsV(){this.swicthClickRecognizer||(this.loading=!0,this.dealArrgService.getDealArrangementBasis(this.arrIdK).then(t=>{this.revenueContractBasis=t,"SO"!==this.revenueContractBasis&&"PO"!==this.revenueContractBasis||(this.quoteOrderSwitch=!0)})),this.lineAmountTotal=0,this.vcTotal=0,this.allocableNetTotal=0,this.fvTotal=0,this.allocationTotal=0,this.allocationFcTotal=0,this.cvInOutAmountTotal=0,this.totalListAmount=0,this.espTotal=0,this.espInstTotal=0,this.statusTotal=null,this.allocStatusTotal=null,this.allocMarginStatusTotal=null,this.discountStatusTotal=null,this.commentsTotal=null,this.loading=!0,this.arrgContractAllocationsV.dealArrangementId=this.arrIdK,this.arrgContractAllocationsVService.getAllArrgContractAllocationsV(this.paginationOptions,this.arrgContractAllocationsV,this.exportCols,this.quoteOrderSwitch).then(t=>{this.datasource=t.content,this.arrgContractAllocationsVList=t.content,this.totalElements=t.totalElements,this.pageSize=t.size,this.getAllAllocationsTotal(),this.displaySearchDialog=!1,this.disableExport=!1}).catch(t=>{this.loading=!1,this.notificationService.showError("Network failed / service is down")})}getArrgContractAllocationsV(t){this.swicthClickRecognizer||(this.loading=!0,this.dealArrgService.getDealArrangementBasis(this.arrIdK).then(e=>{this.revenueContractBasis=e,"SO"!==this.revenueContractBasis&&"PO"!==this.revenueContractBasis||(this.quoteOrderSwitch=!0),this.paginationOptions={pageNumber:t.first/t.rows,pageSize:this.pageSize,sortField:t.sortField,sortOrder:t.sortOrder},this.loading=!0,this.arrgContractAllocationsV.dealArrangementId=this.arrIdK,this.arrgContractAllocationsVService.getAllArrgContractAllocationsV(this.paginationOptions,this.arrgContractAllocationsV,this.exportCols,this.quoteOrderSwitch).then(t=>{this.datasource=t.content,this.arrgContractAllocationsVList=t.content,this.totalElements=t.totalElements,this.pageSize=t.size,this.getAllAllocationsTotal()}).catch(t=>{this.loading=!1,this.notificationService.showError("Network failed / service is down")})}))}getAllAllocationsTotal(){this.arrgContractAllocationsVService.getAllAllocationsTotal(this.arrIdK,this.quoteOrderSwitch).then(t=>{this.lineAmountTotal=t.totalLineAmount,this.vcTotal=t.totalVCAmount,this.allocableNetTotal=t.totalAllocableNetPrice,this.fvTotal=t.totalSSPAmount,this.allocationTotal=t.totalAllocationAmount,this.allocationFcTotal=t.totalAllocationFcAmount,this.cvInOutAmountTotal=t.totalCvInOutAmount,this.totalListAmount=t.totalListAmount,this.espTotal=t.totalEsp,this.espInstTotal=t.totalEspinst,this.statusTotal=t.totalRevenueGuidanceAnalysis,this.allocStatusTotal=t.totalAllocationGuidanceAnalysis,this.allocMarginStatusTotal=t.totalAllocationMarginGuidanceAnalysis,this.discountStatusTotal=t.totalDiscountGuidanceAnalysis,this.commentsTotal=t.totalRevenueGuidanceDescription,this.totalRebate=t.totalRebate,this.totalGrossMargin=t.totalGrossMargin,this.totalAllocatedMarginAmount=t.totalAllocatedMarginAmount,this.loading=!1,this.disableExport=!1}).catch(t=>{this.loading=!1})}getProspDealsOnLoad(){this.loading=!0,this.arrgContractAllocationsVService.getAllProspectiveDealsTest(this.arrIdK,this.dealLinesList).subscribe(t=>{this.totalRecords=t.length,this.prospectiveDealListConst=t,this.prospectiveDealsList=t.slice(0,10);let e=0;this.prospectiveDealsList.forEach(t=>{t.contractStartDate&&(this.prospectiveDealsList[e].contractStartDate=new Date(t.contractStartDate)),t.contractEndDate&&(this.prospectiveDealsList[e].contractEndDate=new Date(t.contractEndDate)),t.serviceStartDate&&(this.prospectiveDealsList[e].serviceStartDate=new Date(t.serviceStartDate)),t.serviceEndDate&&(this.prospectiveDealsList[e].serviceEndDate=new Date(t.serviceEndDate)),e++}),this.loading=!1},t=>{this.loading=!1,this.notificationService.showError("Network failed / service is down")}),this.displayProspectiveDialog=!0}getProspectiveDeals(){if(null!=this.selectedDeals)if(this.selectedDeals.length>0){this.dealLinesList=[];for(let t=0;t<this.selectedDeals.length;t++)this.dealLinesList.push(this.selectedDeals[t].dealLineId)}else this.notificationService.showError("Select at least one deal Line to prospective");else this.notificationService.showError("Select at least one deal Line to prospective")}processTheProspectiveDeals(){this.arrgContractAllocationsVService.getValidArrangement(this.arrgNumber,this.arrgName).then(t=>{"Y"==t?this.notificationService.showError("Arrangement already exist"):"N"==t&&(this.loading=!0,this.arrgContractAllocationsVService.processProspectiveDeals(this.arrIdK,this.arrgNumber,this.arrgName,this.prospectiveDealsList).then(t=>{t?(this.getAllArrgContractAllocationsV(),this.displayProspectiveDialog=!1,this.notificationService.showSuccess("Sucessfully Processed.Created the arrangement"+this.arrgNumber)):(this.getAllArrgContractAllocationsV(),this.displayProspectiveDialog=!1,this.notificationService.showError("Failed to Process Prospective Deals are failed..!"))}).catch(t=>{this.loading=!1,this.displayProspectiveDialog=!1,this.notificationService.showError("Network failed / service is down")}))}),this.buildForm()}processRetrospectiveDeals(){this.loading=!0,this.arrgContractAllocationsVService.processRetrospectiveDeals(this.arrIdK).then(t=>{t?(this.getAllArrgContractAllocationsV(),this.notificationService.showSuccess("Sucessfully Retropective Process executed for  "+this.arrIdK+" Arrangement")):(this.getAllArrgContractAllocationsV(),this.notificationService.showError("Retropective Process is failed..!"))}).catch(t=>{this.loading=!1,this.notificationService.showError("Network failed / service is down")})}reallocation(){this.confirmationService.confirm({message:"Are you sure,Do you want to reallocate?",header:"Confirmation",icon:"",accept:()=>{this.arrgContractAllocationsVService.reallocation(this.arrIdK).then(t=>{this.getAllArrgContractAllocationsV()}),this.notificationService.showSuccess("Allocation Successfully done.")},reject:()=>{this.notificationService.showSuccess("You have rejected.")}})}showDialogToAdd(){this.newArrgContractAllocationsV=!0,this.arrgContractAllocationsV=new Ti,this.displayDialog=!0,this.buildForm()}save(){this.newArrgContractAllocationsV?(this.loading=!0,this.arrgContractAllocationsVService.saveArrgContractAllocationsV(this.arrgContractAllocationsV).then(t=>{this.getAllArrgContractAllocationsV()}).catch(t=>{this.loading=!1,this.notificationService.showError("Error occured while saving the data")})):(this.loading=!0,this.arrgContractAllocationsVService.updateArrgContractAllocationsV(this.arrgContractAllocationsV).then(t=>{this.getAllArrgContractAllocationsV()}).catch(t=>{this.loading=!1,this.notificationService.showError("Error occured while saving the data")})),this.arrgContractAllocationsV=new Ti,this.displayDialog=!1}delete(t){this.arrgContractAllocationsV=t,this.displayDialog=!1,window.confirm("Are you sure you want to delete this record?")&&(this.arrgContractAllocationsVList.splice(this.findSelectedArrgContractAllocationsVIndex(),1),this.loading=!0,this.arrgContractAllocationsVService.deleteArrgContractAllocationsV(this.arrgContractAllocationsV).then(t=>{this.arrgContractAllocationsV=new Ti,this.getAllArrgContractAllocationsV()}))}editRow(t){this.newArrgContractAllocationsV=!1,this.arrgContractAllocationsV=this.cloneArrgContractAllocationsV(t),this.displayDialog=!0}findSelectedArrgContractAllocationsVIndex(){return this.arrgContractAllocationsVList.indexOf(this.selectedArrgContractAllocationsV)}onRowSelect(t){this.arrgContractAllocationsVList.forEach(e=>{(Math.trunc(e.dealLineNumber)==Math.trunc(t.data.dealLineNumber)&&e.dealLineNumber!=t.data.dealLineNumber||e.parentLineId==t.data.dealLineNumber||e.dealLineNumber==t.data.parentLineId||null!=e.parentLineId&&e.parentLineId==t.data.parentLineId)&&(null!=this.selectedDeals?this.selectedDeals.length>0?this.selectedDeals[this.selectedDeals.length]=e:this.selectedDeals[0]=e:(this.selectedDeals=[],this.selectedDeals[0]=e))})}onRowUnselect(t){this.arrgContractAllocationsVList.forEach(e=>{(Math.trunc(e.dealLineNumber)==Math.trunc(t.data.dealLineNumber)||e.parentLineId==t.data.dealLineNumber||e.dealLineNumber==t.data.parentLineId||null!=e.parentLineId&&e.parentLineId==t.data.parentLineId)&&this.selectedDeals.splice(this.selectedDeals.indexOf(e),1)})}cloneArrgContractAllocationsV(t){let e=new Ti;for(let i in t)e[i]=t[i];return e}toggleColumnMenu(){this.hideColumnMenu=!this.hideColumnMenu}toggleFilterBox(){this.showFilter=!this.showFilter}showDialogToSearch(){this.arrgContractAllocationsVSearch=new Ti,0==this.isSerached&&(this.arrgContractAllocationsVSearch=new Ti),this.displaySearchDialog=!0}search(){this.isSerached=1,this.arrgContractAllocationsV=this.arrgContractAllocationsVSearch,this.getAllArrgContractAllocationsV()}onBeforeToggle(t){this.collapsed=t.collapsed}ProspectiveAnalysis(){if(this.prospectiveDealsList=[],this.arrgName="",this.arrgNumber="",null!=this.selectedDeals)if(this.selectedDeals.length>0){this.dealLinesList=[];for(let t=0;t<this.selectedDeals.length;t++)this.dealLinesList.push(this.selectedDeals[t].dealLineId);this.prospectiveDealsList=[],this.getProspDealsOnLoad()}else this.notificationService.showWarning("No deals Lines Selected to Prospective..!");else this.notificationService.showError("Select atleast one deal Line to Prospective..!")}paginate(t){this.loading=!0,this.prospectiveDealsList=this.prospectiveDealListConst.slice(t.first,t.first+10),this.loading=!1}executeRetrospectiveProcess(){this.confirmationService.confirm({message:"Are you sure you want to retrospective process for this arrangement?",header:"Confirmation",icon:"",accept:()=>{this.processRetrospectiveDeals(),this.notificationService.showInfo("You have accepted")},reject:()=>{this.notificationService.showInfo("You have rejected")}})}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(a.i),a.Pb(me.a),a.Pb(f.g),a.Pb(V.a),a.Pb(p.c),a.Pb(c.a),a.Pb(n.a),a.Pb(o.f),a.Pb(Ce.a),a.Pb(o.k))},t.\u0275cmp=a.Jb({type:t,selectors:[["app-deal-allocations"]],inputs:{arrId:"arrId"},decls:13,vars:19,consts:[[1,"content-section","implementation"],["width","425"],[3,"onBeforeToggle"],["class","pull-right icons-list",4,"ngIf"],["id","alloc-dt","columnResizeMode","expand",1,"ui-datatable","arrangementMgrTbl","wide-columns",3,"loading","columns","frozenColumns","frozenWidth","scrollable","value","lazy","paginator","rows","totalRecords","resizableColumns","onLazyLoad"],["dt",""],["pTemplate","colgroup"],[4,"ngFor","ngForOf"],["pTemplate","emptymessage"],[1,"pull-right","icons-list"],[3,"frozenCols","scrollableCols","isSelectAllChecked","showConfigPopup","openConfig","closeConfig","saveConfig","toggleFreeze","selectColumn","selectAll"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],[4,"ngIf"],["title","Export",3,"click"],[1,"fa","fa-external-link"],[3,"pTemplate"],["pResizableColumn","",3,"ngStyle","title"],[3,"title","ngStyle",4,"ngIf"],[3,"title","ngStyle"],["aria-hidden","true",1,"fa","fa-circle","red-color"],["aria-hidden","true",1,"fa","fa-circle","green-color"],["aria-hidden","true",1,"fa","fa-circle","yellow-color"],[1,"table-footer","right-align"],["class","text",4,"ngIf"],[1,"text"],[1,"no-results-data"]],template:function(t,e){1&t&&(a.Qb(0,"div",0),a.Qb(1,"p-confirmDialog",1),a.Vb(2,"p-panel",2),a.dc("onBeforeToggle",(function(t){return e.onBeforeToggle(t)})),a.Vb(3,"p-header"),a.Kc(4,we,5,5,"div",3),a.Ub(),a.Vb(5,"div"),a.Vb(6,"p-table",4,5),a.dc("onLazyLoad",(function(t){return e.getArrgContractAllocationsV(t)})),a.Kc(8,Fe,2,1,"ng-template",6),a.Kc(9,Ie,2,1,"ng-container",7),a.Kc(10,je,2,1,"ng-container",7),a.Kc(11,Ui,2,1,"ng-container",7),a.Kc(12,Mi,3,1,"ng-template",8),a.Ub(),a.Ub(),a.Ub()),2&t&&(a.Eb(4),a.oc("ngIf",e.collapsed),a.Eb(2),a.Gb(a.sc(17,Ii,!e.isTableFrozen)),a.oc("loading",e.loading)("columns",e.scrollableCols)("frozenColumns",e.frozenCols)("frozenWidth",e.frozenWidth)("scrollable",!0)("value",e.arrgContractAllocationsVList)("lazy",!0)("paginator",e.showPaginator)("rows",e.pageSize)("totalRecords",e.totalElements)("resizableColumns",!0),a.Eb(3),a.oc("ngForOf",e.tableHeaderTmpl),a.Eb(1),a.oc("ngForOf",e.tableBodyTmpl),a.Eb(1),a.oc("ngForOf",e.tableFooterTmpl))},directives:[ye.a,Se.a,V.c,o.o,A.j,V.f,o.n,Vt,A.g,o.p],pipes:[o.f,D.a,o.g],encapsulation:2}),t})();class Ti{constructor(t,e,i,o,l,n,c,s,a,r,d,h,g,b,u,f,p,m,C,y,S,v,w,E,V,F,A,D,U,M,I,z,T,x,O,P,k,K,L,$,N,R,Q){this.dealLineId=t,this.quantity=e,this.elementType=i,this.allocationAmount=o,this.parentLineNumber=l,this.totalCost=n,this.dealCurrencyCode=c,this.unitSellingPrice=s,this.unitListPrice=a,this.fmvCategory=r,this.cvInOutAmount=d,this.bundleAttribitionList=h,this.dealNumber=g,this.lineAmount=b,this.repCurrCode=u,this.fmvRuleName=f,this.pobGrouping=p,this.dealLineNumber=m,this.productGroup=C,this.fmvMin=y,this.fmvMean=S,this.fmvAmount=v,this.dealHeaderId=w,this.solution=E,this.parentLineId=V,this.productName=F,this.dealArrangementId=A,this.trxCurrencyCode=D,this.accountingScope=U,this.productType=M,this.fmvMax=I,this.accountingStandard=z,this.uomCode=T,this.allocationInclusive=x,this.bundleAttribitionNet=O,this.bundleFlag=P,this.fmvType=k,this.vc=K,this.arrgLineNumber=L,this.allocableAmount=$,this.sspLow=N,this.sspHigh=R,this.netPriceDiscount=Q}}class xi{constructor(t,e,i,o,l,n,c,s,a,r,d,h,g,b,u,f,p,m){this.dealArrangmentId=t,this.quantity=e,this.unitListPrice=i,this.unitSellingPrice=o,this.dealNumber=l,this.dealLineNumber=n,this.productName=c,this.uomCode=s,this.dealCurrencyCode=a,this.conversionRate=r,this.contractStartDate=d,this.contractEndDate=h,this.serviceStartDate=g,this.serviceEndDate=b,this.dealLineId=u,this.undeliveredQty=f,this.undQty=p,this.ssp=m}}var Oi=i("OBQ6");function Pi(t,e){1&t&&a.Qb(0,"col")}function ki(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Pi,1,0,"col",13),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Ki(t,e){if(1&t&&(a.Vb(0,"colgroup"),a.Kc(1,ki,2,1,"ng-container",11),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}function Li(t,e){if(1&t&&(a.Vb(0,"th"),a.Mc(1),a.Ub()),2&t){const t=a.gc().$implicit;a.Ic(t.style),a.Eb(1),a.Oc(" ","Net Price"===t.header?"Bookings Value":t.header," ")}}function $i(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Li,2,3,"th",15),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Ni(t,e){if(1&t&&(a.Vb(0,"tr"),a.Kc(1,$i,2,1,"ng-container",11),a.Ub()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngForOf",t)}}function Ri(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Ni,2,1,"ng-template",14),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}function Qi(t,e){if(1&t&&(a.Vb(0,"td"),a.Vb(1,"span",17),a.Mc(2),a.hc(3,"number"),a.Ub(),a.Ub()),2&t){const t=a.gc().$implicit,e=a.gc().$implicit;a.Ic(t.style),a.Eb(1),a.pc("title",e[t.field]),a.Eb(1),a.Oc("","number"==t.type?a.jc(3,4,e[t.field],"1.2-2"):e[t.field]," ")}}function _i(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Qi,4,7,"td",15),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("ngIf",t.showField)}}function Gi(t,e){if(1&t&&(a.Vb(0,"tr",16),a.Kc(1,_i,2,1,"ng-container",11),a.Ub()),2&t){const t=e.columns;a.oc("pSelectableRow",e.$implicit),a.Eb(1),a.oc("ngForOf",t)}}function ji(t,e){if(1&t&&(a.Tb(0),a.Kc(1,Gi,2,2,"ng-template",14),a.Sb()),2&t){const t=e.$implicit;a.Eb(1),a.oc("pTemplate",t)}}function Wi(t,e){if(1&t&&(a.Vb(0,"div",18),a.Vb(1,"p"),a.Mc(2),a.Ub(),a.Ub()),2&t){const t=a.gc();a.Eb(2),a.Nc(t.noData)}}const Bi=function(){return{"margin-bottom":"20px"}},qi=function(t){return{unfrozen:t}};let Hi=(()=>{class t{constructor(t,e,i,o){this.rmanDealRfcstVService=t,this.router=e,this.notificationService=i,this.commonSharedService=o,this.rmanDealRfcstV=new Yi,this.isSerached=0,this.globalCols=[],this.frozenCols=[],this.scrollableCols=[],this.tableHeaderTmpl=["header","frozenheader"],this.tableBodyTmpl=["body","frozenbody"],this.isTableFrozen=!1,this.noData=s.noData,this.paginationOptions={},this.isSelectAllChecked=!0,this.isConfigOpened=!1,this.showPaginator=!0,this.paginationOptions={pageNumber:0,pageSize:10},this.router.events.subscribe(t=>{t instanceof f.c&&(this.arrIdK=t.url.split("/")[3])})}ngOnInit(){this.getDealForecastingView()}reset(t){t.reset(),this.paginationOptions={},this.rmanDealRfcstV=new Yi,this.getDealForecastingView()}exportExcel(){let t=this.rmanDealRfcstVService.getServiceUrl(this.paginationOptions,{arrangementId:this.arrIdK},1);window.location.href=t}getDealForecastingView(){this.loading=!0,this.rmanDealRfcstVService.getRmanForecastView(this.arrIdK).then(t=>{this.rDealFCSTViewList=t.Content,this.loading=!1;let e=this.rDealFCSTViewList[0];for(let i in e)["Element Type"].includes(i)?this.globalCols.push({field:i,header:i,drag:!0,showField:!0,style:{width:"100px","text-align":this.setColAlignment(i)},hide:!1}):["Arrangement Number","SKU"].includes(i)||["Expected Booking Amount"].includes(i)?this.globalCols.push({field:i,header:i,drag:!0,showField:!0,style:{width:"180px","text-align":this.setColAlignment(i)},hide:!1}):this.globalCols.push({field:i,header:i,drag:!0,showField:!0,style:{width:"100px","text-align":this.setColAlignment(i)},hide:!1});this.getTableColumns("Deal Details","Deal Forecasting"),this.rDealFCSTViewList=t.Content,this.totalRecords=this.rDealFCSTViewList.length}).catch(t=>{this.loading=!1,this.notificationService.showError("Error occured while getting data")})}setColAlignment(t){return["Line No","Ayara Line Id","Quote Line Id","Product Name"].some(e=>e===t)?"left":"right"}getTableColumns(t,e){this.isSelectAllChecked=!0,this.commonSharedService.getConfiguredColDetails(t,e).then(t=>{if(t&&null!=t&&t.userId){const e=t.tableColumns.split("/"),i=e[0].split(","),o=e[1]?e[1].split(","):[];this.globalCols.forEach(t=>{t.showField=-1!==[...i,...o].indexOf(t.field)});const l=this.globalCols.filter(t=>!t.showField);i.forEach(t=>{const e=this.globalCols.find(e=>e.field===t);e&&this.scrollableCols.push(e)}),o.forEach(t=>{const e=this.globalCols.find(e=>e.field===t);e&&(e.isFrozen=!0,this.frozenCols.push(e))}),l.forEach(t=>{this.scrollableCols.push(t)}),this.globalCols=[...this.frozenCols,...this.scrollableCols],this.getFrozenWidth(),i.length+o.length!==this.globalCols.length&&(this.isSelectAllChecked=!1),this.showPaginator=i.length+o.length!==0,this.userId=t.userId}else this.recollectColumns()}).catch(()=>{this.notificationService.showError("Error occured while getting table columns data"),this.loading=!1})}onConfiguringColumns(){this.isConfigOpened=!0}onToggleFreeze(t){const e=this.globalCols.find(e=>e.field===t.field);e.isFrozen=!e.isFrozen,this.recollectColumns()}recollectColumns(){this.frozenCols=this.globalCols.filter(t=>t.isFrozen),this.scrollableCols=this.globalCols.filter(t=>!t.isFrozen),this.getFrozenWidth()}getFrozenWidth(){const t=this.frozenCols.filter(t=>t.showField);this.frozenWidth=(t.length?150*t.length:0)+"px",this.isTableFrozen=!!this.frozenCols&&!!this.frozenCols.length&&!!this.frozenCols.some(t=>!!t.showField)}selectColumns(){this.isSelectAllChecked=this.globalCols.filter(t=>!t.showField).length<=0,this.getFrozenWidth()}onSelectAll(){this.isSelectAllChecked=!this.isSelectAllChecked,this.globalCols.forEach(t=>{this.isSelectAllChecked?t.showField=!0:t.drag&&(t.showField=!1)})}closeConfigureColumns(){this.isConfigOpened=!1}saveColumns(){let t="",e="";this.isConfigOpened=!1,this.frozenCols.forEach((e,i)=>{e.showField&&(t+=e.field,i<this.frozenCols.length-1&&(t+=","))}),this.scrollableCols.forEach((t,i)=>{t.showField&&(e+=t.field,i<this.scrollableCols.length-1&&(e+=","))});const i=e+"/"+t;this.loading=!0,this.commonSharedService.saveOrUpdateTableColumns("Deal Details","Deal Forecasting",i,this.userId).then(t=>{this.userId=t.userId,this.loading=!1}).catch(()=>{this.notificationService.showError("Error occured while getting data"),this.loading=!1})}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(Oi.a),a.Pb(f.g),a.Pb(n.a),a.Pb(c.a))},t.\u0275cmp=a.Jb({type:t,selectors:[["app-deal-forecasting"]],decls:16,vars:21,consts:[[1,"content-section","implementation"],[1,"pull-right","icons-list"],[3,"frozenCols","scrollableCols","isSelectAllChecked","showConfigPopup","openConfig","closeConfig","saveConfig","toggleFreeze","selectColumn","selectAll"],["title","Reset",3,"click"],[1,"fa","fa-refresh"],["title","Export",3,"click"],[1,"fa","fa-external-link"],[1,"x-scroll"],["selectionMode","single","scrollable","true","scrollHeight","500px","exportFilename","RmanDealRfcstV",1,"ui-datatable","arrangementMgrTbl","wide-columns",3,"columns","frozenColumns","frozenWidth","loading","value","paginator","rows","totalRecords"],["dt",""],["pTemplate","colgroup"],[4,"ngFor","ngForOf"],["pTemplate","emptymessage"],[4,"ngIf"],[3,"pTemplate"],[3,"style",4,"ngIf"],[3,"pSelectableRow"],[3,"title"],[1,"no-results-data"]],template:function(t,e){if(1&t){const t=a.Wb();a.Qb(0,"div",0),a.Vb(1,"p-panel"),a.Vb(2,"p-header"),a.Vb(3,"div",1),a.Vb(4,"app-columns-config",2),a.dc("openConfig",(function(){return e.onConfiguringColumns()}))("closeConfig",(function(){return e.closeConfigureColumns()}))("saveConfig",(function(){return e.saveColumns()}))("toggleFreeze",(function(t){return e.onToggleFreeze(t)}))("selectColumn",(function(){return e.selectColumns()}))("selectAll",(function(){return e.onSelectAll()})),a.Ub(),a.Vb(5,"a",3),a.dc("click",(function(){a.Dc(t);const i=a.Bc(11);return e.reset(i)})),a.Qb(6,"em",4),a.Ub(),a.Vb(7,"a",5),a.dc("click",(function(){return a.Dc(t),a.Bc(11).exportCSV()})),a.Qb(8,"em",6),a.Ub(),a.Ub(),a.Ub(),a.Vb(9,"div",7),a.Vb(10,"p-table",8,9),a.Kc(12,Ki,2,1,"ng-template",10),a.Kc(13,Ri,2,1,"ng-container",11),a.Kc(14,ji,2,1,"ng-container",11),a.Kc(15,Wi,3,1,"ng-template",12),a.Ub(),a.Ub(),a.Ub()}2&t&&(a.Eb(1),a.Ic(a.rc(18,Bi)),a.Eb(3),a.oc("frozenCols",e.frozenCols)("scrollableCols",e.scrollableCols)("isSelectAllChecked",e.isSelectAllChecked)("showConfigPopup",e.isConfigOpened),a.Eb(6),a.Gb(a.sc(19,qi,!e.isTableFrozen)),a.oc("columns",e.scrollableCols)("frozenColumns",e.frozenCols)("frozenWidth",e.frozenWidth)("loading",e.loading)("value",e.rDealFCSTViewList)("paginator",!0)("rows",10)("totalRecords",e.totalRecords),a.Eb(3),a.oc("ngForOf",e.tableHeaderTmpl),a.Eb(1),a.oc("ngForOf",e.tableBodyTmpl))},directives:[Se.a,V.c,Vt,A.j,V.f,o.n,o.o,A.i],pipes:[o.g],encapsulation:2}),t})();class Yi{constructor(t,e,i,o,l,n,c,s,a,r){this.glPeriod=t,this.expectedBookingAmount=e,this.amount=i,this.qty=o,this.netPrice=l,this.elementType=n,this.startDate=c,this.arrangementName=s,this.sku=a,this.arrangementId=r}}var Ji=i("nYR2"),Xi=i("zFJ7");function Zi(t,e){1&t&&(a.Vb(0,"tr"),a.Vb(1,"th",16),a.Mc(2," User "),a.Ub(),a.Vb(3,"th",16),a.Mc(4," Date & Time "),a.Ub(),a.Vb(5,"th",17),a.Mc(6," Comment "),a.Ub(),a.Ub())}function to(t,e){if(1&t&&(a.Vb(0,"tr"),a.Vb(1,"td",18),a.Mc(2),a.Ub(),a.Vb(3,"td",18),a.Mc(4),a.hc(5,"date"),a.Ub(),a.Vb(6,"td"),a.Mc(7),a.Ub(),a.Ub()),2&t){const t=e.$implicit;a.Eb(2),a.Oc(" ",t.userName," "),a.Eb(2),a.Oc(" ",a.jc(5,3,t.creationDate,"MM/dd/yyyy hh:mm")," "),a.Eb(3),a.Oc(" ",t.userComment," ")}}function eo(t,e){1&t&&(a.Vb(0,"tr"),a.Vb(1,"td",19),a.Mc(2,"No Data"),a.Ub(),a.Ub())}function io(t,e){if(1&t){const t=a.Wb();a.Vb(0,"div",11),a.Vb(1,"p-table",12),a.dc("onLazyLoad",(function(e){return a.Dc(t),a.gc().getDealComments(e)})),a.Kc(2,Zi,7,0,"ng-template",13),a.Kc(3,to,8,6,"ng-template",14),a.Kc(4,eo,3,0,"ng-template",15),a.Ub(),a.Ub()}if(2&t){const t=e.ngIf,i=a.gc();a.Eb(1),a.oc("resizableColumns",!0)("value",t.comments)("loading",i.isLoading)("paginator",!0)("rows",5)("totalRecords",i.totalElements)}}const oo=function(){return{"margin-bottom":"20px"}},lo=function(t){return{comments:t}},no=[{path:"",component:bt},{path:"details/:dealId/:dealNumber",component:ft,children:[{path:"summary",component:pe},{path:"summary/comments",component:(()=>{class t{constructor(t,e,i){this.dealsService=t,this.route=e,this.notificationService=i,this.isLoading=!1,this.inputComment=""}ngOnInit(){this.dealId=this.route.snapshot.parent.paramMap.get("dealId"),this.getDealComments()}getDealComments(t){const e=t?t.first/t.rows:0;this.isLoading=!0,this.commentsData$=this.dealsService.getDealComments(this.dealId,e).pipe(Object(h.a)(t=>this.totalElements=t.totalElements),Object(pt.a)(t=>t.content),Object(Ji.a)(()=>{this.isLoading=!1}))}onAdd(){this.dealsService.addDealComment({dealArrangementId:this.dealId,userComment:this.inputComment}).subscribe(()=>{this.notificationService.showSuccess("Saved successfully"),this.getDealComments(),this.inputComment=""},t=>this.notificationService.showError(t.message))}}return t.\u0275fac=function(e){return new(e||t)(a.Pb(d),a.Pb(f.a),a.Pb(n.a))},t.\u0275cmp=a.Jb({type:t,selectors:[["app-deal-comments"]],decls:13,vars:10,consts:[[1,"comments__form"],[3,"ngSubmit"],["commentForm","ngForm"],["pInputTextarea","","id","comment","name","comment","required","","placeholder","Type Comment",3,"ngModel","ngModelChange"],["type","submit",1,"add-btn",3,"disabled"],[1,"fa","fa-paper-plane"],["header","Comments History"],[1,"pull-right","icons-list"],["routerLink","../"],[1,"fa","fa-share"],["class","x-scroll",4,"ngIf"],[1,"x-scroll"],["lazy","true","scrollable","true",1,"arrangementMgrTbl","comments-table",3,"resizableColumns","value","loading","paginator","rows","totalRecords","onLazyLoad"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["pResizableColumn","",1,"small-col"],["pResizableColumn",""],[1,"small-col"],[1,"no-data"]],template:function(t,e){if(1&t&&(a.Vb(0,"div",0),a.Vb(1,"form",1,2),a.dc("ngSubmit",(function(){return e.onAdd()})),a.Vb(3,"textarea",3),a.dc("ngModelChange",(function(t){return e.inputComment=t})),a.Ub(),a.Vb(4,"button",4),a.Qb(5,"em",5),a.Ub(),a.Ub(),a.Ub(),a.Vb(6,"p-panel",6),a.Vb(7,"p-header"),a.Vb(8,"div",7),a.Vb(9,"a",8),a.Qb(10,"em",9),a.Ub(),a.Ub(),a.Ub(),a.Kc(11,io,5,6,"div",10),a.hc(12,"async"),a.Ub()),2&t){const t=a.Bc(2);a.Eb(3),a.oc("ngModel",e.inputComment),a.Eb(1),a.oc("disabled",!t.form.valid),a.Eb(2),a.Ic(a.rc(7,oo)),a.Eb(5),a.oc("ngIf",a.sc(8,lo,a.ic(12,5,e.commentsData$)))}},directives:[p.v,p.l,p.m,p.b,Xi.a,p.s,p.k,p.n,Se.a,V.c,f.j,o.o,A.j,V.f,A.g],pipes:[o.b,o.f],styles:[".arrangementMgrTbl.comments-table tr td{width:100%!important;white-space:pre-wrap!important}.arrangementMgrTbl.comments-table .small-col{width:200px!important}.fa-paper-plane{transform:scale(2)}.fa-share{transform:rotateY(180deg)}.comments__list{margin-top:40px}.comments__list-item{display:flex;list-style:none}.comments__form form{display:flex;align-items:center;max-width:1100px;width:100%;margin:40px auto 20px}.comments__form form textarea{border:2px solid #262d74;border-radius:6px;flex:1}.comments__form form .add-btn{cursor:pointer;margin:0 0 0 20px;height:auto!important;background:none}.comments__form form .add-btn em{color:#262b74}.comments__form form .add-btn:hover{opacity:.7}.comments__form form .add-btn[disabled]{cursor:not-allowed;opacity:.7}.comments__form form .add-btn[disabled] em{color:#1fac90}.comment__user{margin-right:5px;color:#262b74;font-weight:700}.comment__content{margin-right:5px;color:#000}"],encapsulation:2}),t})()},{path:"allocations",component:zi},{path:"forecasting",component:Hi}]}];let co=(()=>{class t{}return t.\u0275mod=a.Nb({type:t}),t.\u0275inj=a.Mb({factory:function(e){return new(e||t)},providers:[d,me.a,V.a,Ce.a,Oi.a],imports:[[f.k.forChild(no),o.c,ut.a]]}),t})()},azuL:function(t,e,i){"use strict";i.d(e,"a",(function(){return a}));var o=i("FpCA"),l=i("fXoL"),n=i("ofXK"),c=i("+DzE");function s(t,e){1&t&&l.Qb(0,"p-progressBar",1)}let a=(()=>{class t{constructor(t){this._uploadService=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(l.Pb(o.a))},t.\u0275cmp=l.Jb({type:t,selectors:[["progress-bar"]],decls:1,vars:1,consts:[["id","infinite-progress","mode","indeterminate",4,"ngIf"],["id","infinite-progress","mode","indeterminate"]],template:function(t,e){1&t&&l.Kc(0,s,1,0,"p-progressBar",0),2&t&&l.oc("ngIf",e._uploadService.uploadLoading)},directives:[n.o,c.a],encapsulation:2}),t})()}}]);