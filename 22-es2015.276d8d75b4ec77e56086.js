(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{"/2n1":function(e,t,a){"use strict";a.r(t),a.d(t,"DealDashboardModule",(function(){return H}));var r=a("ofXK"),i=a("QIUk"),o=a("arFO"),n=a("3Pt+"),s=a("vKg+"),c=a("8DrR"),l=a("tk/3"),d=a("tyNb"),h=a("kzDL"),u=a("/8oK"),p=a("uwUq"),b=a("gJyg"),g=a("1adA"),m=a("J7oY"),f=a("fXoL");const v=a("+yMW"),D={headers:new l.f({"Content-Type":"application/json"})};let y=(()=>{class e{constructor(e){this.http=e,this.reportUrls={dealGuidanceReport:"/reports/dealGuidanceReport",dealsByQuarter:"/reports/dealsByQuarter",allocatedMarginGuidancePercentByAllocatedGMGuidance:"/reports/allocatedMarginGuidancePercentByAllocatedGMGuidance",allocatedMarginGuidanceDeals:"/reports/allocatedMarginGuidanceDeals",allocatedMarginPercentByProduct:"/reports/allocatedMarginPercentByProduct",allocationAmtByRegion:"/reports/allocationAmtByRegion",allocationAmtByPeriod:"/reports/allocationAmtByPeriod",allocationAmtByAccount:"/reports/allocationAmtByAccount",allocationAmtByProductCategory:"/reports/allocationAmtByProductCategory",allocationGuidanceDeals:"/reports/allocationGuidanceDeals",allocationMarginPercentByAllocationGuidance:"/reports/allocationMarginPercentByAllocationGuidance",discountGuidanceDeals:"/reports/discountGuidanceDeals",discountPercentByDiscountGuidance:"/reports/discountPercentByDiscountGuidance",allocatedmarginPercentByRegion:"/reports/allocatedmarginPercentByRegion",allocatedmarginPercentByAccount:"/reports/allocatedmarginPercentByAccount",allocatedmarginPercentByProductCategory:"/reports/allocatedmarginPercentByProductCategory"},this.otherUrls={getListOfReports:"/ayaraDealDashboardReports?search=%25page=0&size=100"}}saveDashboardReportsLayout(e){return this.http.post(v.apiUrl+"/saveayaraDealDashboardReports",e,D).toPromise().then(e=>e,e=>{console.log(e)})}getOverviewFigures(e,t,a,r){return void 0===e&&(e=""),void 0===t&&(t=""),void 0===a&&(a=""),void 0===r&&(r=""),!a&&r&&(a=r),this.http.get(v.apiUrl+"/dealDashBoardOverView?periodType="+t+"&period="+a+"&fiscalYear="+e).toPromise().then(e=>e)}getListOfReports(){return this.http.get(v.apiUrl+this.otherUrls.getListOfReports)}dealGuidanceReport(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.dealGuidanceReport+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}dealsByQuarter(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.dealsByQuarter+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocatedMarginGuidancePercentByAllocatedGMGuidance(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocatedMarginGuidancePercentByAllocatedGMGuidance+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocatedMarginGuidanceDeals(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocatedMarginGuidanceDeals+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocatedMarginPercentByProduct(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocatedMarginPercentByProduct+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocationAmtByRegion(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocationAmtByRegion+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocationAmtByPeriod(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocationAmtByPeriod+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocationAmtByAccount(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocationAmtByAccount+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocationAmtByProductCategory(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocationAmtByProductCategory+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocationGuidanceDeals(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocationGuidanceDeals+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocationMarginPercentByAllocationGuidance(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocationMarginPercentByAllocationGuidance+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}discountGuidanceDeals(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.discountGuidanceDeals+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}discountPercentByDiscountGuidance(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.discountPercentByDiscountGuidance+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocatedmarginPercentByRegion(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocatedmarginPercentByRegion+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocatedmarginPercentByAccount(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocatedmarginPercentByAccount+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}allocatedmarginPercentByProductCategory(e,t,a){return this.http.get(v.apiUrl+this.reportUrls.allocatedmarginPercentByProductCategory+"?periodType="+t+"&period="+a+"&fiscalYear="+e)}}return e.\u0275fac=function(t){return new(t||e)(f.Zb(l.b))},e.\u0275prov=f.Lb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=a("JSOo"),M=a("LPYB");const P=["dataChart"],C=function(){return{standalone:!0}};function U(e,t){if(1&e){const e=f.Wb();f.Vb(0,"p-dropdown",15),f.dc("ngModelChange",(function(t){return f.Dc(e),f.gc().rmanPeriod=t}))("onChange",(function(){return f.Dc(e),f.gc().onPeriodsChange()})),f.Ub()}if(2&e){const e=f.gc();f.oc("options",e.rmanPeriods)("ngModel",e.rmanPeriod)("ngModelOptions",f.rc(4,C))("filter",!1)}}function R(e,t){if(1&e){const e=f.Wb();f.Vb(0,"p-dropdown",16),f.dc("ngModelChange",(function(t){return f.Dc(e),f.gc().rmanQuarter=t}))("onChange",(function(){return f.Dc(e),f.gc().onPeriodsChange()})),f.Ub()}if(2&e){const e=f.gc();f.oc("options",e.rmanQuarters)("ngModel",e.rmanQuarter)("ngModelOptions",f.rc(4,C))("filter",!1)}}function G(e,t){1&e&&(f.Vb(0,"h6",17),f.Mc(1,"No data found"),f.Ub())}function A(e,t){1&e&&(f.Vb(0,"h6"),f.Mc(1,"\xa0"),f.Ub())}function B(e,t){1&e&&(f.Vb(0,"h6"),f.Mc(1,"\xa0"),f.Ub())}function O(e,t){1&e&&(f.Vb(0,"h6"),f.Mc(1,"\xa0"),f.Ub())}function V(e,t){if(1&e&&f.Kc(0,O,2,0,"h6",23),2&e){const e=f.gc(2);f.oc("ngIf",0===(null==e.overviewFigures.dealGuidance?null:e.overviewFigures.dealGuidance.length)||!e.overviewFigures.dealGuidance)}}function x(e,t){if(1&e){const e=f.Wb();f.Vb(0,"h6"),f.Vb(1,"a",29),f.dc("click",(function(){f.Dc(e);const a=t.$implicit;return f.gc(2).gotoPage(a)})),f.Mc(2),f.Ub(),f.Ub()}if(2&e){const e=t.$implicit,a=f.gc(2);f.Eb(1),f.Jc("color",e.guidance),f.Eb(1),f.Pc("",e.guidance," - ",a.transformValues(e.noOfGuidance),"")}}function S(e,t){if(1&e&&(f.Vb(0,"span",18),f.Vb(1,"div",19),f.Vb(2,"div",20),f.Vb(3,"p",21),f.Mc(4,"Cumulative Deal Value"),f.Ub(),f.Vb(5,"h6"),f.Mc(6,"\xa0"),f.Ub(),f.Vb(7,"h6"),f.Mc(8),f.hc(9,"number"),f.Ub(),f.Ub(),f.Ub(),f.Vb(10,"div",19),f.Vb(11,"div",20),f.Vb(12,"p",21),f.Mc(13,"Count of Deals"),f.Ub(),f.Vb(14,"h6"),f.Mc(15,"\xa0"),f.Ub(),f.Vb(16,"h6"),f.Mc(17),f.Ub(),f.Ub(),f.Ub(),f.Vb(18,"div",19),f.Vb(19,"div",20),f.Vb(20,"p",21),f.Mc(21,"Count of Quotes"),f.Ub(),f.Vb(22,"h6"),f.Mc(23,"\xa0"),f.Ub(),f.Vb(24,"h6"),f.Mc(25),f.Ub(),f.Ub(),f.Ub(),f.Vb(26,"div",19),f.Vb(27,"div",22),f.Vb(28,"p",21),f.Mc(29,"Deal Guidance"),f.Ub(),f.Kc(30,A,2,0,"h6",23),f.Kc(31,B,2,0,"h6",24),f.Kc(32,V,1,1,"ng-template",null,25,f.Lc),f.Vb(34,"div",26),f.Kc(35,x,3,4,"h6",27),f.Ub(),f.Ub(),f.Ub(),f.Vb(36,"div",19),f.Vb(37,"div",20),f.Vb(38,"p",21),f.Mc(39,"Cumulative Allocated Margin"),f.Ub(),f.Vb(40,"h6"),f.Mc(41),f.hc(42,"number"),f.Ub(),f.Vb(43,"h6"),f.Mc(44),f.Ub(),f.Ub(),f.Ub(),f.Vb(45,"div",28),f.Vb(46,"div",20),f.Vb(47,"p",21),f.Mc(48,"Cumulative Gross Margin"),f.Ub(),f.Vb(49,"h6"),f.Mc(50),f.hc(51,"number"),f.Ub(),f.Vb(52,"h6"),f.Mc(53),f.Ub(),f.Ub(),f.Ub(),f.Ub()),2&e){const e=f.Bc(33),t=f.gc();f.Eb(8),f.Oc("$ ",f.jc(9,15,t.transformValues(t.overviewFigures.totalDealValue),"1.0-2"),""),f.Eb(9),f.Oc(" ",t.transformValues(t.overviewFigures.noOfDeals),""),f.Eb(8),f.Oc(" ",t.transformValues(t.overviewFigures.noOfQuotes),""),f.Eb(5),f.oc("ngIf",0===(null==t.overviewFigures.dealGuidance?null:t.overviewFigures.dealGuidance.length)||!t.overviewFigures.dealGuidance),f.Eb(1),f.oc("ngIf",1===(null==t.overviewFigures.dealGuidance?null:t.overviewFigures.dealGuidance.length)||!t.overviewFigures.dealGuidance)("ngIfElse",e),f.Eb(4),f.oc("ngForOf",t.overviewFigures.dealGuidance),f.Eb(6),f.Oc("$ ",f.jc(42,18,t.transformValues(t.overviewFigures.totalGrossMarginAmt),"1.0-2"),""),f.Eb(2),f.Jc("color","#262d74"),f.Eb(1),f.Oc(" ",t.transformValues(t.overviewFigures.totalGrossMarginPercent)," %"),f.Eb(6),f.Oc("$ ",f.jc(51,21,t.transformValues(t.overviewFigures.totalAllocatedGrossMarginAmt),"1.0-2"),""),f.Eb(2),f.Jc("color","#262d74"),f.Eb(1),f.Oc(" ",t.transformValues(t.overviewFigures.totalAllocatedGrossMarginPercent)," %")}}function N(e,t){1&e&&f.Qb(0,"p-progressSpinner",30)}function F(e,t){if(1&e){const e=f.Wb();f.Vb(0,"a",37),f.dc("click",(function(t){return f.Dc(e),f.gc(2).onAddingReports(t)})),f.Qb(1,"em",38),f.Mc(2,"List of Reports"),f.Ub()}}function L(e,t){if(1&e){const e=f.Wb();f.Vb(0,"ol"),f.Vb(1,"li"),f.Vb(2,"input",46),f.dc("change",(function(){f.Dc(e);const a=t.$implicit;return f.gc(3).onReportChange(a)})),f.Ub(),f.Vb(3,"label",47),f.Mc(4),f.Ub(),f.Ub(),f.Ub()}if(2&e){const e=t.$implicit;f.Eb(2),f.oc("checked","Y"==e.showOnDashboard),f.Eb(1),f.pc("for",e.id),f.Eb(1),f.Nc(e.reportName)}}function I(e,t){1&e&&f.Qb(0,"p-progressSpinner",48)}function E(e,t){if(1&e){const e=f.Wb();f.Vb(0,"div",39),f.Vb(1,"div",40),f.Vb(2,"div",41),f.Vb(3,"a",42),f.dc("click",(function(t){return f.Dc(e),f.gc(2).closeAddReports(t)})),f.Mc(4,"\xd7"),f.Ub(),f.Kc(5,L,5,3,"ol",27),f.Ub(),f.Vb(6,"div",43),f.Vb(7,"a",44),f.dc("click",(function(){return f.Dc(e),f.gc(2).saveDashboardReports()})),f.Mc(8," Save "),f.Ub(),f.Ub(),f.Kc(9,I,1,0,"p-progressSpinner",45),f.Ub(),f.Ub()}if(2&e){const e=f.gc(2);f.Eb(5),f.oc("ngForOf",e.dropdownReportList),f.Eb(4),f.oc("ngIf",e.saveLoading)}}function Y(e,t){1&e&&f.Qb(0,"p-progressSpinner",49)}function k(e,t){1&e&&(f.Vb(0,"div"),f.Vb(1,"strong",50),f.Mc(2,"No reports found"),f.Ub(),f.Ub())}function T(e,t){if(1&e&&f.Qb(0,"canvas",60),2&e){const e=f.gc(2).$implicit;f.oc("datasets",e.chartData)("labels",e.chartLabels)("options",e.chartOptions)("legend",e.chartLegend)("chartType",e.chartType)}}function Q(e,t){1&e&&(f.Vb(0,"div",61),f.Mc(1," No Transaction Exist in the Selected Period Range "),f.Ub())}function K(e,t){if(1&e&&f.Qb(0,"canvas",62),2&e){const e=f.gc(2).$implicit;f.oc("options",e.pieChartOptions)("data",e.pieChartData)("labels",e.pieChartLabels)("chartType","doughnut")}}function W(e,t){1&e&&(f.Vb(0,"div",61),f.Mc(1," No Transaction Exist in the Selected Period Range "),f.Ub())}function J(e,t){if(1&e){const e=f.Wb();f.Vb(0,"div",53),f.Vb(1,"div",20),f.Vb(2,"h6",54),f.Vb(3,"span"),f.Mc(4),f.Ub(),f.Vb(5,"div",55),f.dc("click",(function(){f.Dc(e);const t=f.gc().$implicit,a=f.gc(3);return"bar"===t.chartType?a.toggleData(t,"pie",!0):a.toggleData(t,"bar",!1)})),f.Qb(6,"em",56),f.Ub(),f.Ub(),f.Kc(7,T,1,5,"canvas",57),f.Kc(8,Q,2,0,"div",58),f.Kc(9,K,1,4,"canvas",59),f.Kc(10,W,2,0,"div",58),f.Ub(),f.Ub()}if(2&e){const e=f.gc().$implicit;f.Eb(4),f.Nc(e.name),f.Eb(2),f.oc("ngClass","pie"===e.chartType?"fa fa-bar-chart":"fa fa-pie-chart"),f.Eb(1),f.oc("ngIf","bar"===e.chartType&&e.chartData.length>0),f.Eb(1),f.oc("ngIf","bar"===e.chartType&&0===e.chartData.length),f.Eb(1),f.oc("ngIf","pie"===e.chartType&&e.pieChartData.length>0),f.Eb(1),f.oc("ngIf","pie"===e.chartType&&0===e.pieChartData.length)}}function $(e,t){if(1&e&&(f.Vb(0,"div"),f.Kc(1,J,11,6,"div",52),f.Ub()),2&e){const e=t.$implicit;f.Eb(1),f.oc("ngIf","Y"===e.showOnDashboard)}}function _(e,t){if(1&e&&(f.Vb(0,"div",51),f.Kc(1,$,2,1,"div",27),f.Ub()),2&e){const e=f.gc(2);f.Eb(1),f.oc("ngForOf",e.reportsDataArray)}}function q(e,t){if(1&e&&(f.Vb(0,"div",1),f.Vb(1,"div",2),f.Vb(2,"div",3),f.Vb(3,"div",4),f.Vb(4,"div",31),f.Vb(5,"p-card"),f.Vb(6,"h2"),f.Mc(7,"Reports"),f.Ub(),f.Vb(8,"div",32),f.Kc(9,F,3,0,"a",33),f.Kc(10,E,10,2,"div",34),f.Ub(),f.Kc(11,Y,1,0,"p-progressSpinner",35),f.Kc(12,k,3,0,"div",23),f.Kc(13,_,2,1,"div",36),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub()),2&e){const e=f.gc();f.Eb(9),f.oc("ngIf",!e.noReports),f.Eb(1),f.oc("ngIf",e.addReports),f.Eb(1),f.oc("ngIf",e.showLoading),f.Eb(1),f.oc("ngIf",e.noReports),f.Eb(1),f.oc("ngIf",e.dealGuidanceBarReportReady)}}const z=a("+yMW"),j=[{path:"",component:(()=>{class e{constructor(e,t,a,r,i,o){this.drillDownService=e,this.router=t,this.dealDashboardService=a,this.rmanFiscalPeriodsService=r,this.notificationService=i,this.commonSharedService=o,this.addReports=!1,this.showChart=!1,this.currentUrl="",this.reportsList=[],this.showLoading=!1,this.saveLoading=!1,this.noReports=!1,this.rmanFYList=[],this.rmanPeriodDimensionsList=[],this.noOverviewData=!1,this.overviewDataLoading=!1,this.overviewFigures=null,this.dealGuidanceBarReportReady=!1,this.reportsDataArray=[],this.dropdownReportList=[],this.paginationOptions={pageNumber:0,pageSize:"10000"},this.router.events.subscribe(e=>{e instanceof d.c&&(this.currentUrl=e.url)}),this.overviewDataLoading=!0,this.rmanFiscalPeriodsService.getFinancialYears().then(e=>{this.rmanFYList=e;const t=[{label:z.dropDownOptions.selectYear,value:null}];for(let a=0;a<this.rmanFYList.length;a++)t.push({label:this.rmanFYList[a],value:this.rmanFYList[a]});this.rmanFYears=t}),this.rmanFiscalPeriodsService.getPeriodDimensions().then(e=>{this.rmanPeriodDimensionsList=e,this.currentPeriodDimension=this.rmanPeriodDimensionsList[0];const t=[{label:z.dropDownOptions.selectPeriod,value:null}];for(let a=0;a<this.rmanPeriodDimensionsList.length;a++)t.push({label:this.rmanPeriodDimensionsList[a],value:this.rmanPeriodDimensionsList[a]});this.rmanPeriodDimensions=t,this.rmanFiscalPeriodsService.getCurrentfiscalperiod().then(e=>{this.currentFY=e.periodYear,this.rmanPeriod=e.periodName,this.preparePeriods(this.currentFY),this.loadArrangementData(),this.dealDashboardService.getListOfReports().subscribe(e=>{this.dropdownReportList=e.content,0===this.dropdownReportList.length?this.noReports=!0:this.loadReports()})})})}ngOnInit(){}loadReports(){let e=this.currentFY,t=this.currentPeriodDimension,a=this.rmanPeriod,r=this.rmanQuarter;void 0===e&&(e=""),void 0===t&&(t=""),void 0===a&&(a=""),void 0===r&&(r=""),!a&&r&&(a=r),this.reportsDataArray=[],this.dropdownReportList.forEach(r=>{"dealsByQuarter"===r.reportCode&&this.dealDashboardService.dealsByQuarter(e,t,a).subscribe(e=>{this.buildReports(e,"quarter","noOfDeals",r.reportName,!1,"Number of Deals",r.reportCode,r.showOnDashboard,"",!1),this.dealGuidanceBarReportReady=!0}),"allocatedMarginGuidanceDeals"===r.reportCode&&this.dealDashboardService.allocatedMarginGuidanceDeals(e,t,a).subscribe(e=>{this.buildReports(e,"guidance","noOfDeals",r.reportName,!1,"Number of Deals(Margin Guidance) ",r.reportCode,r.showOnDashboard,"",!1),this.dealGuidanceBarReportReady=!0}),"allocatedMarginGuidancePercentByAllocatedGMGuidance"===r.reportCode&&this.dealDashboardService.allocatedMarginGuidancePercentByAllocatedGMGuidance(e,t,a).subscribe(e=>{this.buildReports(e,"allocatedMarginGuidance","allocatedMarginPercent",r.reportName,!1,"Margin Guidance",r.reportCode,r.showOnDashboard,"%",!1),this.dealGuidanceBarReportReady=!0}),"allocatedMarginPercentByProduct"===r.reportCode&&this.dealDashboardService.allocatedMarginPercentByProduct(e,t,a).subscribe(e=>{this.buildReports(e,"product","allocatedMarginPercent",r.reportName,!1,"Product",r.reportCode,r.showOnDashboard,"%",!1),this.dealGuidanceBarReportReady=!0}),"allocationAmtByRegion"===r.reportCode&&this.dealDashboardService.allocationAmtByRegion(e,t,a).subscribe(e=>{this.buildReports(e,"region","allocationAmount",r.reportName,!1,"Amount by Regions",r.reportCode,r.showOnDashboard,"",!0),this.dealGuidanceBarReportReady=!0}),"allocationAmtByPeriod"===r.reportCode&&this.dealDashboardService.allocationAmtByPeriod(e,t,a).subscribe(e=>{this.buildReports(e,"period","allocationAmount",r.reportName,!1,"Amount by Periods",r.reportCode,r.showOnDashboard,"",!0),this.dealGuidanceBarReportReady=!0}),"allocationAmtByAccount"===r.reportCode&&this.dealDashboardService.allocationAmtByAccount(e,t,a).subscribe(e=>{this.buildReports(e,"account","allocationAmount",r.reportName,!1,"Amount by Accounts",r.reportCode,r.showOnDashboard,"",!0),this.dealGuidanceBarReportReady=!0}),"allocationAmtByProductCategory"===r.reportCode&&this.dealDashboardService.allocationAmtByProductCategory(e,t,a).subscribe(e=>{this.buildReports(e,"productCategory","allocationAmount",r.reportName,!1,"Revenue Amount ",r.reportCode,r.showOnDashboard,"",!0),this.dealGuidanceBarReportReady=!0}),"allocationGuidanceDeals"===r.reportCode&&this.dealDashboardService.allocationGuidanceDeals(e,t,a).subscribe(e=>{this.buildReports(e,"guidance","noOfDeals",r.reportName,!1,"Number of Deals(Allocation Guidance)",r.reportCode,r.showOnDashboard,"",!1),this.dealGuidanceBarReportReady=!0}),"discountGuidanceDeals"===r.reportCode&&this.dealDashboardService.discountGuidanceDeals(e,t,a).subscribe(e=>{this.buildReports(e,"guidance","noOfDeals",r.reportName,!1,"Number of Deals(Discount Guidance)",r.reportCode,r.showOnDashboard,"",!1),this.dealGuidanceBarReportReady=!0}),"allocationMarginPercentByAllocationGuidance"===r.reportCode&&this.dealDashboardService.allocationMarginPercentByAllocationGuidance(e,t,a).subscribe(e=>{this.buildReports(e,"allocationGuidance","allocationGuidancePercent",r.reportName,!1,"Allocation Guidance",r.reportCode,r.showOnDashboard,"%",!1),this.dealGuidanceBarReportReady=!0}),"discountPercentByDiscountGuidance"===r.reportCode&&this.dealDashboardService.discountPercentByDiscountGuidance(e,t,a).subscribe(e=>{this.buildReports(e,"discountGuidance","discountGuidancePercent",r.reportName,!1,"Discount Guidance",r.reportCode,r.showOnDashboard,"%",!1),this.dealGuidanceBarReportReady=!0}),"dealGuidanceReport"===r.reportCode&&this.dealDashboardService.dealGuidanceReport(e,t,a).subscribe(e=>{this.buildReports(e,"guidance","noOfGuidances",r.reportName,!1,"Number of Deals",r.reportCode,r.showOnDashboard,"",!1),this.dealGuidanceBarReportReady=!0}),"allocatedmarginPercentByRegion"===r.reportCode&&this.dealDashboardService.allocatedmarginPercentByRegion(e,t,a).subscribe(e=>{this.buildReports(e,"region","allocatedMarginPercent",r.reportName,!1,"Region",r.reportCode,r.showOnDashboard,"%",!1),this.dealGuidanceBarReportReady=!0}),"allocatedmarginPercentByAccount"===r.reportCode&&this.dealDashboardService.allocatedmarginPercentByAccount(e,t,a).subscribe(e=>{this.buildReports(e,"account","allocatedMarginPercent",r.reportName,!1,"Account Name",r.reportCode,r.showOnDashboard,"%",!1),this.dealGuidanceBarReportReady=!0}),"allocatedmarginPercentByProductCategory"===r.reportCode&&this.dealDashboardService.allocatedmarginPercentByProductCategory(e,t,a).subscribe(e=>{this.buildReports(e,"productCategory","allocatedMarginPercent",r.reportName,!1,"Product Category",r.reportCode,r.showOnDashboard,"%",!1),this.dealGuidanceBarReportReady=!0})})}loadArrangementData(){this.dealDashboardService.getOverviewFigures(this.currentFY,this.currentPeriodDimension,this.rmanPeriod,this.rmanQuarter).then(e=>{null==e?(this.overviewDataLoading=!1,this.noOverviewData=!0,this.overviewFigures=null,this.notificationService.showError("Failed to load Overview Data")):(this.overviewFigures=e,this.overviewDataLoading=!1)})}onAddingReports(e){this.addReports=!this.addReports}closeAddReports(e){this.addReports=!1}onReportChange(e){this.reportsDataArray.forEach(t=>{t.reportCode===e.reportCode&&("Y"===e.showOnDashboard?(t.showOnDashboard="N",e.showOnDashboard="N"):(t.showOnDashboard="Y",e.showOnDashboard="Y"))})}saveDashboardReports(){this.saveLoading=!0,this.dealDashboardService.saveDashboardReportsLayout(this.dropdownReportList).then(e=>{this.saveLoading=!1,this.notificationService.showSuccess("Reports Updated Successfully")}).catch(e=>{this.saveLoading=!1,this.notificationService.showError("Error occurred while updating Data")})}transformValues(e){return null!=e?Math.round(e):0}onSelectChange(){null!=this.currentFY?(this.preparePeriods(this.currentFY),this.prepareQuarters(this.currentFY),this.rmanPeriod=null,this.rmanQuarter=null,this.overviewDataLoading=!1,this.loadArrangementData(),this.loadReports()):null!=this.currentPeriodDimension&&(this.rmanPeriod=null,this.rmanQuarter=null,this.overviewDataLoading=!1,this.loadArrangementData(),this.loadReports())}onDimensionChange(){this.rmanPeriod=null,this.rmanQuarter=null,this.onPeriodsChange()}onPeriodsChange(){this.overviewDataLoading=!1,this.loadArrangementData(),this.loadReports()}prepareQuarters(e){if(null!=e){const t=[{label:z.dropDownOptions.selectQuarterName,value:null}];for(let a=0;a<4;a++)t.push({label:0===a?"Q1-"+e:1===a?"Q2-"+e:2===a?"Q3-"+e:3===a?"Q4-"+e:"",value:0===a?"Q1-"+e:1===a?"Q2-"+e:2===a?"Q3-"+e:3===a?"Q4-"+e:""});this.rmanQuarters=t}}preparePeriods(e){if(null!=e){const t=e.toString().substr(2,4),a=[{label:z.dropDownOptions.selectedPeriodName,value:null}];for(let e=0;e<12;e++)a.push({label:0===e?"Jan-"+t:1===e?"Feb-"+t:2===e?"Mar-"+t:3===e?"Apr-"+t:4===e?"May-"+t:5===e?"Jun-"+t:6===e?"Jul-"+t:7===e?"Aug-"+t:8===e?"Sep-"+t:9===e?"Oct-"+t:10===e?"Nov-"+t:11===e?"Dec-"+t:"",value:0===e?"Jan-"+t:1===e?"Feb-"+t:2===e?"Mar-"+t:3===e?"Apr-"+t:4===e?"May-"+t:5===e?"Jun-"+t:6===e?"Jul-"+t:7===e?"Aug-"+t:8===e?"Sep-"+t:9===e?"Oct-"+t:10===e?"Nov-"+t:11===e?"Dec-"+t:""});this.rmanPeriods=a}}gotoPage(e){this.commonSharedService.guidance=e.guidance,this.router.navigate(["/deal-manager"])}buildReports(e,t,a,r,i,o,n,s,c,l){const d=[],h=[],u=[],p=this;e.forEach(e=>{d.push({data:[e[a]],label:e[t]}),h.push(e[a]),u.push([e[t]])}),this.reportsDataArray.push({name:r,chartType:"bar",chartLabels:[o],chartData:d,chartOptions:{scaleShowVerticalLines:!1,responsive:!0,legend:{display:!0,position:"bottom"},title:{display:i,text:o},scales:{yAxes:[{ticks:{suggestedMin:0,callback:function(e,t,a){if(c)return e+c;if(l){const t=Math.sign(Number(e));return"$"+p.formatAmounts(e,t)}return e}}}]},tooltips:{enabled:!0,callbacks:{label:function(e,t){const a=t.datasets[e.datasetIndex].data[e.index];if(c)return a+c;if(l){const e=Math.sign(Number(a));return"$"+(Math.abs(Number(a))>=1e9?(e*(Math.abs(Number(a))/1e9)).toFixed(2)+" Bn":Math.abs(Number(a))>=1e6?(e*(Math.abs(Number(a))/1e6)).toFixed(2)+" Mn":Math.abs(Number(a))>=1e3?(e*(Math.abs(Number(a))/1e3)).toFixed(2)+" K":Math.abs(Number(a)))}return a}}}},chartLegend:!0,pieChartData:h,pieChartLabels:u,reportCode:n,showOnDashboard:s,pieChartOptions:{legend:{display:!0,position:"bottom"},tooltips:{enabled:!0,callbacks:{label:function(e,t){const a=t.datasets[e.datasetIndex].data[e.index];if(c)return a+c;if(l){const e=Math.sign(Number(a));return"$"+(Math.abs(Number(a))>=1e9?(e*(Math.abs(Number(a))/1e9)).toFixed(2)+" Bn":Math.abs(Number(a))>=1e6?(e*(Math.abs(Number(a))/1e6)).toFixed(2)+" Mn":Math.abs(Number(a))>=1e3?(e*(Math.abs(Number(a))/1e3)).toFixed(2)+" K":Math.abs(Number(a)))}return a}}}}})}formatAmounts(e,t){let a,r;return Math.abs(Number(e))>=1e9?(r=(Math.abs(Number(e))/1e9).toPrecision(2),a=t*r+" Bn"):Math.abs(Number(e))>=1e6?(r=(Math.abs(Number(e))/1e6).toPrecision(2),a=t*r+" Mn"):Math.abs(Number(e))>=1e3?(r=(Math.abs(Number(e))/1e3).toPrecision(2),a=t*r+" K"):a=Math.abs(Number(e)).toPrecision(2),a}toggleData(e,t,a){e.chartType=t,e.chartOptions.title.display=a}}return e.\u0275fac=function(t){return new(t||e)(f.Pb(g.a),f.Pb(d.g),f.Pb(y),f.Pb(u.a),f.Pb(m.a),f.Pb(w.a))},e.\u0275cmp=f.Jb({type:e,selectors:[["app-deal-dashboard"]],viewQuery:function(e,t){var a;1&e&&f.Qc(P,!0,b.a),2&e&&f.Ac(a=f.ec())&&(t.dataChart=a.first)},decls:19,vars:16,consts:[[1,"content-section","implementation"],[1,"card-wrapper"],[1,"container-fluid"],[1,"row"],[1,"col-md-12"],[1,"card-block","card-padding","card-overview"],[1,"cardHeader","row","mx-0"],["name","FYear",1,"ml-auto",3,"options","ngModel","ngModelOptions","filter","ngModelChange","onChange"],["name","periodDimension",3,"options","ngModel","ngModelOptions","filter","ngModelChange","onChange"],["name","periodName",3,"options","ngModel","ngModelOptions","filter","ngModelChange","onChange",4,"ngIf"],["name","quarterName",3,"options","ngModel","ngModelOptions","filter","ngModelChange","onChange",4,"ngIf"],["class","no-data-found",4,"ngIf"],["class","card-container row mx-0 width-100 height-135",4,"ngIf"],["class","overviewFigures-load-spinner","styleClass","custom-spinner","strokeWidth","4",4,"ngIf"],["class","card-wrapper",4,"ngIf"],["name","periodName",3,"options","ngModel","ngModelOptions","filter","ngModelChange","onChange"],["name","quarterName",3,"options","ngModel","ngModelOptions","filter","ngModelChange","onChange"],[1,"no-data-found"],[1,"card-container","row","mx-0","width-100","height-135"],[1,"col",2,"padding-right","10px!important"],[1,"card"],[1,"font-12"],[1,"card","text-right"],[4,"ngIf"],[4,"ngIf","ngIfElse"],["loggedOut",""],[1,"justify-content-end"],[4,"ngFor","ngForOf"],[1,"col"],[1,"pointer",2,"text-decoration","underline!important",3,"click"],["styleClass","custom-spinner","strokeWidth","4",1,"overviewFigures-load-spinner"],[1,"card-block","card-padding","d-flex"],[1,"pull-right","icons-list"],["class","add-column",3,"click",4,"ngIf"],["id","add-column-popup","class","dashboard-reports-popup",4,"ngIf"],["class","reports-load-splinner","styleClass","custom-spinner","strokeWidth","4",4,"ngIf"],["class","dashboard-graphs-row",4,"ngIf"],[1,"add-column",3,"click"],[1,"fa","fa-plus-circle"],["id","add-column-popup",1,"dashboard-reports-popup"],[1,"user-popup","right-align"],[1,"content","overflow"],["title","Close",1,"close",3,"click"],[1,"add-column-btns"],[1,"primary-btn","pointer",3,"click"],["class","save-dialog-spinner","styleClass","custom-spinner","strokeWidth","4",4,"ngIf"],["type","checkbox","name","column",3,"checked","change"],[3,"for"],["styleClass","custom-spinner","strokeWidth","4",1,"save-dialog-spinner"],["styleClass","custom-spinner","strokeWidth","4",1,"reports-load-splinner"],[2,"text-align","center"],[1,"dashboard-graphs-row"],["class","col-md-4 reports-card-main",4,"ngIf"],[1,"col-md-4","reports-card-main"],[1,"dashboard-report-name"],[1,"pull-right","chart-switch",3,"click"],[3,"ngClass"],["baseChart","","height","200",3,"datasets","labels","options","legend","chartType",4,"ngIf"],["class","no_chartData",4,"ngIf"],["baseChart","","height","200",3,"options","data","labels","chartType",4,"ngIf"],["baseChart","","height","200",3,"datasets","labels","options","legend","chartType"],[1,"no_chartData"],["baseChart","","height","200",3,"options","data","labels","chartType"]],template:function(e,t){1&e&&(f.Qb(0,"div",0),f.Vb(1,"div",1),f.Vb(2,"div",2),f.Vb(3,"div",3),f.Vb(4,"div",4),f.Vb(5,"div",5),f.Vb(6,"p-card"),f.Vb(7,"div",6),f.Vb(8,"h2"),f.Mc(9,"Overview"),f.Ub(),f.Vb(10,"p-dropdown",7),f.dc("ngModelChange",(function(e){return t.currentFY=e}))("onChange",(function(){return t.onSelectChange()})),f.Ub(),f.Vb(11,"p-dropdown",8),f.dc("ngModelChange",(function(e){return t.currentPeriodDimension=e}))("onChange",(function(){return t.onDimensionChange()})),f.Ub(),f.Kc(12,U,1,5,"p-dropdown",9),f.Kc(13,R,1,5,"p-dropdown",10),f.Ub(),f.Vb(14,"div",3),f.Kc(15,G,2,0,"h6",11),f.Kc(16,S,54,24,"span",12),f.Kc(17,N,1,0,"p-progressSpinner",13),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Ub(),f.Kc(18,q,14,5,"div",14)),2&e&&(f.Eb(10),f.oc("options",t.rmanFYears)("ngModel",t.currentFY)("ngModelOptions",f.rc(14,C))("filter",!1),f.Eb(1),f.oc("options",t.rmanPeriodDimensions)("ngModel",t.currentPeriodDimension)("ngModelOptions",f.rc(15,C))("filter",!1),f.Eb(1),f.oc("ngIf",null!=t.currentFY&&"PTD"==t.currentPeriodDimension),f.Eb(1),f.oc("ngIf",null!=t.currentFY&&"QTD"==t.currentPeriodDimension),f.Eb(2),f.oc("ngIf",null===t.overviewFigures),f.Eb(1),f.oc("ngIf",!t.overviewDataLoading&&null!==t.overviewFigures),f.Eb(1),f.oc("ngIf",t.overviewDataLoading),f.Eb(1),f.oc("ngIf",t.reportsList))},directives:[i.a,o.a,n.k,n.n,r.o,r.n,s.a,r.m,M.a],pipes:[r.g],styles:[".col[_ngcontent-%COMP%]{padding-left:5px!important;padding-right:10px!important}.font-12[_ngcontent-%COMP%]{font-weight:700;font-size:12px!important}.height-135[_ngcontent-%COMP%]{height:135px!important}.width-100[_ngcontent-%COMP%]{width:100%!important}.dashboard-report-name[_ngcontent-%COMP%]{cursor:unset;text-decoration:unset}.no_chartData[_ngcontent-%COMP%]{height:308px;justify-content:center;align-items:center;display:inline-flex;font-weight:700;color:#767676}@media (min-width:1420px) and (max-width:1600px){.no_chartData[_ngcontent-%COMP%]{height:255px}}@media (min-width:1700px) and (max-width:2100px){.no_chartData[_ngcontent-%COMP%]{height:360px}}@media (min-width:2400px) and (max-width:3500px){.no_chartData[_ngcontent-%COMP%]{height:502px}}"]}),e})()}];let H=(()=>{class e{}return e.\u0275mod=f.Nb({type:e}),e.\u0275inj=f.Mb({factory:function(t){return new(t||e)},providers:[h.a,u.a,{provide:l.a,useClass:p.a,multi:!0}],imports:[[i.b,o.b,n.h,r.c,s.b,c.a,l.c,d.k.forChild(j),l.d.withOptions({cookieName:"CSRF-TOKEN",headerName:"X-CSRF-TOKEN"})],i.b,o.b,n.h,s.b]}),e})()},gJyg:function(e,t,a){"use strict";a.d(t,"a",(function(){return h}));var r=a("cBSm"),i=a("1adA"),o=a("JSOo"),n=a("fXoL"),s=a("ofXK"),c=a("LPYB");const l=["chart"];function d(e,t){if(1&e){const e=n.Wb();n.Vb(0,"canvas",1),n.dc("chartClick",(function(t){return n.Dc(e),n.gc().onBarClick(t)})),n.Ub()}if(2&e){const e=n.gc();n.oc("datasets",e.barChartData)("labels",e.barChartLabels)("options",e.barChartOptions)("plugins",e.barChartPlugins)("legend",e.barChartLegend)("chartType",e.barChartType)}}let h=(()=>{class e{constructor(e,t){this.drillDownService=e,this.commonSharedService=t,this.chartData=[],this.currentUrl="",this.isDrillDown=null,this.month="month",this.quarter="quarter",this.year="year",this.ShowHideChart=!0,this.values=[],this.legends=[],this.barChartLabels=[],this.barChartData=[],this.barChartOptions={responsive:!0,legend:{position:"bottom"}},this.barChartType="bar",this.barChartLegend=!0,this.barChartPlugins=[],this.chartReady=!1,this.clicksCount=0,this.reachedYear=!1,this.type="",this.orientation="",this.flipChart=!1,this.showLegend=!0,this.caption="",this.description="",this.padding={left:10,top:5,right:25,bottom:0},this.titlePadding={left:90,top:0,right:0,bottom:10},this.dataSource=this.chartData,this.colorScheme="scheme29",this.animationDuration=400,this.xAxis={dataField:"",unitInterval:1,textRotationAngle:0,valuesOnTicks:!0,tickMarks:{visible:!0,unitInterval:1,color:"#888888"},gridLines:{visible:!1,unitInterval:1,color:"#888888"}},this.valueAxis={unitInterval:10,minValue:0,maxValue:1e10,visible:!0,axisSize:"auto",flip:!1,textRotationAngle:0,tickMarks:{color:"#888888"},gridLines:{color:"#888888"},formatSettings:{decimalPlaces:0}},this.seriesGroups=[]}ngOnInit(){this.getChartData()}onBarClick(e){e.active.length>0&&null==e.detail&&(this.columnData.rowGroup[0]==this.year?(this.isDrillDown=!0,localStorage.setItem("reachedYear","true"),this.getChartData()):this.columnData.rowGroup[0]==this.quarter?("true"==localStorage.getItem("reachedYear")?(this.isDrillDown=!0,localStorage.setItem("reachedYear","false")):this.isDrillDown=!1,this.getChartData()):(this.isDrillDown=!1,this.getChartData()))}getChartData(){this.legends=[],this.barChartData=[],this.caption=this.title?this.title.dataset.value:"",this.desc=this.desc?this.desc.dataset.value:"","/"==this.routeUrl||"/dashboard"==this.routeUrl?(this.chartdynamicWidth="385px",this.chartDynamicHeight="350px",this.leftPadding="-15px"):(this.chartdynamicWidth="1350px",this.chartDynamicHeight="500px");let e=[];this.columnData.rowGroup&&(this.isDrillDown?this.columnData.rowGroup[0]==this.year?this.columnData.rowGroup[0]=this.quarter:this.columnData.rowGroup[0]==this.quarter&&(this.columnData.rowGroup[0]=this.month):!1===this.isDrillDown&&(this.columnData.rowGroup[0]==this.month?this.columnData.rowGroup[0]=this.quarter:this.columnData.rowGroup[0]==this.quarter&&(this.columnData.rowGroup[0]=this.year)),e.push(...this.columnData.rowGroup)),this.columnData.pivot&&e.push(...this.columnData.pivot);let t=["year","quarter","month","customer"],a=null,r=[];for(let p=0;p<e.length;p++)if(-1!=t.indexOf(e[p])){a=e[p],r=this.columnData.rowGroup||p<this.columnData.rowGroup.length-1?this.columnData.pivot:this.columnData.rowGroup;break}let i={};if(("/"==this.routeUrl||"/dashboard"==this.routeUrl)&&this.drillDownService.reportsArrangementData.length>0){let e=this.drillDownService.reportsArrangementData.filter(e=>e.id===this.reportId);this.drillDownService.arrangementsData=null==e[0].data?[]:e[0].data}this.drillDownService.arrangementsData.forEach(e=>{i[e[a]]||(i[e[a]]={});let t=i[e[a]];for(let a of this.columnData.summary){t[a.label]||(t[a.label]={});let i=t[a.label];r&&r.length||(r=["All"]);for(let t of r){let r=e[t];i[r]||(i[r]=0),i[r]+=e[a.name]}}});let o=0,n=[],s=[];if("/"==this.routeUrl||"/dashboard"==this.routeUrl){let e=0,t=0,r=0;for(let c in i){let l=3;if("customer"==a&&(l=4),e<=l){let e={};e[a]=c,r=0;for(let a in i[c]){if(0==r){t=0;for(let r in i[c][a]){if(t<=1){let t=i[c][a][r];e[a+r]=t,t>o&&(o=t),s[a]||(s[a]={}),s[a][r]=""}t++}}r++}n.push(e)}e++}}else for(let p in i){let e={};e[a]=p;for(let t in i[p])for(let a in i[p][t]){let r=i[p][t][a];e[t+a]=r,r>o&&(o=r),s[t]||(s[t]={}),s[t][a]=""}n.push(e)}if("/"!=this.routeUrl&&"/dashboard"!=this.routeUrl&&"customer"==a&&n){let e=n.length;if(e>10){var c=30*e;c>500&&(this.chartDynamicHeight=c+"px")}}for(let p in s){"customer"==a&&(this.orientation="horizontal");let e=!1;this.columnData.pivot||(e=!1);let t={type:"stackedcolumn",orientation:this.orientation,columnsMinWidth:15,columnsMaxWidth:15,columnsGapPercent:50,seriesGapPercent:1e3,series:[],showLabels:e};for(let r in s[p]){let e,i;this.columnData.pivot||(e="customer"==a?{visible:!0,horizontalAlignment:"right",offset:{x:50,y:0}}:{visible:!0,verticalAlignment:"top",offset:{x:0,y:-20}},i=function(e){var t;return Number.isNaN(e)?null:0==e?0:e<1e3?Math.floor(e).toFixed(2):(t=Math.floor(Math.log(e)/Math.log(1e3)),(e/Math.pow(1e3,t)).toFixed(2)+["K","M","G","T","P","E"][t-1])}),t.series.push({dataField:p+r,displayText:("undefined"!=r?r:"")+" "+p,labels:e,formatFunction:i}),this.legends.push(p+r)}this.seriesGroups.push(t)}this.xAxis.dataField=a,this.dataSource=n,this.valueAxis.minValue=0,this.valueAxis.maxValue=o,this.valueAxis.axisSize="auto","customer"==a?(this.valueAxis.flip=!0,this.xAxis.textRotationAngle=90,this.valueAxis.textRotationAngle=-75):this.valueAxis.flip=!1;let l=Math.ceil(o)/10;this.valueAxis.unitInterval=Math.ceil(o+(l+l/2))/10,(this.isDrillDown||!1===this.isDrillDown)&&(this.drillDownService.showChart=!1,setTimeout(()=>{this.drillDownService.showChart=!0},0));let d=[],h=a;for(let p=0;p<this.dataSource.length;p++)d.push(this.dataSource[p][h]);this.barChartLabels=d;let u={};for(let p=0;p<this.legends.length;p++){this.values=[];let e=0;for(;e<n.length;)this.values.push(null!=n[e][this.legends[p]]?n[e][this.legends[p]]:0),e++;u[p]={data:this.values,label:this.legends[p]},this.barChartData.push(u[p])}this.chartReady=!0}}return e.\u0275fac=function(t){return new(t||e)(n.Pb(i.a),n.Pb(o.a))},e.\u0275cmp=n.Jb({type:e,selectors:[["data-chart"]],viewQuery:function(e,t){var a;1&e&&n.Qc(l,!0,r.a),2&e&&n.Ac(a=n.ec())&&(t.chart=a.first)},inputs:{columnData:"columnData",title:"title",desc:"desc",routeUrl:"routeUrl",reportId:"reportId"},features:[n.Db([o.a])],decls:1,vars:1,consts:[["id","barchart","baseChart","","height","200",3,"datasets","labels","options","plugins","legend","chartType","chartClick",4,"ngIf"],["id","barchart","baseChart","","height","200",3,"datasets","labels","options","plugins","legend","chartType","chartClick"]],template:function(e,t){1&e&&n.Kc(0,d,1,6,"canvas",0),2&e&&n.oc("ngIf",t.chartReady&&0!=t.barChartLabels.length)},directives:[s.o,c.a],encapsulation:2}),e})()}}]);